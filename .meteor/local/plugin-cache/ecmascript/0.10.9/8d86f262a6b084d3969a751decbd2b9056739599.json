{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"client/lib/definitions/modules/dropdown.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"client/lib/definitions/modules/dropdown.js","filename":"client/lib/definitions/modules/dropdown.js","sourceMaps":true,"passPerPreset":false,"envName":"development","cwd":"/home/martijn/Documents/GitHub/QRSMeteor","root":"/home/martijn/Documents/GitHub/QRSMeteor","generatorOpts":{"filename":"client/lib/definitions/modules/dropdown.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/lib/definitions/modules/dropdown.js"}},"code":"/*\n  DO NOT MODIFY - This file has been generated and will be regenerated\n  Semantic UI v2.1.8\n*/\n\n/*!\n * # Semantic UI - Dropdown\n * http://github.com/semantic-org/semantic-ui/\n *\n *\n * Copyright 2015 Contributors\n * Released under the MIT license\n * http://opensource.org/licenses/MIT\n *\n */\n;\n\n(function ($, window, document, undefined) {\n  \"use strict\";\n\n  $.fn.dropdown = function (parameters) {\n    var $allModules = $(this),\n        $document = $(document),\n        moduleSelector = $allModules.selector || '',\n        hasTouch = 'ontouchstart' in document.documentElement,\n        time = new Date().getTime(),\n        performance = [],\n        query = arguments[0],\n        methodInvoked = typeof query == 'string',\n        queryArguments = [].slice.call(arguments, 1),\n        returnedValue;\n    $allModules.each(function (elementIndex) {\n      var settings = $.isPlainObject(parameters) ? $.extend(true, {}, $.fn.dropdown.settings, parameters) : $.extend({}, $.fn.dropdown.settings),\n          className = settings.className,\n          message = settings.message,\n          fields = settings.fields,\n          keys = settings.keys,\n          metadata = settings.metadata,\n          namespace = settings.namespace,\n          regExp = settings.regExp,\n          selector = settings.selector,\n          error = settings.error,\n          templates = settings.templates,\n          eventNamespace = '.' + namespace,\n          moduleNamespace = 'module-' + namespace,\n          $module = $(this),\n          $context = $(settings.context),\n          $text = $module.find(selector.text),\n          $search = $module.find(selector.search),\n          $input = $module.find(selector.input),\n          $icon = $module.find(selector.icon),\n          $combo = $module.prev().find(selector.text).length > 0 ? $module.prev().find(selector.text) : $module.prev(),\n          $menu = $module.children(selector.menu),\n          $item = $menu.find(selector.item),\n          activated = false,\n          itemActivated = false,\n          internalChange = false,\n          element = this,\n          instance = $module.data(moduleNamespace),\n          initialLoad,\n          pageLostFocus,\n          elementNamespace,\n          id,\n          selectObserver,\n          menuObserver,\n          module;\n      module = {\n        initialize: function () {\n          module.debug('Initializing dropdown', settings);\n\n          if (module.is.alreadySetup()) {\n            module.setup.reference();\n          } else {\n            module.setup.layout();\n            module.refreshData();\n            module.save.defaults();\n            module.restore.selected();\n            module.create.id();\n            module.bind.events();\n            module.observeChanges();\n            module.instantiate();\n          }\n        },\n        instantiate: function () {\n          module.verbose('Storing instance of dropdown', module);\n          instance = module;\n          $module.data(moduleNamespace, module);\n        },\n        destroy: function () {\n          module.verbose('Destroying previous dropdown', $module);\n          module.remove.tabbable();\n          $module.off(eventNamespace).removeData(moduleNamespace);\n          $menu.off(eventNamespace);\n          $document.off(elementNamespace);\n\n          if (selectObserver) {\n            selectObserver.disconnect();\n          }\n\n          if (menuObserver) {\n            menuObserver.disconnect();\n          }\n        },\n        observeChanges: function () {\n          if ('MutationObserver' in window) {\n            selectObserver = new MutationObserver(function (mutations) {\n              module.debug('<select> modified, recreating menu');\n              module.setup.select();\n            });\n            menuObserver = new MutationObserver(function (mutations) {\n              module.debug('Menu modified, updating selector cache');\n              module.refresh();\n            });\n\n            if (module.has.input()) {\n              selectObserver.observe($input[0], {\n                childList: true,\n                subtree: true\n              });\n            }\n\n            if (module.has.menu()) {\n              menuObserver.observe($menu[0], {\n                childList: true,\n                subtree: true\n              });\n            }\n\n            module.debug('Setting up mutation observer', selectObserver, menuObserver);\n          }\n        },\n        create: {\n          id: function () {\n            id = (Math.random().toString(16) + '000000000').substr(2, 8);\n            elementNamespace = '.' + id;\n            module.verbose('Creating unique id for element', id);\n          },\n          userChoice: function (values) {\n            var $userChoices, $userChoice, isUserValue, html;\n            values = values || module.get.userValues();\n\n            if (!values) {\n              return false;\n            }\n\n            values = $.isArray(values) ? values : [values];\n            $.each(values, function (index, value) {\n              if (module.get.item(value) === false) {\n                html = settings.templates.addition(module.add.variables(message.addResult, value));\n                $userChoice = $('<div />').html(html).attr('data-' + metadata.value, value).attr('data-' + metadata.text, value).addClass(className.addition).addClass(className.item);\n                $userChoices = $userChoices === undefined ? $userChoice : $userChoices.add($userChoice);\n                module.verbose('Creating user choices for value', value, $userChoice);\n              }\n            });\n            return $userChoices;\n          },\n          userLabels: function (value) {\n            var userValues = module.get.userValues();\n\n            if (userValues) {\n              module.debug('Adding user labels', userValues);\n              $.each(userValues, function (index, value) {\n                module.verbose('Adding custom user value');\n                module.add.label(value, value);\n              });\n            }\n          },\n          menu: function () {\n            $menu = $('<div />').addClass(className.menu).appendTo($module);\n          }\n        },\n        search: function (query) {\n          query = query !== undefined ? query : module.get.query();\n          module.verbose('Searching for query', query);\n          module.filter(query);\n        },\n        select: {\n          firstUnfiltered: function () {\n            module.verbose('Selecting first non-filtered element');\n            module.remove.selectedItem();\n            $item.not(selector.unselectable).eq(0).addClass(className.selected);\n          },\n          nextAvailable: function ($selected) {\n            $selected = $selected.eq(0);\n            var $nextAvailable = $selected.nextAll(selector.item).not(selector.unselectable).eq(0),\n                $prevAvailable = $selected.prevAll(selector.item).not(selector.unselectable).eq(0),\n                hasNext = $nextAvailable.length > 0;\n\n            if (hasNext) {\n              module.verbose('Moving selection to', $nextAvailable);\n              $nextAvailable.addClass(className.selected);\n            } else {\n              module.verbose('Moving selection to', $prevAvailable);\n              $prevAvailable.addClass(className.selected);\n            }\n          }\n        },\n        setup: {\n          api: function () {\n            var apiSettings = {\n              debug: settings.debug,\n              on: false\n            };\n            module.verbose('First request, initializing API');\n            $module.api(apiSettings);\n          },\n          layout: function () {\n            if ($module.is('select')) {\n              module.setup.select();\n              module.setup.returnedObject();\n            }\n\n            if (!module.has.menu()) {\n              module.create.menu();\n            }\n\n            if (module.is.search() && !module.has.search()) {\n              module.verbose('Adding search input');\n              $search = $('<input />').addClass(className.search).prop('autocomplete', 'off').insertBefore($text);\n            }\n\n            if (settings.allowTab) {\n              module.set.tabbable();\n            }\n          },\n          select: function () {\n            var selectValues = module.get.selectValues();\n            module.debug('Dropdown initialized on a select', selectValues);\n\n            if ($module.is('select')) {\n              $input = $module;\n            } // see if select is placed correctly already\n\n\n            if ($input.parent(selector.dropdown).length > 0) {\n              module.debug('UI dropdown already exists. Creating dropdown menu only');\n              $module = $input.closest(selector.dropdown);\n\n              if (!module.has.menu()) {\n                module.create.menu();\n              }\n\n              $menu = $module.children(selector.menu);\n              module.setup.menu(selectValues);\n            } else {\n              module.debug('Creating entire dropdown from select');\n              $module = $('<div />').attr('class', $input.attr('class')).addClass(className.selection).addClass(className.dropdown).html(templates.dropdown(selectValues)).insertBefore($input);\n\n              if ($input.hasClass(className.multiple) && $input.prop('multiple') === false) {\n                module.error(error.missingMultiple);\n                $input.prop('multiple', true);\n              }\n\n              if ($input.is('[multiple]')) {\n                module.set.multiple();\n              }\n\n              if ($input.prop('disabled')) {\n                module.debug('Disabling dropdown');\n                $module.addClass(className.disabled);\n              }\n\n              $input.removeAttr('class').detach().prependTo($module);\n            }\n\n            module.refresh();\n          },\n          menu: function (values) {\n            $menu.html(templates.menu(values, fields));\n            $item = $menu.find(selector.item);\n          },\n          reference: function () {\n            module.debug('Dropdown behavior was called on select, replacing with closest dropdown'); // replace module reference\n\n            $module = $module.parent(selector.dropdown);\n            module.refresh();\n            module.setup.returnedObject(); // invoke method in context of current instance\n\n            if (methodInvoked) {\n              instance = module;\n              module.invoke(query);\n            }\n          },\n          returnedObject: function () {\n            var $firstModules = $allModules.slice(0, elementIndex),\n                $lastModules = $allModules.slice(elementIndex + 1); // adjust all modules to use correct reference\n\n            $allModules = $firstModules.add($module).add($lastModules);\n          }\n        },\n        refresh: function () {\n          module.refreshSelectors();\n          module.refreshData();\n        },\n        refreshSelectors: function () {\n          module.verbose('Refreshing selector cache');\n          $text = $module.find(selector.text);\n          $search = $module.find(selector.search);\n          $input = $module.find(selector.input);\n          $icon = $module.find(selector.icon);\n          $combo = $module.prev().find(selector.text).length > 0 ? $module.prev().find(selector.text) : $module.prev();\n          $menu = $module.children(selector.menu);\n          $item = $menu.find(selector.item);\n        },\n        refreshData: function () {\n          module.verbose('Refreshing cached metadata');\n          $item.removeData(metadata.text).removeData(metadata.value);\n          $module.removeData(metadata.defaultText).removeData(metadata.defaultValue).removeData(metadata.placeholderText);\n        },\n        toggle: function () {\n          module.verbose('Toggling menu visibility');\n\n          if (!module.is.active()) {\n            module.show();\n          } else {\n            module.hide();\n          }\n        },\n        show: function (callback) {\n          callback = $.isFunction(callback) ? callback : function () {};\n\n          if (module.can.show() && !module.is.active()) {\n            module.debug('Showing dropdown');\n\n            if (module.is.multiple() && !module.has.search() && module.is.allFiltered()) {\n              return true;\n            }\n\n            if (module.has.message() && !(module.has.maxSelections() || module.has.allResultsFiltered())) {\n              module.remove.message();\n            }\n\n            if (settings.onShow.call(element) !== false) {\n              module.animate.show(function () {\n                if (module.can.click()) {\n                  module.bind.intent();\n                }\n\n                module.set.visible();\n                callback.call(element);\n              });\n            }\n          }\n        },\n        hide: function (callback) {\n          callback = $.isFunction(callback) ? callback : function () {};\n\n          if (module.is.active()) {\n            module.debug('Hiding dropdown');\n\n            if (settings.onHide.call(element) !== false) {\n              module.animate.hide(function () {\n                module.remove.visible();\n                callback.call(element);\n              });\n            }\n          }\n        },\n        hideOthers: function () {\n          module.verbose('Finding other dropdowns to hide');\n          $allModules.not($module).has(selector.menu + '.' + className.visible).dropdown('hide');\n        },\n        hideMenu: function () {\n          module.verbose('Hiding menu  instantaneously');\n          module.remove.active();\n          module.remove.visible();\n          $menu.transition('hide');\n        },\n        hideSubMenus: function () {\n          var $subMenus = $menu.children(selector.item).find(selector.menu);\n          module.verbose('Hiding sub menus', $subMenus);\n          $subMenus.transition('hide');\n        },\n        bind: {\n          events: function () {\n            if (hasTouch) {\n              module.bind.touchEvents();\n            }\n\n            module.bind.keyboardEvents();\n            module.bind.inputEvents();\n            module.bind.mouseEvents();\n          },\n          touchEvents: function () {\n            module.debug('Touch device detected binding additional touch events');\n\n            if (module.is.searchSelection()) {// do nothing special yet\n            } else if (module.is.single()) {\n              $module.on('touchstart' + eventNamespace, module.event.test.toggle);\n            }\n\n            $menu.on('touchstart' + eventNamespace, selector.item, module.event.item.mouseenter);\n          },\n          keyboardEvents: function () {\n            module.verbose('Binding keyboard events');\n            $module.on('keydown' + eventNamespace, module.event.keydown);\n\n            if (module.has.search()) {\n              $module.on(module.get.inputEvent() + eventNamespace, selector.search, module.event.input);\n            }\n\n            if (module.is.multiple()) {\n              $document.on('keydown' + elementNamespace, module.event.document.keydown);\n            }\n          },\n          inputEvents: function () {\n            module.verbose('Binding input change events');\n            $module.on('change' + eventNamespace, selector.input, module.event.change);\n          },\n          mouseEvents: function () {\n            module.verbose('Binding mouse events');\n\n            if (module.is.multiple()) {\n              $module.on('click' + eventNamespace, selector.label, module.event.label.click).on('click' + eventNamespace, selector.remove, module.event.remove.click);\n            }\n\n            if (module.is.searchSelection()) {\n              $module.on('mousedown' + eventNamespace, selector.menu, module.event.menu.mousedown).on('mouseup' + eventNamespace, selector.menu, module.event.menu.mouseup).on('click' + eventNamespace, selector.icon, module.event.icon.click).on('click' + eventNamespace, selector.search, module.show).on('focus' + eventNamespace, selector.search, module.event.search.focus).on('blur' + eventNamespace, selector.search, module.event.search.blur).on('click' + eventNamespace, selector.text, module.event.text.focus);\n\n              if (module.is.multiple()) {\n                $module.on('click' + eventNamespace, module.event.click);\n              }\n            } else {\n              if (settings.on == 'click') {\n                $module.on('click' + eventNamespace, selector.icon, module.event.icon.click).on('click' + eventNamespace, module.event.test.toggle);\n              } else if (settings.on == 'hover') {\n                $module.on('mouseenter' + eventNamespace, module.delay.show).on('mouseleave' + eventNamespace, module.delay.hide);\n              } else {\n                $module.on(settings.on + eventNamespace, module.toggle);\n              }\n\n              $module.on('mousedown' + eventNamespace, module.event.mousedown).on('mouseup' + eventNamespace, module.event.mouseup).on('focus' + eventNamespace, module.event.focus).on('blur' + eventNamespace, module.event.blur);\n            }\n\n            $menu.on('mouseenter' + eventNamespace, selector.item, module.event.item.mouseenter).on('mouseleave' + eventNamespace, selector.item, module.event.item.mouseleave).on('click' + eventNamespace, selector.item, module.event.item.click);\n          },\n          intent: function () {\n            module.verbose('Binding hide intent event to document');\n\n            if (hasTouch) {\n              $document.on('touchstart' + elementNamespace, module.event.test.touch).on('touchmove' + elementNamespace, module.event.test.touch);\n            }\n\n            $document.on('click' + elementNamespace, module.event.test.hide);\n          }\n        },\n        unbind: {\n          intent: function () {\n            module.verbose('Removing hide intent event from document');\n\n            if (hasTouch) {\n              $document.off('touchstart' + elementNamespace).off('touchmove' + elementNamespace);\n            }\n\n            $document.off('click' + elementNamespace);\n          }\n        },\n        filter: function (query) {\n          var searchTerm = query !== undefined ? query : module.get.query(),\n              afterFiltered = function () {\n            if (module.is.multiple()) {\n              module.filterActive();\n            }\n\n            module.select.firstUnfiltered();\n\n            if (module.has.allResultsFiltered()) {\n              if (settings.onNoResults.call(element, searchTerm)) {\n                if (!settings.allowAdditions) {\n                  module.verbose('All items filtered, showing message', searchTerm);\n                  module.add.message(message.noResults);\n                }\n              } else {\n                module.verbose('All items filtered, hiding dropdown', searchTerm);\n                module.hideMenu();\n              }\n            } else {\n              module.remove.message();\n            }\n\n            if (settings.allowAdditions) {\n              module.add.userSuggestion(query);\n            }\n\n            if (module.is.searchSelection() && module.can.show() && module.is.focusedOnSearch()) {\n              module.show();\n            }\n          };\n\n          if (settings.useLabels && module.has.maxSelections()) {\n            return;\n          }\n\n          if (settings.apiSettings) {\n            if (module.can.useAPI()) {\n              module.queryRemote(searchTerm, function () {\n                afterFiltered();\n              });\n            } else {\n              module.error(error.noAPI);\n            }\n          } else {\n            module.filterItems(searchTerm);\n            afterFiltered();\n          }\n        },\n        queryRemote: function (query, callback) {\n          var apiSettings = {\n            errorDuration: false,\n            throttle: settings.throttle,\n            urlData: {\n              query: query\n            },\n            onError: function () {\n              module.add.message(message.serverError);\n              callback();\n            },\n            onFailure: function () {\n              module.add.message(message.serverError);\n              callback();\n            },\n            onSuccess: function (response) {\n              module.remove.message();\n              module.setup.menu({\n                values: response[fields.remoteValues]\n              });\n              callback();\n            }\n          };\n\n          if (!$module.api('get request')) {\n            module.setup.api();\n          }\n\n          apiSettings = $.extend(true, {}, apiSettings, settings.apiSettings);\n          $module.api('setting', apiSettings).api('query');\n        },\n        filterItems: function (query) {\n          var searchTerm = query !== undefined ? query : module.get.query(),\n              results = null,\n              escapedTerm = module.escape.regExp(searchTerm),\n              beginsWithRegExp = new RegExp('^' + escapedTerm, 'igm'); // avoid loop if we're matching nothing\n\n          if (module.has.query()) {\n            results = [];\n            module.verbose('Searching for matching values', searchTerm);\n            $item.each(function () {\n              var $choice = $(this),\n                  text,\n                  value;\n\n              if (settings.match == 'both' || settings.match == 'text') {\n                text = String(module.get.choiceText($choice, false));\n\n                if (text.search(beginsWithRegExp) !== -1) {\n                  results.push(this);\n                  return true;\n                } else if (settings.fullTextSearch && module.fuzzySearch(searchTerm, text)) {\n                  results.push(this);\n                  return true;\n                }\n              }\n\n              if (settings.match == 'both' || settings.match == 'value') {\n                value = String(module.get.choiceValue($choice, text));\n\n                if (value.search(beginsWithRegExp) !== -1) {\n                  results.push(this);\n                  return true;\n                } else if (settings.fullTextSearch && module.fuzzySearch(searchTerm, value)) {\n                  results.push(this);\n                  return true;\n                }\n              }\n            });\n          }\n\n          module.debug('Showing only matched items', searchTerm);\n          module.remove.filteredItem();\n\n          if (results) {\n            $item.not(results).addClass(className.filtered);\n          }\n        },\n        fuzzySearch: function (query, term) {\n          var termLength = term.length,\n              queryLength = query.length;\n          query = query.toLowerCase();\n          term = term.toLowerCase();\n\n          if (queryLength > termLength) {\n            return false;\n          }\n\n          if (queryLength === termLength) {\n            return query === term;\n          }\n\n          search: for (var characterIndex = 0, nextCharacterIndex = 0; characterIndex < queryLength; characterIndex++) {\n            var queryCharacter = query.charCodeAt(characterIndex);\n\n            while (nextCharacterIndex < termLength) {\n              if (term.charCodeAt(nextCharacterIndex++) === queryCharacter) {\n                continue search;\n              }\n            }\n\n            return false;\n          }\n\n          return true;\n        },\n        filterActive: function () {\n          if (settings.useLabels) {\n            $item.filter('.' + className.active).addClass(className.filtered);\n          }\n        },\n        focusSearch: function () {\n          if (module.is.search() && !module.is.focusedOnSearch()) {\n            $search[0].focus();\n          }\n        },\n        forceSelection: function () {\n          var $currentlySelected = $item.not(className.filtered).filter('.' + className.selected).eq(0),\n              $activeItem = $item.not(className.filtered).filter('.' + className.active).eq(0),\n              $selectedItem = $currentlySelected.length > 0 ? $currentlySelected : $activeItem,\n              hasSelected = $selectedItem.size() > 0;\n\n          if (module.has.query()) {\n            if (hasSelected) {\n              module.debug('Forcing partial selection to selected item', $selectedItem);\n              module.event.item.click.call($selectedItem);\n              return;\n            } else {\n              module.remove.searchTerm();\n            }\n          }\n\n          module.hide();\n        },\n        event: {\n          change: function () {\n            if (!internalChange) {\n              module.debug('Input changed, updating selection');\n              module.set.selected();\n            }\n          },\n          focus: function () {\n            if (settings.showOnFocus && !activated && module.is.hidden() && !pageLostFocus) {\n              module.show();\n            }\n          },\n          click: function (event) {\n            var $target = $(event.target); // focus search\n\n            if ($target.is($module) && !module.is.focusedOnSearch()) {\n              module.focusSearch();\n            }\n          },\n          blur: function (event) {\n            pageLostFocus = document.activeElement === this;\n\n            if (!activated && !pageLostFocus) {\n              module.remove.activeLabel();\n              module.hide();\n            }\n          },\n          // prevents focus callback from occurring on mousedown\n          mousedown: function () {\n            activated = true;\n          },\n          mouseup: function () {\n            activated = false;\n          },\n          search: {\n            focus: function () {\n              activated = true;\n\n              if (module.is.multiple()) {\n                module.remove.activeLabel();\n              }\n\n              if (settings.showOnFocus) {\n                module.search();\n                module.show();\n              }\n            },\n            blur: function (event) {\n              pageLostFocus = document.activeElement === this;\n\n              if (!itemActivated && !pageLostFocus) {\n                if (module.is.multiple()) {\n                  module.remove.activeLabel();\n                  module.hide();\n                } else if (settings.forceSelection) {\n                  module.forceSelection();\n                } else {\n                  module.hide();\n                }\n              } else if (pageLostFocus) {\n                if (settings.forceSelection) {\n                  module.forceSelection();\n                }\n              }\n            }\n          },\n          icon: {\n            click: function (event) {\n              module.toggle();\n              event.stopPropagation();\n            }\n          },\n          text: {\n            focus: function (event) {\n              activated = true;\n              module.focusSearch();\n            }\n          },\n          input: function (event) {\n            if (module.is.multiple() || module.is.searchSelection()) {\n              module.set.filtered();\n            }\n\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.search, settings.delay.search);\n          },\n          label: {\n            click: function (event) {\n              var $label = $(this),\n                  $labels = $module.find(selector.label),\n                  $activeLabels = $labels.filter('.' + className.active),\n                  $nextActive = $label.nextAll('.' + className.active),\n                  $prevActive = $label.prevAll('.' + className.active),\n                  $range = $nextActive.length > 0 ? $label.nextUntil($nextActive).add($activeLabels).add($label) : $label.prevUntil($prevActive).add($activeLabels).add($label);\n\n              if (event.shiftKey) {\n                $activeLabels.removeClass(className.active);\n                $range.addClass(className.active);\n              } else if (event.ctrlKey) {\n                $label.toggleClass(className.active);\n              } else {\n                $activeLabels.removeClass(className.active);\n                $label.addClass(className.active);\n              }\n\n              settings.onLabelSelect.apply(this, $labels.filter('.' + className.active));\n            }\n          },\n          remove: {\n            click: function () {\n              var $label = $(this).parent();\n\n              if ($label.hasClass(className.active)) {\n                // remove all selected labels\n                module.remove.activeLabels();\n              } else {\n                // remove this label only\n                module.remove.activeLabels($label);\n              }\n            }\n          },\n          test: {\n            toggle: function (event) {\n              var toggleBehavior = module.is.multiple() ? module.show : module.toggle;\n\n              if (module.determine.eventOnElement(event, toggleBehavior)) {\n                event.preventDefault();\n              }\n            },\n            touch: function (event) {\n              module.determine.eventOnElement(event, function () {\n                if (event.type == 'touchstart') {\n                  module.timer = setTimeout(function () {\n                    module.hide();\n                  }, settings.delay.touch);\n                } else if (event.type == 'touchmove') {\n                  clearTimeout(module.timer);\n                }\n              });\n              event.stopPropagation();\n            },\n            hide: function (event) {\n              module.determine.eventInModule(event, module.hide);\n            }\n          },\n          menu: {\n            mousedown: function () {\n              itemActivated = true;\n            },\n            mouseup: function () {\n              itemActivated = false;\n            }\n          },\n          item: {\n            mouseenter: function (event) {\n              var $subMenu = $(this).children(selector.menu),\n                  $otherMenus = $(this).siblings(selector.item).children(selector.menu);\n\n              if ($subMenu.length > 0) {\n                clearTimeout(module.itemTimer);\n                module.itemTimer = setTimeout(function () {\n                  module.verbose('Showing sub-menu', $subMenu);\n                  $.each($otherMenus, function () {\n                    module.animate.hide(false, $(this));\n                  });\n                  module.animate.show(false, $subMenu);\n                }, settings.delay.show);\n                event.preventDefault();\n              }\n            },\n            mouseleave: function (event) {\n              var $subMenu = $(this).children(selector.menu);\n\n              if ($subMenu.length > 0) {\n                clearTimeout(module.itemTimer);\n                module.itemTimer = setTimeout(function () {\n                  module.verbose('Hiding sub-menu', $subMenu);\n                  module.animate.hide(false, $subMenu);\n                }, settings.delay.hide);\n              }\n            },\n            touchend: function () {},\n            click: function (event) {\n              var $choice = $(this),\n                  $target = event ? $(event.target) : $(''),\n                  $subMenu = $choice.find(selector.menu),\n                  text = module.get.choiceText($choice),\n                  value = module.get.choiceValue($choice, text),\n                  hasSubMenu = $subMenu.length > 0,\n                  isBubbledEvent = $subMenu.find($target).length > 0;\n\n              if (!isBubbledEvent && (!hasSubMenu || settings.allowCategorySelection)) {\n                if (!settings.useLabels) {\n                  module.remove.filteredItem();\n                  module.remove.searchTerm();\n                  module.set.scrollPosition($choice);\n                }\n\n                module.determine.selectAction.call(this, text, value);\n              }\n            }\n          },\n          document: {\n            // label selection should occur even when element has no focus\n            keydown: function (event) {\n              var pressedKey = event.which,\n                  isShortcutKey = module.is.inObject(pressedKey, keys);\n\n              if (isShortcutKey) {\n                var $label = $module.find(selector.label),\n                    $activeLabel = $label.filter('.' + className.active),\n                    activeValue = $activeLabel.data(metadata.value),\n                    labelIndex = $label.index($activeLabel),\n                    labelCount = $label.length,\n                    hasActiveLabel = $activeLabel.length > 0,\n                    hasMultipleActive = $activeLabel.length > 1,\n                    isFirstLabel = labelIndex === 0,\n                    isLastLabel = labelIndex + 1 == labelCount,\n                    isSearch = module.is.searchSelection(),\n                    isFocusedOnSearch = module.is.focusedOnSearch(),\n                    isFocused = module.is.focused(),\n                    caretAtStart = isFocusedOnSearch && module.get.caretPosition() === 0,\n                    $nextLabel;\n\n                if (isSearch && !hasActiveLabel && !isFocusedOnSearch) {\n                  return;\n                }\n\n                if (pressedKey == keys.leftArrow) {\n                  // activate previous label\n                  if ((isFocused || caretAtStart) && !hasActiveLabel) {\n                    module.verbose('Selecting previous label');\n                    $label.last().addClass(className.active);\n                  } else if (hasActiveLabel) {\n                    if (!event.shiftKey) {\n                      module.verbose('Selecting previous label');\n                      $label.removeClass(className.active);\n                    } else {\n                      module.verbose('Adding previous label to selection');\n                    }\n\n                    if (isFirstLabel && !hasMultipleActive) {\n                      $activeLabel.addClass(className.active);\n                    } else {\n                      $activeLabel.prev(selector.siblingLabel).addClass(className.active).end();\n                    }\n\n                    event.preventDefault();\n                  }\n                } else if (pressedKey == keys.rightArrow) {\n                  // activate first label\n                  if (isFocused && !hasActiveLabel) {\n                    $label.first().addClass(className.active);\n                  } // activate next label\n\n\n                  if (hasActiveLabel) {\n                    if (!event.shiftKey) {\n                      module.verbose('Selecting next label');\n                      $label.removeClass(className.active);\n                    } else {\n                      module.verbose('Adding next label to selection');\n                    }\n\n                    if (isLastLabel) {\n                      if (isSearch) {\n                        if (!isFocusedOnSearch) {\n                          module.focusSearch();\n                        } else {\n                          $label.removeClass(className.active);\n                        }\n                      } else if (hasMultipleActive) {\n                        $activeLabel.next(selector.siblingLabel).addClass(className.active);\n                      } else {\n                        $activeLabel.addClass(className.active);\n                      }\n                    } else {\n                      $activeLabel.next(selector.siblingLabel).addClass(className.active);\n                    }\n\n                    event.preventDefault();\n                  }\n                } else if (pressedKey == keys.deleteKey || pressedKey == keys.backspace) {\n                  if (hasActiveLabel) {\n                    module.verbose('Removing active labels');\n\n                    if (isLastLabel) {\n                      if (isSearch && !isFocusedOnSearch) {\n                        module.focusSearch();\n                      }\n                    }\n\n                    $activeLabel.last().next(selector.siblingLabel).addClass(className.active);\n                    module.remove.activeLabels($activeLabel);\n                    event.preventDefault();\n                  } else if (caretAtStart && !hasActiveLabel && pressedKey == keys.backspace) {\n                    module.verbose('Removing last label on input backspace');\n                    $activeLabel = $label.last().addClass(className.active);\n                    module.remove.activeLabels($activeLabel);\n                  }\n                } else {\n                  $activeLabel.removeClass(className.active);\n                }\n              }\n            }\n          },\n          keydown: function (event) {\n            var pressedKey = event.which,\n                isShortcutKey = module.is.inObject(pressedKey, keys);\n\n            if (isShortcutKey) {\n              var $currentlySelected = $item.not(selector.unselectable).filter('.' + className.selected).eq(0),\n                  $activeItem = $menu.children('.' + className.active).eq(0),\n                  $selectedItem = $currentlySelected.length > 0 ? $currentlySelected : $activeItem,\n                  $visibleItems = $selectedItem.length > 0 ? $selectedItem.siblings(':not(.' + className.filtered + ')').andSelf() : $menu.children(':not(.' + className.filtered + ')'),\n                  $subMenu = $selectedItem.children(selector.menu),\n                  $parentMenu = $selectedItem.closest(selector.menu),\n                  inVisibleMenu = $parentMenu.hasClass(className.visible) || $parentMenu.hasClass(className.animating) || $parentMenu.parent(selector.menu).length > 0,\n                  hasSubMenu = $subMenu.length > 0,\n                  hasSelectedItem = $selectedItem.length > 0,\n                  selectedIsSelectable = $selectedItem.not(selector.unselectable).length > 0,\n                  delimiterPressed = pressedKey == keys.delimiter && settings.allowAdditions && module.is.multiple(),\n                  $nextItem,\n                  isSubMenuItem,\n                  newIndex; // visible menu keyboard shortcuts\n\n              if (module.is.visible()) {\n                // enter (select or open sub-menu)\n                if (pressedKey == keys.enter || delimiterPressed) {\n                  if (pressedKey == keys.enter && hasSelectedItem && hasSubMenu && !settings.allowCategorySelection) {\n                    module.verbose('Pressed enter on unselectable category, opening sub menu');\n                    pressedKey = keys.rightArrow;\n                  } else if (selectedIsSelectable) {\n                    module.verbose('Selecting item from keyboard shortcut', $selectedItem);\n                    module.event.item.click.call($selectedItem, event);\n\n                    if (module.is.searchSelection()) {\n                      module.remove.searchTerm();\n                    }\n                  }\n\n                  event.preventDefault();\n                } // left arrow (hide sub-menu)\n\n\n                if (pressedKey == keys.leftArrow) {\n                  isSubMenuItem = $parentMenu[0] !== $menu[0];\n\n                  if (isSubMenuItem) {\n                    module.verbose('Left key pressed, closing sub-menu');\n                    module.animate.hide(false, $parentMenu);\n                    $selectedItem.removeClass(className.selected);\n                    $parentMenu.closest(selector.item).addClass(className.selected);\n                    event.preventDefault();\n                  }\n                } // right arrow (show sub-menu)\n\n\n                if (pressedKey == keys.rightArrow) {\n                  if (hasSubMenu) {\n                    module.verbose('Right key pressed, opening sub-menu');\n                    module.animate.show(false, $subMenu);\n                    $selectedItem.removeClass(className.selected);\n                    $subMenu.find(selector.item).eq(0).addClass(className.selected);\n                    event.preventDefault();\n                  }\n                } // up arrow (traverse menu up)\n\n\n                if (pressedKey == keys.upArrow) {\n                  $nextItem = hasSelectedItem && inVisibleMenu ? $selectedItem.prevAll(selector.item + ':not(' + selector.unselectable + ')').eq(0) : $item.eq(0);\n\n                  if ($visibleItems.index($nextItem) < 0) {\n                    module.verbose('Up key pressed but reached top of current menu');\n                    event.preventDefault();\n                    return;\n                  } else {\n                    module.verbose('Up key pressed, changing active item');\n                    $selectedItem.removeClass(className.selected);\n                    $nextItem.addClass(className.selected);\n                    module.set.scrollPosition($nextItem);\n                  }\n\n                  event.preventDefault();\n                } // down arrow (traverse menu down)\n\n\n                if (pressedKey == keys.downArrow) {\n                  $nextItem = hasSelectedItem && inVisibleMenu ? $nextItem = $selectedItem.nextAll(selector.item + ':not(' + selector.unselectable + ')').eq(0) : $item.eq(0);\n\n                  if ($nextItem.length === 0) {\n                    module.verbose('Down key pressed but reached bottom of current menu');\n                    event.preventDefault();\n                    return;\n                  } else {\n                    module.verbose('Down key pressed, changing active item');\n                    $item.removeClass(className.selected);\n                    $nextItem.addClass(className.selected);\n                    module.set.scrollPosition($nextItem);\n                  }\n\n                  event.preventDefault();\n                } // page down (show next page)\n\n\n                if (pressedKey == keys.pageUp) {\n                  module.scrollPage('up');\n                  event.preventDefault();\n                }\n\n                if (pressedKey == keys.pageDown) {\n                  module.scrollPage('down');\n                  event.preventDefault();\n                } // escape (close menu)\n\n\n                if (pressedKey == keys.escape) {\n                  module.verbose('Escape key pressed, closing dropdown');\n                  module.hide();\n                }\n              } else {\n                // delimiter key\n                if (delimiterPressed) {\n                  event.preventDefault();\n                } // down arrow (open menu)\n\n\n                if (pressedKey == keys.downArrow) {\n                  module.verbose('Down key pressed, showing dropdown');\n                  module.show();\n                  event.preventDefault();\n                }\n              }\n            } else {\n              if (module.is.selection() && !module.is.search()) {\n                module.set.selectedLetter(String.fromCharCode(pressedKey));\n              }\n            }\n          }\n        },\n        trigger: {\n          change: function () {\n            var events = document.createEvent('HTMLEvents'),\n                inputElement = $input[0];\n\n            if (inputElement) {\n              module.verbose('Triggering native change event');\n              events.initEvent('change', true, false);\n              inputElement.dispatchEvent(events);\n            }\n          }\n        },\n        determine: {\n          selectAction: function (text, value) {\n            module.verbose('Determining action', settings.action);\n\n            if ($.isFunction(module.action[settings.action])) {\n              module.verbose('Triggering preset action', settings.action, text, value);\n              module.action[settings.action].call(this, text, value);\n            } else if ($.isFunction(settings.action)) {\n              module.verbose('Triggering user action', settings.action, text, value);\n              settings.action.call(this, text, value);\n            } else {\n              module.error(error.action, settings.action);\n            }\n          },\n          eventInModule: function (event, callback) {\n            var $target = $(event.target),\n                inDocument = $target.closest(document.documentElement).length > 0,\n                inModule = $target.closest($module).length > 0;\n            callback = $.isFunction(callback) ? callback : function () {};\n\n            if (inDocument && !inModule) {\n              module.verbose('Triggering event', callback);\n              callback();\n              return true;\n            } else {\n              module.verbose('Event occurred in dropdown, canceling callback');\n              return false;\n            }\n          },\n          eventOnElement: function (event, callback) {\n            var $target = $(event.target),\n                $label = $target.closest(selector.siblingLabel),\n                notOnLabel = $module.find($label).length === 0,\n                notInMenu = $target.closest($menu).length === 0;\n            callback = $.isFunction(callback) ? callback : function () {};\n\n            if (notOnLabel && notInMenu) {\n              module.verbose('Triggering event', callback);\n              callback();\n              return true;\n            } else {\n              module.verbose('Event occurred in dropdown menu, canceling callback');\n              return false;\n            }\n          }\n        },\n        action: {\n          nothing: function () {},\n          activate: function (text, value) {\n            value = value !== undefined ? value : text;\n\n            if (module.can.activate($(this))) {\n              module.set.selected(value, $(this));\n\n              if (module.is.multiple() && !module.is.allFiltered()) {\n                return;\n              } else {\n                module.hideAndClear();\n              }\n            }\n          },\n          select: function (text, value) {\n            // mimics action.activate but does not select text\n            module.action.activate.call(this);\n          },\n          combo: function (text, value) {\n            value = value !== undefined ? value : text;\n            module.set.selected(value, $(this));\n            module.hideAndClear();\n          },\n          hide: function (text, value) {\n            module.set.value(value);\n            module.hideAndClear();\n          }\n        },\n        get: {\n          id: function () {\n            return id;\n          },\n          defaultText: function () {\n            return $module.data(metadata.defaultText);\n          },\n          defaultValue: function () {\n            return $module.data(metadata.defaultValue);\n          },\n          placeholderText: function () {\n            return $module.data(metadata.placeholderText) || '';\n          },\n          text: function () {\n            return $text.text();\n          },\n          query: function () {\n            return $.trim($search.val());\n          },\n          searchWidth: function (characterCount) {\n            return characterCount * settings.glyphWidth + 'em';\n          },\n          selectionCount: function () {\n            var values = module.get.values(),\n                count;\n            count = module.is.multiple() ? $.isArray(values) ? values.length : 0 : module.get.value() !== '' ? 1 : 0;\n            return count;\n          },\n          transition: function ($subMenu) {\n            return settings.transition == 'auto' ? module.is.upward($subMenu) ? 'slide up' : 'slide down' : settings.transition;\n          },\n          userValues: function () {\n            var values = module.get.values();\n\n            if (!values) {\n              return false;\n            }\n\n            values = $.isArray(values) ? values : [values];\n            return $.grep(values, function (value) {\n              return module.get.item(value) === false;\n            });\n          },\n          uniqueArray: function (array) {\n            return $.grep(array, function (value, index) {\n              return $.inArray(value, array) === index;\n            });\n          },\n          caretPosition: function () {\n            var input = $search.get(0),\n                range,\n                rangeLength;\n\n            if ('selectionStart' in input) {\n              return input.selectionStart;\n            } else if (document.selection) {\n              input.focus();\n              range = document.selection.createRange();\n              rangeLength = range.text.length;\n              range.moveStart('character', -input.value.length);\n              return range.text.length - rangeLength;\n            }\n          },\n          value: function () {\n            var value = $input.length > 0 ? $input.val() : $module.data(metadata.value); // prevents placeholder element from being selected when multiple\n\n            if ($.isArray(value) && value.length === 1 && value[0] === '') {\n              return '';\n            }\n\n            return value;\n          },\n          values: function () {\n            var value = module.get.value();\n\n            if (value === '') {\n              return '';\n            }\n\n            return !module.has.selectInput() && module.is.multiple() ? typeof value == 'string' ? // delimited string\n            value.split(settings.delimiter) : '' : value;\n          },\n          remoteValues: function () {\n            var values = module.get.values(),\n                remoteValues = false;\n\n            if (values) {\n              if (typeof values == 'string') {\n                values = [values];\n              }\n\n              remoteValues = {};\n              $.each(values, function (index, value) {\n                var name = module.read.remoteData(value);\n                module.verbose('Restoring value from session data', name, value);\n                remoteValues[value] = name ? name : value;\n              });\n            }\n\n            return remoteValues;\n          },\n          choiceText: function ($choice, preserveHTML) {\n            preserveHTML = preserveHTML !== undefined ? preserveHTML : settings.preserveHTML;\n\n            if ($choice) {\n              if ($choice.find(selector.menu).length > 0) {\n                module.verbose('Retreiving text of element with sub-menu');\n                $choice = $choice.clone();\n                $choice.find(selector.menu).remove();\n                $choice.find(selector.menuIcon).remove();\n              }\n\n              return $choice.data(metadata.text) !== undefined ? $choice.data(metadata.text) : preserveHTML ? $.trim($choice.html()) : $.trim($choice.text());\n            }\n          },\n          choiceValue: function ($choice, choiceText) {\n            choiceText = choiceText || module.get.choiceText($choice);\n\n            if (!$choice) {\n              return false;\n            }\n\n            return $choice.data(metadata.value) !== undefined ? String($choice.data(metadata.value)) : typeof choiceText === 'string' ? $.trim(choiceText.toLowerCase()) : String(choiceText);\n          },\n          inputEvent: function () {\n            var input = $search[0];\n\n            if (input) {\n              return input.oninput !== undefined ? 'input' : input.onpropertychange !== undefined ? 'propertychange' : 'keyup';\n            }\n\n            return false;\n          },\n          selectValues: function () {\n            var select = {};\n            select.values = [];\n            $module.find('option').each(function () {\n              var $option = $(this),\n                  name = $option.html(),\n                  disabled = $option.attr('disabled'),\n                  value = $option.attr('value') !== undefined ? $option.attr('value') : name;\n\n              if (settings.placeholder === 'auto' && value === '') {\n                select.placeholder = name;\n              } else {\n                select.values.push({\n                  name: name,\n                  value: value,\n                  disabled: disabled\n                });\n              }\n            });\n\n            if (settings.placeholder && settings.placeholder !== 'auto') {\n              module.debug('Setting placeholder value to', settings.placeholder);\n              select.placeholder = settings.placeholder;\n            }\n\n            if (settings.sortSelect) {\n              select.values.sort(function (a, b) {\n                return a.name > b.name ? 1 : -1;\n              });\n              module.debug('Retrieved and sorted values from select', select);\n            } else {\n              module.debug('Retreived values from select', select);\n            }\n\n            return select;\n          },\n          activeItem: function () {\n            return $item.filter('.' + className.active);\n          },\n          selectedItem: function () {\n            var $selectedItem = $item.not(selector.unselectable).filter('.' + className.selected);\n            return $selectedItem.length > 0 ? $selectedItem : $item.eq(0);\n          },\n          itemWithAdditions: function (value) {\n            var $items = module.get.item(value),\n                $userItems = module.create.userChoice(value),\n                hasUserItems = $userItems && $userItems.length > 0;\n\n            if (hasUserItems) {\n              $items = $items.length > 0 ? $items.add($userItems) : $userItems;\n            }\n\n            return $items;\n          },\n          item: function (value, strict) {\n            var $selectedItem = false,\n                shouldSearch,\n                isMultiple;\n            value = value !== undefined ? value : module.get.values() !== undefined ? module.get.values() : module.get.text();\n            shouldSearch = isMultiple ? value.length > 0 : value !== undefined && value !== null;\n            isMultiple = module.is.multiple() && $.isArray(value);\n            strict = value === '' || value === 0 ? true : strict || false;\n\n            if (shouldSearch) {\n              $item.each(function () {\n                var $choice = $(this),\n                    optionText = module.get.choiceText($choice),\n                    optionValue = module.get.choiceValue($choice, optionText); // safe early exit\n\n                if (optionValue === null || optionValue === undefined) {\n                  return;\n                }\n\n                if (isMultiple) {\n                  if ($.inArray(String(optionValue), value) !== -1 || $.inArray(optionText, value) !== -1) {\n                    $selectedItem = $selectedItem ? $selectedItem.add($choice) : $choice;\n                  }\n                } else if (strict) {\n                  module.verbose('Ambiguous dropdown value using strict type check', $choice, value);\n\n                  if (optionValue === value || optionText === value) {\n                    $selectedItem = $choice;\n                    return true;\n                  }\n                } else {\n                  if (String(optionValue) == String(value) || optionText == value) {\n                    module.verbose('Found select item by value', optionValue, value);\n                    $selectedItem = $choice;\n                    return true;\n                  }\n                }\n              });\n            }\n\n            return $selectedItem;\n          }\n        },\n        check: {\n          maxSelections: function (selectionCount) {\n            if (settings.maxSelections) {\n              selectionCount = selectionCount !== undefined ? selectionCount : module.get.selectionCount();\n\n              if (selectionCount >= settings.maxSelections) {\n                module.debug('Maximum selection count reached');\n\n                if (settings.useLabels) {\n                  $item.addClass(className.filtered);\n                  module.add.message(message.maxSelections);\n                }\n\n                return true;\n              } else {\n                module.verbose('No longer at maximum selection count');\n                module.remove.message();\n                module.remove.filteredItem();\n\n                if (module.is.searchSelection()) {\n                  module.filterItems();\n                }\n\n                return false;\n              }\n            }\n\n            return true;\n          }\n        },\n        restore: {\n          defaults: function () {\n            module.clear();\n            module.restore.defaultText();\n            module.restore.defaultValue();\n          },\n          defaultText: function () {\n            var defaultText = module.get.defaultText(),\n                placeholderText = module.get.placeholderText;\n\n            if (defaultText === placeholderText) {\n              module.debug('Restoring default placeholder text', defaultText);\n              module.set.placeholderText(defaultText);\n            } else {\n              module.debug('Restoring default text', defaultText);\n              module.set.text(defaultText);\n            }\n          },\n          defaultValue: function () {\n            var defaultValue = module.get.defaultValue();\n\n            if (defaultValue !== undefined) {\n              module.debug('Restoring default value', defaultValue);\n\n              if (defaultValue !== '') {\n                module.set.value(defaultValue);\n                module.set.selected();\n              } else {\n                module.remove.activeItem();\n                module.remove.selectedItem();\n              }\n            }\n          },\n          labels: function () {\n            if (settings.allowAdditions) {\n              if (!settings.useLabels) {\n                module.error(error.labels);\n                settings.useLabels = true;\n              }\n\n              module.debug('Restoring selected values');\n              module.create.userLabels();\n            }\n\n            module.check.maxSelections();\n          },\n          selected: function () {\n            module.restore.values();\n\n            if (module.is.multiple()) {\n              module.debug('Restoring previously selected values and labels');\n              module.restore.labels();\n            } else {\n              module.debug('Restoring previously selected values');\n            }\n          },\n          values: function () {\n            // prevents callbacks from occuring on initial load\n            module.set.initialLoad();\n\n            if (settings.apiSettings) {\n              if (settings.saveRemoteData) {\n                module.restore.remoteValues();\n              } else {\n                module.clearValue();\n              }\n            } else {\n              module.set.selected();\n            }\n\n            module.remove.initialLoad();\n          },\n          remoteValues: function () {\n            var values = module.get.remoteValues();\n            module.debug('Recreating selected from session data', values);\n\n            if (values) {\n              if (module.is.single()) {\n                $.each(values, function (value, name) {\n                  module.set.text(name);\n                });\n              } else {\n                $.each(values, function (value, name) {\n                  module.add.label(value, name);\n                });\n              }\n            }\n          }\n        },\n        read: {\n          remoteData: function (value) {\n            var name;\n\n            if (window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n\n            name = sessionStorage.getItem(value);\n            return name !== undefined ? name : false;\n          }\n        },\n        save: {\n          defaults: function () {\n            module.save.defaultText();\n            module.save.placeholderText();\n            module.save.defaultValue();\n          },\n          defaultValue: function () {\n            var value = module.get.value();\n            module.verbose('Saving default value as', value);\n            $module.data(metadata.defaultValue, value);\n          },\n          defaultText: function () {\n            var text = module.get.text();\n            module.verbose('Saving default text as', text);\n            $module.data(metadata.defaultText, text);\n          },\n          placeholderText: function () {\n            var text;\n\n            if (settings.placeholder !== false && $text.hasClass(className.placeholder)) {\n              text = module.get.text();\n              module.verbose('Saving placeholder text as', text);\n              $module.data(metadata.placeholderText, text);\n            }\n          },\n          remoteData: function (name, value) {\n            if (window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n\n            module.verbose('Saving remote data to session storage', value, name);\n            sessionStorage.setItem(value, name);\n          }\n        },\n        clear: function () {\n          if (module.is.multiple()) {\n            module.remove.labels();\n          } else {\n            module.remove.activeItem();\n            module.remove.selectedItem();\n          }\n\n          module.set.placeholderText();\n          module.clearValue();\n        },\n        clearValue: function () {\n          module.set.value('');\n        },\n        scrollPage: function (direction, $selectedItem) {\n          var $currentItem = $selectedItem || module.get.selectedItem(),\n              $menu = $currentItem.closest(selector.menu),\n              menuHeight = $menu.outerHeight(),\n              currentScroll = $menu.scrollTop(),\n              itemHeight = $item.eq(0).outerHeight(),\n              itemsPerPage = Math.floor(menuHeight / itemHeight),\n              maxScroll = $menu.prop('scrollHeight'),\n              newScroll = direction == 'up' ? currentScroll - itemHeight * itemsPerPage : currentScroll + itemHeight * itemsPerPage,\n              $selectableItem = $item.not(selector.unselectable),\n              isWithinRange,\n              $nextSelectedItem,\n              elementIndex;\n          elementIndex = direction == 'up' ? $selectableItem.index($currentItem) - itemsPerPage : $selectableItem.index($currentItem) + itemsPerPage;\n          isWithinRange = direction == 'up' ? elementIndex >= 0 : elementIndex < $selectableItem.length;\n          $nextSelectedItem = isWithinRange ? $selectableItem.eq(elementIndex) : direction == 'up' ? $selectableItem.first() : $selectableItem.last();\n\n          if ($nextSelectedItem.length > 0) {\n            module.debug('Scrolling page', direction, $nextSelectedItem);\n            $currentItem.removeClass(className.selected);\n            $nextSelectedItem.addClass(className.selected);\n            $menu.scrollTop(newScroll);\n          }\n        },\n        set: {\n          filtered: function () {\n            var isMultiple = module.is.multiple(),\n                isSearch = module.is.searchSelection(),\n                isSearchMultiple = isMultiple && isSearch,\n                searchValue = isSearch ? module.get.query() : '',\n                hasSearchValue = typeof searchValue === 'string' && searchValue.length > 0,\n                searchWidth = module.get.searchWidth(searchValue.length),\n                valueIsSet = searchValue !== '';\n\n            if (isMultiple && hasSearchValue) {\n              module.verbose('Adjusting input width', searchWidth, settings.glyphWidth);\n              $search.css('width', searchWidth);\n            }\n\n            if (hasSearchValue || isSearchMultiple && valueIsSet) {\n              module.verbose('Hiding placeholder text');\n              $text.addClass(className.filtered);\n            } else if (!isMultiple || isSearchMultiple && !valueIsSet) {\n              module.verbose('Showing placeholder text');\n              $text.removeClass(className.filtered);\n            }\n          },\n          loading: function () {\n            $module.addClass(className.loading);\n          },\n          placeholderText: function (text) {\n            text = text || module.get.placeholderText();\n            module.debug('Setting placeholder text', text);\n            module.set.text(text);\n            $text.addClass(className.placeholder);\n          },\n          tabbable: function () {\n            if (module.has.search()) {\n              module.debug('Added tabindex to searchable dropdown');\n              $search.val('').attr('tabindex', 0);\n              $menu.attr('tabindex', -1);\n            } else {\n              module.debug('Added tabindex to dropdown');\n\n              if ($module.attr('tabindex') === undefined) {\n                $module.attr('tabindex', 0);\n                $menu.attr('tabindex', -1);\n              }\n            }\n          },\n          initialLoad: function () {\n            module.verbose('Setting initial load');\n            initialLoad = true;\n          },\n          activeItem: function ($item) {\n            if (settings.allowAdditions && $item.filter(selector.addition).length > 0) {\n              $item.addClass(className.filtered);\n            } else {\n              $item.addClass(className.active);\n            }\n          },\n          scrollPosition: function ($item, forceScroll) {\n            var edgeTolerance = 5,\n                $menu,\n                hasActive,\n                offset,\n                itemHeight,\n                itemOffset,\n                menuOffset,\n                menuScroll,\n                menuHeight,\n                abovePage,\n                belowPage;\n            $item = $item || module.get.selectedItem();\n            $menu = $item.closest(selector.menu);\n            hasActive = $item && $item.length > 0;\n            forceScroll = forceScroll !== undefined ? forceScroll : false;\n\n            if ($item && $menu.length > 0 && hasActive) {\n              itemOffset = $item.position().top;\n              $menu.addClass(className.loading);\n              menuScroll = $menu.scrollTop();\n              menuOffset = $menu.offset().top;\n              itemOffset = $item.offset().top;\n              offset = menuScroll - menuOffset + itemOffset;\n\n              if (!forceScroll) {\n                menuHeight = $menu.height();\n                belowPage = menuScroll + menuHeight < offset + edgeTolerance;\n                abovePage = offset - edgeTolerance < menuScroll;\n              }\n\n              module.debug('Scrolling to active item', offset);\n\n              if (forceScroll || abovePage || belowPage) {\n                $menu.scrollTop(offset);\n              }\n\n              $menu.removeClass(className.loading);\n            }\n          },\n          text: function (text) {\n            if (settings.action !== 'select') {\n              if (settings.action == 'combo') {\n                module.debug('Changing combo button text', text, $combo);\n\n                if (settings.preserveHTML) {\n                  $combo.html(text);\n                } else {\n                  $combo.text(text);\n                }\n              } else {\n                if (text !== module.get.placeholderText()) {\n                  $text.removeClass(className.placeholder);\n                }\n\n                module.debug('Changing text', text, $text);\n                $text.removeClass(className.filtered);\n\n                if (settings.preserveHTML) {\n                  $text.html(text);\n                } else {\n                  $text.text(text);\n                }\n              }\n            }\n          },\n          selectedLetter: function (letter) {\n            var $selectedItem = $item.filter('.' + className.selected),\n                alreadySelectedLetter = $selectedItem.length > 0 && module.has.firstLetter($selectedItem, letter),\n                $nextValue = false,\n                $nextItem; // check next of same letter\n\n            if (alreadySelectedLetter) {\n              $nextItem = $selectedItem.nextAll($item).eq(0);\n\n              if (module.has.firstLetter($nextItem, letter)) {\n                $nextValue = $nextItem;\n              }\n            } // check all values\n\n\n            if (!$nextValue) {\n              $item.each(function () {\n                if (module.has.firstLetter($(this), letter)) {\n                  $nextValue = $(this);\n                  return false;\n                }\n              });\n            } // set next value\n\n\n            if ($nextValue) {\n              module.verbose('Scrolling to next value with letter', letter);\n              module.set.scrollPosition($nextValue);\n              $selectedItem.removeClass(className.selected);\n              $nextValue.addClass(className.selected);\n            }\n          },\n          direction: function ($menu) {\n            if (settings.direction == 'auto') {\n              if (module.is.onScreen($menu)) {\n                module.remove.upward($menu);\n              } else {\n                module.set.upward($menu);\n              }\n            } else if (settings.direction == 'upward') {\n              module.set.upward($menu);\n            }\n          },\n          upward: function ($menu) {\n            var $element = $menu || $module;\n            $element.addClass(className.upward);\n          },\n          value: function (value, text, $selected) {\n            var hasInput = $input.length > 0,\n                isAddition = !module.has.value(value),\n                currentValue = module.get.values(),\n                stringValue = value !== undefined ? String(value) : value,\n                newValue;\n\n            if (hasInput) {\n              if (stringValue == currentValue) {\n                module.verbose('Skipping value update already same value', value, currentValue);\n\n                if (!module.is.initialLoad()) {\n                  return;\n                }\n              }\n\n              if (module.is.single() && module.has.selectInput() && module.can.extendSelect()) {\n                module.debug('Adding user option', value);\n                module.add.optionValue(value);\n              }\n\n              module.debug('Updating input value', value, currentValue);\n              internalChange = true;\n              $input.val(value);\n\n              if (settings.fireOnInit === false && module.is.initialLoad()) {\n                module.debug('Input native change event ignored on initial load');\n              } else {\n                module.trigger.change();\n              }\n\n              internalChange = false;\n            } else {\n              module.verbose('Storing value in metadata', value, $input);\n\n              if (value !== currentValue) {\n                $module.data(metadata.value, stringValue);\n              }\n            }\n\n            if (settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('No callback on initial load', settings.onChange);\n            } else {\n              settings.onChange.call(element, value, text, $selected);\n            }\n          },\n          active: function () {\n            $module.addClass(className.active);\n          },\n          multiple: function () {\n            $module.addClass(className.multiple);\n          },\n          visible: function () {\n            $module.addClass(className.visible);\n          },\n          exactly: function (value, $selectedItem) {\n            module.debug('Setting selected to exact values');\n            module.clear();\n            module.set.selected(value, $selectedItem);\n          },\n          selected: function (value, $selectedItem) {\n            var isMultiple = module.is.multiple(),\n                $userSelectedItem;\n            $selectedItem = settings.allowAdditions ? $selectedItem || module.get.itemWithAdditions(value) : $selectedItem || module.get.item(value);\n\n            if (!$selectedItem) {\n              return;\n            }\n\n            module.debug('Setting selected menu item to', $selectedItem);\n\n            if (module.is.single()) {\n              module.remove.activeItem();\n              module.remove.selectedItem();\n            } else if (settings.useLabels) {\n              module.remove.selectedItem();\n            } // select each item\n\n\n            $selectedItem.each(function () {\n              var $selected = $(this),\n                  selectedText = module.get.choiceText($selected),\n                  selectedValue = module.get.choiceValue($selected, selectedText),\n                  isFiltered = $selected.hasClass(className.filtered),\n                  isActive = $selected.hasClass(className.active),\n                  isUserValue = $selected.hasClass(className.addition),\n                  shouldAnimate = isMultiple && $selectedItem.length == 1;\n\n              if (isMultiple) {\n                if (!isActive || isUserValue) {\n                  if (settings.apiSettings && settings.saveRemoteData) {\n                    module.save.remoteData(selectedText, selectedValue);\n                  }\n\n                  if (settings.useLabels) {\n                    module.add.value(selectedValue, selectedText, $selected);\n                    module.add.label(selectedValue, selectedText, shouldAnimate);\n                    module.set.activeItem($selected);\n                    module.filterActive();\n                    module.select.nextAvailable($selectedItem);\n                  } else {\n                    module.add.value(selectedValue, selectedText, $selected);\n                    module.set.text(module.add.variables(message.count));\n                    module.set.activeItem($selected);\n                  }\n                } else if (!isFiltered) {\n                  module.debug('Selected active value, removing label');\n                  module.remove.selected(selectedValue);\n                }\n              } else {\n                if (settings.apiSettings && settings.saveRemoteData) {\n                  module.save.remoteData(selectedText, selectedValue);\n                }\n\n                module.set.text(selectedText);\n                module.set.value(selectedValue, selectedText, $selected);\n                $selected.addClass(className.active).addClass(className.selected);\n              }\n            });\n          }\n        },\n        add: {\n          label: function (value, text, shouldAnimate) {\n            var $next = module.is.searchSelection() ? $search : $text,\n                $label;\n            $label = $('<a />').addClass(className.label).attr('data-value', value).html(templates.label(value, text));\n            $label = settings.onLabelCreate.call($label, value, text);\n\n            if (module.has.label(value)) {\n              module.debug('Label already exists, skipping', value);\n              return;\n            }\n\n            if (settings.label.variation) {\n              $label.addClass(settings.label.variation);\n            }\n\n            if (shouldAnimate === true) {\n              module.debug('Animating in label', $label);\n              $label.addClass(className.hidden).insertBefore($next).transition(settings.label.transition, settings.label.duration);\n            } else {\n              module.debug('Adding selection label', $label);\n              $label.insertBefore($next);\n            }\n          },\n          message: function (message) {\n            var $message = $menu.children(selector.message),\n                html = settings.templates.message(module.add.variables(message));\n\n            if ($message.length > 0) {\n              $message.html(html);\n            } else {\n              $message = $('<div/>').html(html).addClass(className.message).appendTo($menu);\n            }\n          },\n          optionValue: function (value) {\n            var $option = $input.find('option[value=\"' + value + '\"]'),\n                hasOption = $option.length > 0;\n\n            if (hasOption) {\n              return;\n            } // temporarily disconnect observer\n\n\n            if (selectObserver) {\n              selectObserver.disconnect();\n              module.verbose('Temporarily disconnecting mutation observer', value);\n            }\n\n            if (module.is.single()) {\n              module.verbose('Removing previous user addition');\n              $input.find('option.' + className.addition).remove();\n            }\n\n            $('<option/>').prop('value', value).addClass(className.addition).html(value).appendTo($input);\n            module.verbose('Adding user addition as an <option>', value);\n\n            if (selectObserver) {\n              selectObserver.observe($input[0], {\n                childList: true,\n                subtree: true\n              });\n            }\n          },\n          userSuggestion: function (value) {\n            var $addition = $menu.children(selector.addition),\n                $existingItem = module.get.item(value),\n                alreadyHasValue = $existingItem && $existingItem.not(selector.addition).length,\n                hasUserSuggestion = $addition.length > 0,\n                html;\n\n            if (settings.useLabels && module.has.maxSelections()) {\n              return;\n            }\n\n            if (value === '' || alreadyHasValue) {\n              $addition.remove();\n              return;\n            }\n\n            $item.removeClass(className.selected);\n\n            if (hasUserSuggestion) {\n              html = settings.templates.addition(module.add.variables(message.addResult, value));\n              $addition.html(html).attr('data-' + metadata.value, value).attr('data-' + metadata.text, value).removeClass(className.filtered).addClass(className.selected);\n              module.verbose('Replacing user suggestion with new value', $addition);\n            } else {\n              $addition = module.create.userChoice(value);\n              $addition.prependTo($menu).addClass(className.selected);\n              module.verbose('Adding item choice to menu corresponding with user choice addition', $addition);\n            }\n          },\n          variables: function (message, term) {\n            var hasCount = message.search('{count}') !== -1,\n                hasMaxCount = message.search('{maxCount}') !== -1,\n                hasTerm = message.search('{term}') !== -1,\n                values,\n                count,\n                query;\n            module.verbose('Adding templated variables to message', message);\n\n            if (hasCount) {\n              count = module.get.selectionCount();\n              message = message.replace('{count}', count);\n            }\n\n            if (hasMaxCount) {\n              count = module.get.selectionCount();\n              message = message.replace('{maxCount}', settings.maxSelections);\n            }\n\n            if (hasTerm) {\n              query = term || module.get.query();\n              message = message.replace('{term}', query);\n            }\n\n            return message;\n          },\n          value: function (addedValue, addedText, $selectedItem) {\n            var currentValue = module.get.values(),\n                newValue;\n\n            if (addedValue === '') {\n              module.debug('Cannot select blank values from multiselect');\n              return;\n            } // extend current array\n\n\n            if ($.isArray(currentValue)) {\n              newValue = currentValue.concat([addedValue]);\n              newValue = module.get.uniqueArray(newValue);\n            } else {\n              newValue = [addedValue];\n            } // add values\n\n\n            if (module.has.selectInput()) {\n              if (module.can.extendSelect()) {\n                module.debug('Adding value to select', addedValue, newValue, $input);\n                module.add.optionValue(addedValue);\n              }\n            } else {\n              newValue = newValue.join(settings.delimiter);\n              module.debug('Setting hidden input to delimited value', newValue, $input);\n            }\n\n            if (settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('Skipping onadd callback on initial load', settings.onAdd);\n            } else {\n              settings.onAdd.call(element, addedValue, addedText, $selectedItem);\n            }\n\n            module.set.value(newValue, addedValue, addedText, $selectedItem);\n            module.check.maxSelections();\n          }\n        },\n        remove: {\n          active: function () {\n            $module.removeClass(className.active);\n          },\n          activeLabel: function () {\n            $module.find(selector.label).removeClass(className.active);\n          },\n          loading: function () {\n            $module.removeClass(className.loading);\n          },\n          initialLoad: function () {\n            initialLoad = false;\n          },\n          upward: function ($menu) {\n            var $element = $menu || $module;\n            $element.removeClass(className.upward);\n          },\n          visible: function () {\n            $module.removeClass(className.visible);\n          },\n          activeItem: function () {\n            $item.removeClass(className.active);\n          },\n          filteredItem: function () {\n            if (settings.useLabels && module.has.maxSelections()) {\n              return;\n            }\n\n            if (settings.useLabels && module.is.multiple()) {\n              $item.not('.' + className.active).removeClass(className.filtered);\n            } else {\n              $item.removeClass(className.filtered);\n            }\n          },\n          optionValue: function (value) {\n            var $option = $input.find('option[value=\"' + value + '\"]'),\n                hasOption = $option.length > 0;\n\n            if (!hasOption || !$option.hasClass(className.addition)) {\n              return;\n            } // temporarily disconnect observer\n\n\n            if (selectObserver) {\n              selectObserver.disconnect();\n              module.verbose('Temporarily disconnecting mutation observer', value);\n            }\n\n            $option.remove();\n            module.verbose('Removing user addition as an <option>', value);\n\n            if (selectObserver) {\n              selectObserver.observe($input[0], {\n                childList: true,\n                subtree: true\n              });\n            }\n          },\n          message: function () {\n            $menu.children(selector.message).remove();\n          },\n          searchTerm: function () {\n            module.verbose('Cleared search term');\n            $search.val('');\n            module.set.filtered();\n          },\n          selected: function (value, $selectedItem) {\n            $selectedItem = settings.allowAdditions ? $selectedItem || module.get.itemWithAdditions(value) : $selectedItem || module.get.item(value);\n\n            if (!$selectedItem) {\n              return false;\n            }\n\n            $selectedItem.each(function () {\n              var $selected = $(this),\n                  selectedText = module.get.choiceText($selected),\n                  selectedValue = module.get.choiceValue($selected, selectedText);\n\n              if (module.is.multiple()) {\n                if (settings.useLabels) {\n                  module.remove.value(selectedValue, selectedText, $selected);\n                  module.remove.label(selectedValue);\n                } else {\n                  module.remove.value(selectedValue, selectedText, $selected);\n\n                  if (module.get.selectionCount() === 0) {\n                    module.set.placeholderText();\n                  } else {\n                    module.set.text(module.add.variables(message.count));\n                  }\n                }\n              } else {\n                module.remove.value(selectedValue, selectedText, $selected);\n              }\n\n              $selected.removeClass(className.filtered).removeClass(className.active);\n\n              if (settings.useLabels) {\n                $selected.removeClass(className.selected);\n              }\n            });\n          },\n          selectedItem: function () {\n            $item.removeClass(className.selected);\n          },\n          value: function (removedValue, removedText, $removedItem) {\n            var values = module.get.values(),\n                newValue;\n\n            if (module.has.selectInput()) {\n              module.verbose('Input is <select> removing selected option', removedValue);\n              newValue = module.remove.arrayValue(removedValue, values);\n              module.remove.optionValue(removedValue);\n            } else {\n              module.verbose('Removing from delimited values', removedValue);\n              newValue = module.remove.arrayValue(removedValue, values);\n              newValue = newValue.join(settings.delimiter);\n            }\n\n            if (settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('No callback on initial load', settings.onRemove);\n            } else {\n              settings.onRemove.call(element, removedValue, removedText, $removedItem);\n            }\n\n            module.set.value(newValue, removedText, $removedItem);\n            module.check.maxSelections();\n          },\n          arrayValue: function (removedValue, values) {\n            if (!$.isArray(values)) {\n              values = [values];\n            }\n\n            values = $.grep(values, function (value) {\n              return removedValue != value;\n            });\n            module.verbose('Removed value from delimited string', removedValue, values);\n            return values;\n          },\n          label: function (value, shouldAnimate) {\n            var $labels = $module.find(selector.label),\n                $removedLabel = $labels.filter('[data-value=\"' + value + '\"]');\n            module.verbose('Removing label', $removedLabel);\n            $removedLabel.remove();\n          },\n          activeLabels: function ($activeLabels) {\n            $activeLabels = $activeLabels || $module.find(selector.label).filter('.' + className.active);\n            module.verbose('Removing active label selections', $activeLabels);\n            module.remove.labels($activeLabels);\n          },\n          labels: function ($labels) {\n            $labels = $labels || $module.find(selector.label);\n            module.verbose('Removing labels', $labels);\n            $labels.each(function () {\n              var $label = $(this),\n                  value = $label.data(metadata.value),\n                  stringValue = value !== undefined ? String(value) : value,\n                  isUserValue = module.is.userValue(stringValue);\n\n              if (settings.onLabelRemove.call($label, value) === false) {\n                module.debug('Label remove callback cancelled removal');\n                return;\n              }\n\n              if (isUserValue) {\n                module.remove.value(stringValue);\n                module.remove.label(stringValue);\n              } else {\n                // selected will also remove label\n                module.remove.selected(stringValue);\n              }\n            });\n          },\n          tabbable: function () {\n            if (module.has.search()) {\n              module.debug('Searchable dropdown initialized');\n              $search.removeAttr('tabindex');\n              $menu.removeAttr('tabindex');\n            } else {\n              module.debug('Simple selection dropdown initialized');\n              $module.removeAttr('tabindex');\n              $menu.removeAttr('tabindex');\n            }\n          }\n        },\n        has: {\n          search: function () {\n            return $search.length > 0;\n          },\n          selectInput: function () {\n            return $input.is('select');\n          },\n          firstLetter: function ($item, letter) {\n            var text, firstLetter;\n\n            if (!$item || $item.length === 0 || typeof letter !== 'string') {\n              return false;\n            }\n\n            text = module.get.choiceText($item, false);\n            letter = letter.toLowerCase();\n            firstLetter = String(text).charAt(0).toLowerCase();\n            return letter == firstLetter;\n          },\n          input: function () {\n            return $input.length > 0;\n          },\n          items: function () {\n            return $item.length > 0;\n          },\n          menu: function () {\n            return $menu.length > 0;\n          },\n          message: function () {\n            return $menu.children(selector.message).length !== 0;\n          },\n          label: function (value) {\n            var $labels = $module.find(selector.label);\n            return $labels.filter('[data-value=\"' + value + '\"]').length > 0;\n          },\n          maxSelections: function () {\n            return settings.maxSelections && module.get.selectionCount() >= settings.maxSelections;\n          },\n          allResultsFiltered: function () {\n            return $item.filter(selector.unselectable).length === $item.length;\n          },\n          query: function () {\n            return module.get.query() !== '';\n          },\n          value: function (value) {\n            var values = module.get.values(),\n                hasValue = $.isArray(values) ? values && $.inArray(value, values) !== -1 : values == value;\n            return hasValue ? true : false;\n          }\n        },\n        is: {\n          active: function () {\n            return $module.hasClass(className.active);\n          },\n          alreadySetup: function () {\n            return $module.is('select') && $module.parent(selector.dropdown).length > 0 && $module.prev().length === 0;\n          },\n          animating: function ($subMenu) {\n            return $subMenu ? $subMenu.transition && $subMenu.transition('is animating') : $menu.transition && $menu.transition('is animating');\n          },\n          disabled: function () {\n            return $module.hasClass(className.disabled);\n          },\n          focused: function () {\n            return document.activeElement === $module[0];\n          },\n          focusedOnSearch: function () {\n            return document.activeElement === $search[0];\n          },\n          allFiltered: function () {\n            return (module.is.multiple() || module.has.search()) && !module.has.message() && module.has.allResultsFiltered();\n          },\n          hidden: function ($subMenu) {\n            return !module.is.visible($subMenu);\n          },\n          initialLoad: function () {\n            return initialLoad;\n          },\n          onScreen: function ($subMenu) {\n            var $currentMenu = $subMenu || $menu,\n                canOpenDownward = true,\n                onScreen = {},\n                calculations;\n            $currentMenu.addClass(className.loading);\n            calculations = {\n              context: {\n                scrollTop: $context.scrollTop(),\n                height: $context.outerHeight()\n              },\n              menu: {\n                offset: $currentMenu.offset(),\n                height: $currentMenu.outerHeight()\n              }\n            };\n            onScreen = {\n              above: calculations.context.scrollTop <= calculations.menu.offset.top - calculations.menu.height,\n              below: calculations.context.scrollTop + calculations.context.height >= calculations.menu.offset.top + calculations.menu.height\n            };\n\n            if (onScreen.below) {\n              module.verbose('Dropdown can fit in context downward', onScreen);\n              canOpenDownward = true;\n            } else if (!onScreen.below && !onScreen.above) {\n              module.verbose('Dropdown cannot fit in either direction, favoring downward', onScreen);\n              canOpenDownward = true;\n            } else {\n              module.verbose('Dropdown cannot fit below, opening upward', onScreen);\n              canOpenDownward = false;\n            }\n\n            $currentMenu.removeClass(className.loading);\n            return canOpenDownward;\n          },\n          inObject: function (needle, object) {\n            var found = false;\n            $.each(object, function (index, property) {\n              if (property == needle) {\n                found = true;\n                return true;\n              }\n            });\n            return found;\n          },\n          multiple: function () {\n            return $module.hasClass(className.multiple);\n          },\n          single: function () {\n            return !module.is.multiple();\n          },\n          selectMutation: function (mutations) {\n            var selectChanged = false;\n            $.each(mutations, function (index, mutation) {\n              if (mutation.target && $(mutation.target).is('select')) {\n                selectChanged = true;\n                return true;\n              }\n            });\n            return selectChanged;\n          },\n          search: function () {\n            return $module.hasClass(className.search);\n          },\n          searchSelection: function () {\n            return module.has.search() && $search.parent(selector.dropdown).length === 1;\n          },\n          selection: function () {\n            return $module.hasClass(className.selection);\n          },\n          userValue: function (value) {\n            return $.inArray(value, module.get.userValues()) !== -1;\n          },\n          upward: function ($menu) {\n            var $element = $menu || $module;\n            return $element.hasClass(className.upward);\n          },\n          visible: function ($subMenu) {\n            return $subMenu ? $subMenu.hasClass(className.visible) : $menu.hasClass(className.visible);\n          }\n        },\n        can: {\n          activate: function ($item) {\n            if (settings.useLabels) {\n              return true;\n            }\n\n            if (!module.has.maxSelections()) {\n              return true;\n            }\n\n            if (module.has.maxSelections() && $item.hasClass(className.active)) {\n              return true;\n            }\n\n            return false;\n          },\n          click: function () {\n            return hasTouch || settings.on == 'click';\n          },\n          extendSelect: function () {\n            return settings.allowAdditions || settings.apiSettings;\n          },\n          show: function () {\n            return !module.is.disabled() && (module.has.items() || module.has.message());\n          },\n          useAPI: function () {\n            return $.fn.api !== undefined;\n          }\n        },\n        animate: {\n          show: function (callback, $subMenu) {\n            var $currentMenu = $subMenu || $menu,\n                start = $subMenu ? function () {} : function () {\n              module.hideSubMenus();\n              module.hideOthers();\n              module.set.active();\n            },\n                transition;\n            callback = $.isFunction(callback) ? callback : function () {};\n            module.verbose('Doing menu show animation', $currentMenu);\n            module.set.direction($subMenu);\n            transition = module.get.transition($subMenu);\n\n            if (module.is.selection()) {\n              module.set.scrollPosition(module.get.selectedItem(), true);\n            }\n\n            if (module.is.hidden($currentMenu) || module.is.animating($currentMenu)) {\n              if (transition == 'none') {\n                start();\n                $currentMenu.transition('show');\n                callback.call(element);\n              } else if ($.fn.transition !== undefined && $module.transition('is supported')) {\n                $currentMenu.transition({\n                  animation: transition + ' in',\n                  debug: settings.debug,\n                  verbose: settings.verbose,\n                  duration: settings.duration,\n                  queue: true,\n                  onStart: start,\n                  onComplete: function () {\n                    callback.call(element);\n                  }\n                });\n              } else {\n                module.error(error.noTransition, transition);\n              }\n            }\n          },\n          hide: function (callback, $subMenu) {\n            var $currentMenu = $subMenu || $menu,\n                duration = $subMenu ? settings.duration * 0.9 : settings.duration,\n                start = $subMenu ? function () {} : function () {\n              if (module.can.click()) {\n                module.unbind.intent();\n              }\n\n              module.remove.active();\n            },\n                transition = module.get.transition($subMenu);\n            callback = $.isFunction(callback) ? callback : function () {};\n\n            if (module.is.visible($currentMenu) || module.is.animating($currentMenu)) {\n              module.verbose('Doing menu hide animation', $currentMenu);\n\n              if (transition == 'none') {\n                start();\n                $currentMenu.transition('hide');\n                callback.call(element);\n              } else if ($.fn.transition !== undefined && $module.transition('is supported')) {\n                $currentMenu.transition({\n                  animation: transition + ' out',\n                  duration: settings.duration,\n                  debug: settings.debug,\n                  verbose: settings.verbose,\n                  queue: true,\n                  onStart: start,\n                  onComplete: function () {\n                    if (settings.direction == 'auto') {\n                      module.remove.upward($subMenu);\n                    }\n\n                    callback.call(element);\n                  }\n                });\n              } else {\n                module.error(error.transition);\n              }\n            }\n          }\n        },\n        hideAndClear: function () {\n          module.remove.searchTerm();\n\n          if (module.has.maxSelections()) {\n            return;\n          }\n\n          if (module.has.search()) {\n            module.hide(function () {\n              module.remove.filteredItem();\n            });\n          } else {\n            module.hide();\n          }\n        },\n        delay: {\n          show: function () {\n            module.verbose('Delaying show event to ensure user intent');\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.show, settings.delay.show);\n          },\n          hide: function () {\n            module.verbose('Delaying hide event to ensure user intent');\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.hide, settings.delay.hide);\n          }\n        },\n        escape: {\n          regExp: function (text) {\n            text = String(text);\n            return text.replace(regExp.escape, '\\\\$&');\n          }\n        },\n        setting: function (name, value) {\n          module.debug('Changing setting', name, value);\n\n          if ($.isPlainObject(name)) {\n            $.extend(true, settings, name);\n          } else if (value !== undefined) {\n            settings[name] = value;\n          } else {\n            return settings[name];\n          }\n        },\n        internal: function (name, value) {\n          if ($.isPlainObject(name)) {\n            $.extend(true, module, name);\n          } else if (value !== undefined) {\n            module[name] = value;\n          } else {\n            return module[name];\n          }\n        },\n        debug: function () {\n          if (settings.debug) {\n            if (settings.performance) {\n              module.performance.log(arguments);\n            } else {\n              module.debug = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.debug.apply(console, arguments);\n            }\n          }\n        },\n        verbose: function () {\n          if (settings.verbose && settings.debug) {\n            if (settings.performance) {\n              module.performance.log(arguments);\n            } else {\n              module.verbose = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.verbose.apply(console, arguments);\n            }\n          }\n        },\n        error: function () {\n          module.error = Function.prototype.bind.call(console.error, console, settings.name + ':');\n          module.error.apply(console, arguments);\n        },\n        performance: {\n          log: function (message) {\n            var currentTime, executionTime, previousTime;\n\n            if (settings.performance) {\n              currentTime = new Date().getTime();\n              previousTime = time || currentTime;\n              executionTime = currentTime - previousTime;\n              time = currentTime;\n              performance.push({\n                'Name': message[0],\n                'Arguments': [].slice.call(message, 1) || '',\n                'Element': element,\n                'Execution Time': executionTime\n              });\n            }\n\n            clearTimeout(module.performance.timer);\n            module.performance.timer = setTimeout(module.performance.display, 500);\n          },\n          display: function () {\n            var title = settings.name + ':',\n                totalTime = 0;\n            time = false;\n            clearTimeout(module.performance.timer);\n            $.each(performance, function (index, data) {\n              totalTime += data['Execution Time'];\n            });\n            title += ' ' + totalTime + 'ms';\n\n            if (moduleSelector) {\n              title += ' \\'' + moduleSelector + '\\'';\n            }\n\n            if ((console.group !== undefined || console.table !== undefined) && performance.length > 0) {\n              console.groupCollapsed(title);\n\n              if (console.table) {\n                console.table(performance);\n              } else {\n                $.each(performance, function (index, data) {\n                  console.log(data['Name'] + ': ' + data['Execution Time'] + 'ms');\n                });\n              }\n\n              console.groupEnd();\n            }\n\n            performance = [];\n          }\n        },\n        invoke: function (query, passedArguments, context) {\n          var object = instance,\n              maxDepth,\n              found,\n              response;\n          passedArguments = passedArguments || queryArguments;\n          context = element || context;\n\n          if (typeof query == 'string' && object !== undefined) {\n            query = query.split(/[\\. ]/);\n            maxDepth = query.length - 1;\n            $.each(query, function (depth, value) {\n              var camelCaseValue = depth != maxDepth ? value + query[depth + 1].charAt(0).toUpperCase() + query[depth + 1].slice(1) : query;\n\n              if ($.isPlainObject(object[camelCaseValue]) && depth != maxDepth) {\n                object = object[camelCaseValue];\n              } else if (object[camelCaseValue] !== undefined) {\n                found = object[camelCaseValue];\n                return false;\n              } else if ($.isPlainObject(object[value]) && depth != maxDepth) {\n                object = object[value];\n              } else if (object[value] !== undefined) {\n                found = object[value];\n                return false;\n              } else {\n                module.error(error.method, query);\n                return false;\n              }\n            });\n          }\n\n          if ($.isFunction(found)) {\n            response = found.apply(context, passedArguments);\n          } else if (found !== undefined) {\n            response = found;\n          }\n\n          if ($.isArray(returnedValue)) {\n            returnedValue.push(response);\n          } else if (returnedValue !== undefined) {\n            returnedValue = [returnedValue, response];\n          } else if (response !== undefined) {\n            returnedValue = response;\n          }\n\n          return found;\n        }\n      };\n\n      if (methodInvoked) {\n        if (instance === undefined) {\n          module.initialize();\n        }\n\n        module.invoke(query);\n      } else {\n        if (instance !== undefined) {\n          instance.invoke('destroy');\n        }\n\n        module.initialize();\n      }\n    });\n    return returnedValue !== undefined ? returnedValue : $allModules;\n  };\n\n  $.fn.dropdown.settings = {\n    debug: false,\n    verbose: false,\n    performance: true,\n    on: 'click',\n    // what event should show menu action on item selection\n    action: 'activate',\n    // action on item selection (nothing, activate, select, combo, hide, function(){})\n    apiSettings: false,\n    saveRemoteData: true,\n    // Whether remote name/value pairs should be stored in sessionStorage to allow remote data to be restored on page refresh\n    throttle: 200,\n    // How long to wait after last user input to search remotely\n    context: window,\n    // Context to use when determining if on screen\n    direction: 'auto',\n    // Whether dropdown should always open in one direction\n    keepOnScreen: true,\n    // Whether dropdown should check whether it is on screen before showing\n    match: 'both',\n    // what to match against with search selection (both, text, or label)\n    fullTextSearch: false,\n    // search anywhere in value\n    placeholder: 'auto',\n    // whether to convert blank <select> values to placeholder text\n    preserveHTML: true,\n    // preserve html when selecting value\n    sortSelect: false,\n    // sort selection on init\n    forceSelection: true,\n    // force a choice on blur with search selection\n    allowAdditions: false,\n    // whether multiple select should allow user added values\n    maxSelections: false,\n    // When set to a number limits the number of selections to this count\n    useLabels: true,\n    // whether multiple select should filter currently active selections from choices\n    delimiter: ',',\n    // when multiselect uses normal <input> the values will be delimited with this character\n    showOnFocus: true,\n    // show menu on focus\n    allowTab: true,\n    // add tabindex to element\n    allowCategorySelection: false,\n    // allow elements with sub-menus to be selected\n    fireOnInit: false,\n    // Whether callbacks should fire when initializing dropdown values\n    transition: 'auto',\n    // auto transition will slide down or up based on direction\n    duration: 200,\n    // duration of transition\n    glyphWidth: 1.0714,\n    // widest glyph width in em (W is 1.0714 em) used to calculate multiselect input width\n    // label settings on multi-select\n    label: {\n      transition: 'scale',\n      duration: 200,\n      variation: false\n    },\n    // delay before event\n    delay: {\n      hide: 300,\n      show: 200,\n      search: 20,\n      touch: 50\n    },\n\n    /* Callbacks */\n    onChange: function (value, text, $selected) {},\n    onAdd: function (value, text, $selected) {},\n    onRemove: function (value, text, $selected) {},\n    onLabelSelect: function ($selectedLabels) {},\n    onLabelCreate: function (value, text) {\n      return $(this);\n    },\n    onLabelRemove: function (value) {\n      return true;\n    },\n    onNoResults: function (searchTerm) {\n      return true;\n    },\n    onShow: function () {},\n    onHide: function () {},\n\n    /* Component */\n    name: 'Dropdown',\n    namespace: 'dropdown',\n    message: {\n      addResult: 'Add <b>{term}</b>',\n      count: '{count} selected',\n      maxSelections: 'Max {maxCount} selections',\n      noResults: 'No results found.',\n      serverError: 'There was an error contacting the server'\n    },\n    error: {\n      action: 'You called a dropdown action that was not defined',\n      alreadySetup: 'Once a select has been initialized behaviors must be called on the created ui dropdown',\n      labels: 'Allowing user additions currently requires the use of labels.',\n      missingMultiple: '<select> requires multiple property to be set to correctly preserve multiple values',\n      method: 'The method you called is not defined.',\n      noAPI: 'The API module is required to load resources remotely',\n      noStorage: 'Saving remote data requires session storage',\n      noTransition: 'This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>'\n    },\n    regExp: {\n      escape: /[-[\\]{}()*+?.,\\\\^$|#\\s]/g\n    },\n    metadata: {\n      defaultText: 'defaultText',\n      defaultValue: 'defaultValue',\n      placeholderText: 'placeholder',\n      text: 'text',\n      value: 'value'\n    },\n    // property names for remote query\n    fields: {\n      remoteValues: 'results',\n      // grouping for api results\n      values: 'values',\n      // grouping for all dropdown values\n      name: 'name',\n      // displayed dropdown text\n      value: 'value' // actual dropdown value\n\n    },\n    keys: {\n      backspace: 8,\n      delimiter: 188,\n      // comma\n      deleteKey: 46,\n      enter: 13,\n      escape: 27,\n      pageUp: 33,\n      pageDown: 34,\n      leftArrow: 37,\n      upArrow: 38,\n      rightArrow: 39,\n      downArrow: 40\n    },\n    selector: {\n      addition: '.addition',\n      dropdown: '.ui.dropdown',\n      icon: '> .dropdown.icon',\n      input: '> input[type=\"hidden\"], > select',\n      item: '.item',\n      label: '> .label',\n      remove: '> .label > .delete.icon',\n      siblingLabel: '.label',\n      menu: '.menu',\n      message: '.message',\n      menuIcon: '.dropdown.icon',\n      search: 'input.search, .menu > .search > input',\n      text: '> .text:not(.icon)',\n      unselectable: '.disabled, .filtered'\n    },\n    className: {\n      active: 'active',\n      addition: 'addition',\n      animating: 'animating',\n      disabled: 'disabled',\n      dropdown: 'ui dropdown',\n      filtered: 'filtered',\n      hidden: 'hidden transition',\n      item: 'item',\n      label: 'ui label',\n      loading: 'loading',\n      menu: 'menu',\n      message: 'message',\n      multiple: 'multiple',\n      placeholder: 'default',\n      search: 'search',\n      selected: 'selected',\n      selection: 'selection',\n      upward: 'upward',\n      visible: 'visible'\n    }\n  };\n  /* Templates */\n\n  $.fn.dropdown.settings.templates = {\n    // generates dropdown from select values\n    dropdown: function (select) {\n      var placeholder = select.placeholder || false,\n          values = select.values || {},\n          html = '';\n      html += '<i class=\"dropdown icon\"></i>';\n\n      if (select.placeholder) {\n        html += '<div class=\"default text\">' + placeholder + '</div>';\n      } else {\n        html += '<div class=\"text\"></div>';\n      }\n\n      html += '<div class=\"menu\">';\n      $.each(select.values, function (index, option) {\n        html += option.disabled ? '<div class=\"disabled item\" data-value=\"' + option.value + '\">' + option.name + '</div>' : '<div class=\"item\" data-value=\"' + option.value + '\">' + option.name + '</div>';\n      });\n      html += '</div>';\n      return html;\n    },\n    // generates just menu from select\n    menu: function (response, fields) {\n      var values = response[fields.values] || {},\n          html = '';\n      $.each(values, function (index, option) {\n        html += '<div class=\"item\" data-value=\"' + option[fields.value] + '\">' + option[fields.name] + '</div>';\n      });\n      return html;\n    },\n    // generates label for multiselect\n    label: function (value, text) {\n      return text + '<i class=\"delete icon\"></i>';\n    },\n    // generates messages like \"No results\"\n    message: function (message) {\n      return message;\n    },\n    // generates user addition to selection menu\n    addition: function (choice) {\n      return choice;\n    }\n  };\n})(jQuery, window, document);","map":{"version":3,"sources":["client/lib/definitions/modules/dropdown.js"],"names":["$","window","document","undefined","fn","dropdown","parameters","$allModules","$document","moduleSelector","selector","hasTouch","documentElement","time","Date","getTime","performance","query","arguments","methodInvoked","queryArguments","slice","call","returnedValue","each","elementIndex","settings","isPlainObject","extend","className","message","fields","keys","metadata","namespace","regExp","error","templates","eventNamespace","moduleNamespace","$module","$context","context","$text","find","text","$search","search","$input","input","$icon","icon","$combo","prev","length","$menu","children","menu","$item","item","activated","itemActivated","internalChange","element","instance","data","initialLoad","pageLostFocus","elementNamespace","id","selectObserver","menuObserver","module","initialize","debug","is","alreadySetup","setup","reference","layout","refreshData","save","defaults","restore","selected","create","bind","events","observeChanges","instantiate","verbose","destroy","remove","tabbable","off","removeData","disconnect","MutationObserver","mutations","select","refresh","has","observe","childList","subtree","Math","random","toString","substr","userChoice","values","$userChoices","$userChoice","isUserValue","html","get","userValues","isArray","index","value","addition","add","variables","addResult","attr","addClass","userLabels","label","appendTo","filter","firstUnfiltered","selectedItem","not","unselectable","eq","nextAvailable","$selected","$nextAvailable","nextAll","$prevAvailable","prevAll","hasNext","api","apiSettings","on","returnedObject","prop","insertBefore","allowTab","set","selectValues","parent","closest","selection","hasClass","multiple","missingMultiple","disabled","removeAttr","detach","prependTo","invoke","$firstModules","$lastModules","refreshSelectors","defaultText","defaultValue","placeholderText","toggle","active","show","hide","callback","isFunction","can","allFiltered","maxSelections","allResultsFiltered","onShow","animate","click","intent","visible","onHide","hideOthers","hideMenu","transition","hideSubMenus","$subMenus","touchEvents","keyboardEvents","inputEvents","mouseEvents","searchSelection","single","event","test","mouseenter","keydown","inputEvent","change","mousedown","mouseup","focus","blur","delay","mouseleave","touch","unbind","searchTerm","afterFiltered","filterActive","onNoResults","allowAdditions","noResults","userSuggestion","focusedOnSearch","useLabels","useAPI","queryRemote","noAPI","filterItems","errorDuration","throttle","urlData","onError","serverError","onFailure","onSuccess","response","remoteValues","results","escapedTerm","escape","beginsWithRegExp","RegExp","$choice","match","String","choiceText","push","fullTextSearch","fuzzySearch","choiceValue","filteredItem","filtered","term","termLength","queryLength","toLowerCase","characterIndex","nextCharacterIndex","queryCharacter","charCodeAt","focusSearch","forceSelection","$currentlySelected","$activeItem","$selectedItem","hasSelected","size","showOnFocus","hidden","$target","target","activeElement","activeLabel","stopPropagation","clearTimeout","timer","setTimeout","$label","$labels","$activeLabels","$nextActive","$prevActive","$range","nextUntil","prevUntil","shiftKey","removeClass","ctrlKey","toggleClass","onLabelSelect","apply","activeLabels","toggleBehavior","determine","eventOnElement","preventDefault","type","eventInModule","$subMenu","$otherMenus","siblings","itemTimer","touchend","hasSubMenu","isBubbledEvent","allowCategorySelection","scrollPosition","selectAction","pressedKey","which","isShortcutKey","inObject","$activeLabel","activeValue","labelIndex","labelCount","hasActiveLabel","hasMultipleActive","isFirstLabel","isLastLabel","isSearch","isFocusedOnSearch","isFocused","focused","caretAtStart","caretPosition","$nextLabel","leftArrow","last","siblingLabel","end","rightArrow","first","next","deleteKey","backspace","$visibleItems","andSelf","$parentMenu","inVisibleMenu","animating","hasSelectedItem","selectedIsSelectable","delimiterPressed","delimiter","$nextItem","isSubMenuItem","newIndex","enter","upArrow","downArrow","pageUp","scrollPage","pageDown","selectedLetter","fromCharCode","trigger","createEvent","inputElement","initEvent","dispatchEvent","action","inDocument","inModule","notOnLabel","notInMenu","nothing","activate","hideAndClear","combo","trim","val","searchWidth","characterCount","glyphWidth","selectionCount","count","upward","grep","uniqueArray","array","inArray","range","rangeLength","selectionStart","createRange","moveStart","selectInput","split","name","read","remoteData","preserveHTML","clone","menuIcon","oninput","onpropertychange","$option","placeholder","sortSelect","sort","a","b","activeItem","itemWithAdditions","$items","$userItems","hasUserItems","strict","shouldSearch","isMultiple","optionText","optionValue","check","clear","labels","saveRemoteData","clearValue","Storage","noStorage","sessionStorage","getItem","setItem","direction","$currentItem","menuHeight","outerHeight","currentScroll","scrollTop","itemHeight","itemsPerPage","floor","maxScroll","newScroll","$selectableItem","isWithinRange","$nextSelectedItem","isSearchMultiple","searchValue","hasSearchValue","valueIsSet","css","loading","forceScroll","edgeTolerance","hasActive","offset","itemOffset","menuOffset","menuScroll","abovePage","belowPage","position","top","height","letter","alreadySelectedLetter","firstLetter","$nextValue","onScreen","$element","hasInput","isAddition","currentValue","stringValue","newValue","extendSelect","fireOnInit","onChange","exactly","$userSelectedItem","selectedText","selectedValue","isFiltered","isActive","shouldAnimate","$next","onLabelCreate","variation","duration","$message","hasOption","$addition","$existingItem","alreadyHasValue","hasUserSuggestion","hasCount","hasMaxCount","hasTerm","replace","addedValue","addedText","concat","join","onAdd","removedValue","removedText","$removedItem","arrayValue","onRemove","$removedLabel","userValue","onLabelRemove","charAt","items","hasValue","$currentMenu","canOpenDownward","calculations","above","below","needle","object","found","property","selectMutation","selectChanged","mutation","start","animation","queue","onStart","onComplete","noTransition","setting","internal","log","Function","prototype","console","info","currentTime","executionTime","previousTime","display","title","totalTime","group","table","groupCollapsed","groupEnd","passedArguments","maxDepth","depth","camelCaseValue","toUpperCase","method","keepOnScreen","$selectedLabels","option","choice","jQuery"],"mappings":"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","sourcesContent":["/*\n  DO NOT MODIFY - This file has been generated and will be regenerated\n  Semantic UI v2.1.8\n*/\n/*!\n * # Semantic UI - Dropdown\n * http://github.com/semantic-org/semantic-ui/\n *\n *\n * Copyright 2015 Contributors\n * Released under the MIT license\n * http://opensource.org/licenses/MIT\n *\n */\n\n;(function ( $, window, document, undefined ) {\n\n\"use strict\";\n\n$.fn.dropdown = function(parameters) {\n  var\n    $allModules    = $(this),\n    $document      = $(document),\n\n    moduleSelector = $allModules.selector || '',\n\n    hasTouch       = ('ontouchstart' in document.documentElement),\n    time           = new Date().getTime(),\n    performance    = [],\n\n    query          = arguments[0],\n    methodInvoked  = (typeof query == 'string'),\n    queryArguments = [].slice.call(arguments, 1),\n    returnedValue\n  ;\n\n  $allModules\n    .each(function(elementIndex) {\n      var\n        settings          = ( $.isPlainObject(parameters) )\n          ? $.extend(true, {}, $.fn.dropdown.settings, parameters)\n          : $.extend({}, $.fn.dropdown.settings),\n\n        className       = settings.className,\n        message         = settings.message,\n        fields          = settings.fields,\n        keys            = settings.keys,\n        metadata        = settings.metadata,\n        namespace       = settings.namespace,\n        regExp          = settings.regExp,\n        selector        = settings.selector,\n        error           = settings.error,\n        templates       = settings.templates,\n\n        eventNamespace  = '.' + namespace,\n        moduleNamespace = 'module-' + namespace,\n\n        $module         = $(this),\n        $context        = $(settings.context),\n        $text           = $module.find(selector.text),\n        $search         = $module.find(selector.search),\n        $input          = $module.find(selector.input),\n        $icon           = $module.find(selector.icon),\n\n        $combo = ($module.prev().find(selector.text).length > 0)\n          ? $module.prev().find(selector.text)\n          : $module.prev(),\n\n        $menu           = $module.children(selector.menu),\n        $item           = $menu.find(selector.item),\n\n        activated       = false,\n        itemActivated   = false,\n        internalChange  = false,\n        element         = this,\n        instance        = $module.data(moduleNamespace),\n\n        initialLoad,\n        pageLostFocus,\n        elementNamespace,\n        id,\n        selectObserver,\n        menuObserver,\n        module\n      ;\n\n      module = {\n\n        initialize: function() {\n          module.debug('Initializing dropdown', settings);\n\n          if( module.is.alreadySetup() ) {\n            module.setup.reference();\n          }\n          else {\n            module.setup.layout();\n            module.refreshData();\n\n            module.save.defaults();\n            module.restore.selected();\n\n            module.create.id();\n            module.bind.events();\n\n            module.observeChanges();\n            module.instantiate();\n          }\n\n        },\n\n        instantiate: function() {\n          module.verbose('Storing instance of dropdown', module);\n          instance = module;\n          $module\n            .data(moduleNamespace, module)\n          ;\n        },\n\n        destroy: function() {\n          module.verbose('Destroying previous dropdown', $module);\n          module.remove.tabbable();\n          $module\n            .off(eventNamespace)\n            .removeData(moduleNamespace)\n          ;\n          $menu\n            .off(eventNamespace)\n          ;\n          $document\n            .off(elementNamespace)\n          ;\n          if(selectObserver) {\n            selectObserver.disconnect();\n          }\n          if(menuObserver) {\n            menuObserver.disconnect();\n          }\n        },\n\n        observeChanges: function() {\n          if('MutationObserver' in window) {\n            selectObserver = new MutationObserver(function(mutations) {\n              module.debug('<select> modified, recreating menu');\n              module.setup.select();\n            });\n            menuObserver = new MutationObserver(function(mutations) {\n              module.debug('Menu modified, updating selector cache');\n              module.refresh();\n            });\n            if(module.has.input()) {\n              selectObserver.observe($input[0], {\n                childList : true,\n                subtree   : true\n              });\n            }\n            if(module.has.menu()) {\n              menuObserver.observe($menu[0], {\n                childList : true,\n                subtree   : true\n              });\n            }\n            module.debug('Setting up mutation observer', selectObserver, menuObserver);\n          }\n        },\n\n        create: {\n          id: function() {\n            id = (Math.random().toString(16) + '000000000').substr(2, 8);\n            elementNamespace = '.' + id;\n            module.verbose('Creating unique id for element', id);\n          },\n          userChoice: function(values) {\n            var\n              $userChoices,\n              $userChoice,\n              isUserValue,\n              html\n            ;\n            values = values || module.get.userValues();\n            if(!values) {\n              return false;\n            }\n            values = $.isArray(values)\n              ? values\n              : [values]\n            ;\n            $.each(values, function(index, value) {\n              if(module.get.item(value) === false) {\n                html         = settings.templates.addition( module.add.variables(message.addResult, value) );\n                $userChoice  = $('<div />')\n                  .html(html)\n                  .attr('data-' + metadata.value, value)\n                  .attr('data-' + metadata.text, value)\n                  .addClass(className.addition)\n                  .addClass(className.item)\n                ;\n                $userChoices = ($userChoices === undefined)\n                  ? $userChoice\n                  : $userChoices.add($userChoice)\n                ;\n                module.verbose('Creating user choices for value', value, $userChoice);\n              }\n            });\n            return $userChoices;\n          },\n          userLabels: function(value) {\n            var\n              userValues = module.get.userValues()\n            ;\n            if(userValues) {\n              module.debug('Adding user labels', userValues);\n              $.each(userValues, function(index, value) {\n                module.verbose('Adding custom user value');\n                module.add.label(value, value);\n              });\n            }\n          },\n          menu: function() {\n            $menu = $('<div />')\n              .addClass(className.menu)\n              .appendTo($module)\n            ;\n          }\n        },\n\n        search: function(query) {\n          query = (query !== undefined)\n            ? query\n            : module.get.query()\n          ;\n          module.verbose('Searching for query', query);\n          module.filter(query);\n        },\n\n        select: {\n          firstUnfiltered: function() {\n            module.verbose('Selecting first non-filtered element');\n            module.remove.selectedItem();\n            $item\n              .not(selector.unselectable)\n                .eq(0)\n                .addClass(className.selected)\n            ;\n          },\n          nextAvailable: function($selected) {\n            $selected = $selected.eq(0);\n            var\n              $nextAvailable = $selected.nextAll(selector.item).not(selector.unselectable).eq(0),\n              $prevAvailable = $selected.prevAll(selector.item).not(selector.unselectable).eq(0),\n              hasNext        = ($nextAvailable.length > 0)\n            ;\n            if(hasNext) {\n              module.verbose('Moving selection to', $nextAvailable);\n              $nextAvailable.addClass(className.selected);\n            }\n            else {\n              module.verbose('Moving selection to', $prevAvailable);\n              $prevAvailable.addClass(className.selected);\n            }\n          }\n        },\n\n        setup: {\n          api: function() {\n            var\n              apiSettings = {\n                debug : settings.debug,\n                on    : false\n              }\n            ;\n            module.verbose('First request, initializing API');\n            $module\n              .api(apiSettings)\n            ;\n          },\n          layout: function() {\n            if( $module.is('select') ) {\n              module.setup.select();\n              module.setup.returnedObject();\n            }\n            if( !module.has.menu() ) {\n              module.create.menu();\n            }\n            if( module.is.search() && !module.has.search() ) {\n              module.verbose('Adding search input');\n              $search = $('<input />')\n                .addClass(className.search)\n                .prop('autocomplete', 'off')\n                .insertBefore($text)\n              ;\n            }\n            if(settings.allowTab) {\n              module.set.tabbable();\n            }\n          },\n          select: function() {\n            var\n              selectValues  = module.get.selectValues()\n            ;\n            module.debug('Dropdown initialized on a select', selectValues);\n            if( $module.is('select') ) {\n              $input = $module;\n            }\n            // see if select is placed correctly already\n            if($input.parent(selector.dropdown).length > 0) {\n              module.debug('UI dropdown already exists. Creating dropdown menu only');\n              $module = $input.closest(selector.dropdown);\n              if( !module.has.menu() ) {\n                module.create.menu();\n              }\n              $menu = $module.children(selector.menu);\n              module.setup.menu(selectValues);\n            }\n            else {\n              module.debug('Creating entire dropdown from select');\n              $module = $('<div />')\n                .attr('class', $input.attr('class') )\n                .addClass(className.selection)\n                .addClass(className.dropdown)\n                .html( templates.dropdown(selectValues) )\n                .insertBefore($input)\n              ;\n              if($input.hasClass(className.multiple) && $input.prop('multiple') === false) {\n                module.error(error.missingMultiple);\n                $input.prop('multiple', true);\n              }\n              if($input.is('[multiple]')) {\n                module.set.multiple();\n              }\n              if ($input.prop('disabled')) {\n                module.debug('Disabling dropdown')\n                $module.addClass(className.disabled)\n              }\n              $input\n                .removeAttr('class')\n                .detach()\n                .prependTo($module)\n              ;\n            }\n            module.refresh();\n          },\n          menu: function(values) {\n            $menu.html( templates.menu(values, fields));\n            $item = $menu.find(selector.item);\n          },\n          reference: function() {\n            module.debug('Dropdown behavior was called on select, replacing with closest dropdown');\n            // replace module reference\n            $module = $module.parent(selector.dropdown);\n            module.refresh();\n            module.setup.returnedObject();\n            // invoke method in context of current instance\n            if(methodInvoked) {\n              instance = module;\n              module.invoke(query);\n            }\n          },\n          returnedObject: function() {\n            var\n              $firstModules = $allModules.slice(0, elementIndex),\n              $lastModules = $allModules.slice(elementIndex + 1)\n            ;\n            // adjust all modules to use correct reference\n            $allModules = $firstModules.add($module).add($lastModules);\n          }\n        },\n\n        refresh: function() {\n          module.refreshSelectors();\n          module.refreshData();\n        },\n\n        refreshSelectors: function() {\n          module.verbose('Refreshing selector cache');\n          $text   = $module.find(selector.text);\n          $search = $module.find(selector.search);\n          $input  = $module.find(selector.input);\n          $icon   = $module.find(selector.icon);\n          $combo  = ($module.prev().find(selector.text).length > 0)\n            ? $module.prev().find(selector.text)\n            : $module.prev()\n          ;\n          $menu    = $module.children(selector.menu);\n          $item    = $menu.find(selector.item);\n        },\n\n        refreshData: function() {\n          module.verbose('Refreshing cached metadata');\n          $item\n            .removeData(metadata.text)\n            .removeData(metadata.value)\n          ;\n          $module\n            .removeData(metadata.defaultText)\n            .removeData(metadata.defaultValue)\n            .removeData(metadata.placeholderText)\n          ;\n        },\n\n        toggle: function() {\n          module.verbose('Toggling menu visibility');\n          if( !module.is.active() ) {\n            module.show();\n          }\n          else {\n            module.hide();\n          }\n        },\n\n        show: function(callback) {\n          callback = $.isFunction(callback)\n            ? callback\n            : function(){}\n          ;\n          if( module.can.show() && !module.is.active() ) {\n            module.debug('Showing dropdown');\n            if(module.is.multiple() && !module.has.search() && module.is.allFiltered()) {\n              return true;\n            }\n            if(module.has.message() && !(module.has.maxSelections() || module.has.allResultsFiltered()) ) {\n              module.remove.message();\n            }\n            if(settings.onShow.call(element) !== false) {\n              module.animate.show(function() {\n                if( module.can.click() ) {\n                  module.bind.intent();\n                }\n                module.set.visible();\n                callback.call(element);\n              });\n            }\n          }\n        },\n\n        hide: function(callback) {\n          callback = $.isFunction(callback)\n            ? callback\n            : function(){}\n          ;\n          if( module.is.active() ) {\n            module.debug('Hiding dropdown');\n            if(settings.onHide.call(element) !== false) {\n              module.animate.hide(function() {\n                module.remove.visible();\n                callback.call(element);\n              });\n            }\n          }\n        },\n\n        hideOthers: function() {\n          module.verbose('Finding other dropdowns to hide');\n          $allModules\n            .not($module)\n              .has(selector.menu + '.' + className.visible)\n                .dropdown('hide')\n          ;\n        },\n\n        hideMenu: function() {\n          module.verbose('Hiding menu  instantaneously');\n          module.remove.active();\n          module.remove.visible();\n          $menu.transition('hide');\n        },\n\n        hideSubMenus: function() {\n          var\n            $subMenus = $menu.children(selector.item).find(selector.menu)\n          ;\n          module.verbose('Hiding sub menus', $subMenus);\n          $subMenus.transition('hide');\n        },\n\n        bind: {\n          events: function() {\n            if(hasTouch) {\n              module.bind.touchEvents();\n            }\n            module.bind.keyboardEvents();\n            module.bind.inputEvents();\n            module.bind.mouseEvents();\n          },\n          touchEvents: function() {\n            module.debug('Touch device detected binding additional touch events');\n            if( module.is.searchSelection() ) {\n              // do nothing special yet\n            }\n            else if( module.is.single() ) {\n              $module\n                .on('touchstart' + eventNamespace, module.event.test.toggle)\n              ;\n            }\n            $menu\n              .on('touchstart' + eventNamespace, selector.item, module.event.item.mouseenter)\n            ;\n          },\n          keyboardEvents: function() {\n            module.verbose('Binding keyboard events');\n            $module\n              .on('keydown' + eventNamespace, module.event.keydown)\n            ;\n            if( module.has.search() ) {\n              $module\n                .on(module.get.inputEvent() + eventNamespace, selector.search, module.event.input)\n              ;\n            }\n            if( module.is.multiple() ) {\n              $document\n                .on('keydown' + elementNamespace, module.event.document.keydown)\n              ;\n            }\n          },\n          inputEvents: function() {\n            module.verbose('Binding input change events');\n            $module\n              .on('change' + eventNamespace, selector.input, module.event.change)\n            ;\n          },\n          mouseEvents: function() {\n            module.verbose('Binding mouse events');\n            if(module.is.multiple()) {\n              $module\n                .on('click'   + eventNamespace, selector.label,  module.event.label.click)\n                .on('click'   + eventNamespace, selector.remove, module.event.remove.click)\n              ;\n            }\n            if( module.is.searchSelection() ) {\n              $module\n                .on('mousedown' + eventNamespace, selector.menu,   module.event.menu.mousedown)\n                .on('mouseup'   + eventNamespace, selector.menu,   module.event.menu.mouseup)\n                .on('click'     + eventNamespace, selector.icon,   module.event.icon.click)\n                .on('click'     + eventNamespace, selector.search, module.show)\n                .on('focus'     + eventNamespace, selector.search, module.event.search.focus)\n                .on('blur'      + eventNamespace, selector.search, module.event.search.blur)\n                .on('click'     + eventNamespace, selector.text,   module.event.text.focus)\n              ;\n              if(module.is.multiple()) {\n                $module\n                  .on('click' + eventNamespace, module.event.click)\n                ;\n              }\n            }\n            else {\n              if(settings.on == 'click') {\n                $module\n                  .on('click' + eventNamespace, selector.icon, module.event.icon.click)\n                  .on('click' + eventNamespace, module.event.test.toggle)\n                ;\n              }\n              else if(settings.on == 'hover') {\n                $module\n                  .on('mouseenter' + eventNamespace, module.delay.show)\n                  .on('mouseleave' + eventNamespace, module.delay.hide)\n                ;\n              }\n              else {\n                $module\n                  .on(settings.on + eventNamespace, module.toggle)\n                ;\n              }\n              $module\n                .on('mousedown' + eventNamespace, module.event.mousedown)\n                .on('mouseup'   + eventNamespace, module.event.mouseup)\n                .on('focus'     + eventNamespace, module.event.focus)\n                .on('blur'      + eventNamespace, module.event.blur)\n              ;\n            }\n            $menu\n              .on('mouseenter' + eventNamespace, selector.item, module.event.item.mouseenter)\n              .on('mouseleave' + eventNamespace, selector.item, module.event.item.mouseleave)\n              .on('click'      + eventNamespace, selector.item, module.event.item.click)\n            ;\n          },\n          intent: function() {\n            module.verbose('Binding hide intent event to document');\n            if(hasTouch) {\n              $document\n                .on('touchstart' + elementNamespace, module.event.test.touch)\n                .on('touchmove'  + elementNamespace, module.event.test.touch)\n              ;\n            }\n            $document\n              .on('click' + elementNamespace, module.event.test.hide)\n            ;\n          }\n        },\n\n        unbind: {\n          intent: function() {\n            module.verbose('Removing hide intent event from document');\n            if(hasTouch) {\n              $document\n                .off('touchstart' + elementNamespace)\n                .off('touchmove' + elementNamespace)\n              ;\n            }\n            $document\n              .off('click' + elementNamespace)\n            ;\n          }\n        },\n\n        filter: function(query) {\n          var\n            searchTerm = (query !== undefined)\n              ? query\n              : module.get.query(),\n            afterFiltered = function() {\n              if(module.is.multiple()) {\n                module.filterActive();\n              }\n              module.select.firstUnfiltered();\n              if( module.has.allResultsFiltered() ) {\n                if( settings.onNoResults.call(element, searchTerm) ) {\n                  if(!settings.allowAdditions) {\n                    module.verbose('All items filtered, showing message', searchTerm);\n                    module.add.message(message.noResults);\n                  }\n                }\n                else {\n                  module.verbose('All items filtered, hiding dropdown', searchTerm);\n                  module.hideMenu();\n                }\n              }\n              else {\n                module.remove.message();\n              }\n              if(settings.allowAdditions) {\n                module.add.userSuggestion(query);\n              }\n              if(module.is.searchSelection() && module.can.show() && module.is.focusedOnSearch() ) {\n                module.show();\n              }\n            }\n          ;\n          if(settings.useLabels && module.has.maxSelections()) {\n            return;\n          }\n          if(settings.apiSettings) {\n            if( module.can.useAPI() ) {\n              module.queryRemote(searchTerm, function() {\n                afterFiltered();\n              });\n            }\n            else {\n              module.error(error.noAPI);\n            }\n          }\n          else {\n            module.filterItems(searchTerm);\n            afterFiltered();\n          }\n        },\n\n        queryRemote: function(query, callback) {\n          var\n            apiSettings = {\n              errorDuration        : false,\n              throttle             : settings.throttle,\n              urlData              : {\n                query: query\n              },\n              onError: function() {\n                module.add.message(message.serverError);\n                callback();\n              },\n              onFailure: function() {\n                module.add.message(message.serverError);\n                callback();\n              },\n              onSuccess : function(response) {\n                module.remove.message();\n                module.setup.menu({\n                  values: response[fields.remoteValues]\n                });\n                callback();\n              }\n            }\n          ;\n          if( !$module.api('get request') ) {\n            module.setup.api();\n          }\n          apiSettings = $.extend(true, {}, apiSettings, settings.apiSettings);\n          $module\n            .api('setting', apiSettings)\n            .api('query')\n          ;\n        },\n\n        filterItems: function(query) {\n          var\n            searchTerm = (query !== undefined)\n              ? query\n              : module.get.query(),\n            results          =  null,\n            escapedTerm      = module.escape.regExp(searchTerm),\n            beginsWithRegExp = new RegExp('^' + escapedTerm, 'igm')\n          ;\n          // avoid loop if we're matching nothing\n          if( module.has.query() ) {\n            results = [];\n\n            module.verbose('Searching for matching values', searchTerm);\n            $item\n              .each(function(){\n                var\n                  $choice = $(this),\n                  text,\n                  value\n                ;\n                if(settings.match == 'both' || settings.match == 'text') {\n                  text = String(module.get.choiceText($choice, false));\n                  if(text.search(beginsWithRegExp) !== -1) {\n                    results.push(this);\n                    return true;\n                  }\n                  else if(settings.fullTextSearch && module.fuzzySearch(searchTerm, text)) {\n                    results.push(this);\n                    return true;\n                  }\n                }\n                if(settings.match == 'both' || settings.match == 'value') {\n                  value = String(module.get.choiceValue($choice, text));\n\n                  if(value.search(beginsWithRegExp) !== -1) {\n                    results.push(this);\n                    return true;\n                  }\n                  else if(settings.fullTextSearch && module.fuzzySearch(searchTerm, value)) {\n                    results.push(this);\n                    return true;\n                  }\n                }\n              })\n            ;\n          }\n          module.debug('Showing only matched items', searchTerm);\n          module.remove.filteredItem();\n          if(results) {\n            $item\n              .not(results)\n              .addClass(className.filtered)\n            ;\n          }\n        },\n\n        fuzzySearch: function(query, term) {\n          var\n            termLength  = term.length,\n            queryLength = query.length\n          ;\n          query = query.toLowerCase();\n          term  = term.toLowerCase();\n          if(queryLength > termLength) {\n            return false;\n          }\n          if(queryLength === termLength) {\n            return (query === term);\n          }\n          search: for (var characterIndex = 0, nextCharacterIndex = 0; characterIndex < queryLength; characterIndex++) {\n            var\n              queryCharacter = query.charCodeAt(characterIndex)\n            ;\n            while(nextCharacterIndex < termLength) {\n              if(term.charCodeAt(nextCharacterIndex++) === queryCharacter) {\n                continue search;\n              }\n            }\n            return false;\n          }\n          return true;\n        },\n\n        filterActive: function() {\n          if(settings.useLabels) {\n            $item.filter('.' + className.active)\n              .addClass(className.filtered)\n            ;\n          }\n        },\n\n        focusSearch: function() {\n          if( module.is.search() && !module.is.focusedOnSearch() ) {\n            $search[0].focus();\n          }\n        },\n\n        forceSelection: function() {\n          var\n            $currentlySelected = $item.not(className.filtered).filter('.' + className.selected).eq(0),\n            $activeItem        = $item.not(className.filtered).filter('.' + className.active).eq(0),\n            $selectedItem      = ($currentlySelected.length > 0)\n              ? $currentlySelected\n              : $activeItem,\n            hasSelected = ($selectedItem.size() > 0)\n          ;\n          if( module.has.query() ) {\n            if(hasSelected) {\n              module.debug('Forcing partial selection to selected item', $selectedItem);\n              module.event.item.click.call($selectedItem);\n              return;\n            }\n            else {\n              module.remove.searchTerm();\n            }\n          }\n          module.hide();\n        },\n\n        event: {\n          change: function() {\n            if(!internalChange) {\n              module.debug('Input changed, updating selection');\n              module.set.selected();\n            }\n          },\n          focus: function() {\n            if(settings.showOnFocus && !activated && module.is.hidden() && !pageLostFocus) {\n              module.show();\n            }\n          },\n          click: function(event) {\n            var\n              $target = $(event.target)\n            ;\n            // focus search\n            if($target.is($module) && !module.is.focusedOnSearch()) {\n              module.focusSearch();\n            }\n          },\n          blur: function(event) {\n            pageLostFocus = (document.activeElement === this);\n            if(!activated && !pageLostFocus) {\n              module.remove.activeLabel();\n              module.hide();\n            }\n          },\n          // prevents focus callback from occurring on mousedown\n          mousedown: function() {\n            activated = true;\n          },\n          mouseup: function() {\n            activated = false;\n          },\n          search: {\n            focus: function() {\n              activated = true;\n              if(module.is.multiple()) {\n                module.remove.activeLabel();\n              }\n              if(settings.showOnFocus) {\n                module.search();\n                module.show();\n              }\n            },\n            blur: function(event) {\n              pageLostFocus = (document.activeElement === this);\n              if(!itemActivated && !pageLostFocus) {\n                if(module.is.multiple()) {\n                  module.remove.activeLabel();\n                  module.hide();\n                }\n                else if(settings.forceSelection) {\n                  module.forceSelection();\n                }\n                else {\n                  module.hide();\n                }\n              }\n              else if(pageLostFocus) {\n                if(settings.forceSelection) {\n                  module.forceSelection();\n                }\n              }\n            }\n          },\n          icon: {\n            click: function(event) {\n              module.toggle();\n              event.stopPropagation();\n            }\n          },\n          text: {\n            focus: function(event) {\n              activated = true;\n              module.focusSearch();\n            }\n          },\n          input: function(event) {\n            if(module.is.multiple() || module.is.searchSelection()) {\n              module.set.filtered();\n            }\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.search, settings.delay.search);\n          },\n          label: {\n            click: function(event) {\n              var\n                $label        = $(this),\n                $labels       = $module.find(selector.label),\n                $activeLabels = $labels.filter('.' + className.active),\n                $nextActive   = $label.nextAll('.' + className.active),\n                $prevActive   = $label.prevAll('.' + className.active),\n                $range = ($nextActive.length > 0)\n                  ? $label.nextUntil($nextActive).add($activeLabels).add($label)\n                  : $label.prevUntil($prevActive).add($activeLabels).add($label)\n              ;\n              if(event.shiftKey) {\n                $activeLabels.removeClass(className.active);\n                $range.addClass(className.active);\n              }\n              else if(event.ctrlKey) {\n                $label.toggleClass(className.active);\n              }\n              else {\n                $activeLabels.removeClass(className.active);\n                $label.addClass(className.active);\n              }\n              settings.onLabelSelect.apply(this, $labels.filter('.' + className.active));\n            }\n          },\n          remove: {\n            click: function() {\n              var\n                $label = $(this).parent()\n              ;\n              if( $label.hasClass(className.active) ) {\n                // remove all selected labels\n                module.remove.activeLabels();\n              }\n              else {\n                // remove this label only\n                module.remove.activeLabels( $label );\n              }\n            }\n          },\n          test: {\n            toggle: function(event) {\n              var\n                toggleBehavior = (module.is.multiple())\n                  ? module.show\n                  : module.toggle\n              ;\n              if( module.determine.eventOnElement(event, toggleBehavior) ) {\n                event.preventDefault();\n              }\n            },\n            touch: function(event) {\n              module.determine.eventOnElement(event, function() {\n                if(event.type == 'touchstart') {\n                  module.timer = setTimeout(function() {\n                    module.hide();\n                  }, settings.delay.touch);\n                }\n                else if(event.type == 'touchmove') {\n                  clearTimeout(module.timer);\n                }\n              });\n              event.stopPropagation();\n            },\n            hide: function(event) {\n              module.determine.eventInModule(event, module.hide);\n            }\n          },\n          menu: {\n            mousedown: function() {\n              itemActivated = true;\n            },\n            mouseup: function() {\n              itemActivated = false;\n            }\n          },\n          item: {\n            mouseenter: function(event) {\n              var\n                $subMenu    = $(this).children(selector.menu),\n                $otherMenus = $(this).siblings(selector.item).children(selector.menu)\n              ;\n              if( $subMenu.length > 0 ) {\n                clearTimeout(module.itemTimer);\n                module.itemTimer = setTimeout(function() {\n                  module.verbose('Showing sub-menu', $subMenu);\n                  $.each($otherMenus, function() {\n                    module.animate.hide(false, $(this));\n                  });\n                  module.animate.show(false,  $subMenu);\n                }, settings.delay.show);\n                event.preventDefault();\n              }\n            },\n            mouseleave: function(event) {\n              var\n                $subMenu = $(this).children(selector.menu)\n              ;\n              if($subMenu.length > 0) {\n                clearTimeout(module.itemTimer);\n                module.itemTimer = setTimeout(function() {\n                  module.verbose('Hiding sub-menu', $subMenu);\n                  module.animate.hide(false,  $subMenu);\n                }, settings.delay.hide);\n              }\n            },\n            touchend: function() {\n            },\n            click: function (event) {\n              var\n                $choice        = $(this),\n                $target        = (event)\n                  ? $(event.target)\n                  : $(''),\n                $subMenu       = $choice.find(selector.menu),\n                text           = module.get.choiceText($choice),\n                value          = module.get.choiceValue($choice, text),\n                hasSubMenu     = ($subMenu.length > 0),\n                isBubbledEvent = ($subMenu.find($target).length > 0)\n              ;\n              if(!isBubbledEvent && (!hasSubMenu || settings.allowCategorySelection)) {\n                if(!settings.useLabels) {\n                  module.remove.filteredItem();\n                  module.remove.searchTerm();\n                  module.set.scrollPosition($choice);\n                }\n                module.determine.selectAction.call(this, text, value);\n              }\n            }\n          },\n\n          document: {\n            // label selection should occur even when element has no focus\n            keydown: function(event) {\n              var\n                pressedKey    = event.which,\n                isShortcutKey = module.is.inObject(pressedKey, keys)\n              ;\n              if(isShortcutKey) {\n                var\n                  $label            = $module.find(selector.label),\n                  $activeLabel      = $label.filter('.' + className.active),\n                  activeValue       = $activeLabel.data(metadata.value),\n                  labelIndex        = $label.index($activeLabel),\n                  labelCount        = $label.length,\n                  hasActiveLabel    = ($activeLabel.length > 0),\n                  hasMultipleActive = ($activeLabel.length > 1),\n                  isFirstLabel      = (labelIndex === 0),\n                  isLastLabel       = (labelIndex + 1 == labelCount),\n                  isSearch          = module.is.searchSelection(),\n                  isFocusedOnSearch = module.is.focusedOnSearch(),\n                  isFocused         = module.is.focused(),\n                  caretAtStart      = (isFocusedOnSearch && module.get.caretPosition() === 0),\n                  $nextLabel\n                ;\n                if(isSearch && !hasActiveLabel && !isFocusedOnSearch) {\n                  return;\n                }\n\n                if(pressedKey == keys.leftArrow) {\n                  // activate previous label\n                  if((isFocused || caretAtStart) && !hasActiveLabel) {\n                    module.verbose('Selecting previous label');\n                    $label.last().addClass(className.active);\n                  }\n                  else if(hasActiveLabel) {\n                    if(!event.shiftKey) {\n                      module.verbose('Selecting previous label');\n                      $label.removeClass(className.active);\n                    }\n                    else {\n                      module.verbose('Adding previous label to selection');\n                    }\n                    if(isFirstLabel && !hasMultipleActive) {\n                      $activeLabel.addClass(className.active);\n                    }\n                    else {\n                      $activeLabel.prev(selector.siblingLabel)\n                        .addClass(className.active)\n                        .end()\n                      ;\n                    }\n                    event.preventDefault();\n                  }\n                }\n                else if(pressedKey == keys.rightArrow) {\n                  // activate first label\n                  if(isFocused && !hasActiveLabel) {\n                    $label.first().addClass(className.active);\n                  }\n                  // activate next label\n                  if(hasActiveLabel) {\n                    if(!event.shiftKey) {\n                      module.verbose('Selecting next label');\n                      $label.removeClass(className.active);\n                    }\n                    else {\n                      module.verbose('Adding next label to selection');\n                    }\n                    if(isLastLabel) {\n                      if(isSearch) {\n                        if(!isFocusedOnSearch) {\n                          module.focusSearch();\n                        }\n                        else {\n                          $label.removeClass(className.active);\n                        }\n                      }\n                      else if(hasMultipleActive) {\n                        $activeLabel.next(selector.siblingLabel).addClass(className.active);\n                      }\n                      else {\n                        $activeLabel.addClass(className.active);\n                      }\n                    }\n                    else {\n                      $activeLabel.next(selector.siblingLabel).addClass(className.active);\n                    }\n                    event.preventDefault();\n                  }\n                }\n                else if(pressedKey == keys.deleteKey || pressedKey == keys.backspace) {\n                  if(hasActiveLabel) {\n                    module.verbose('Removing active labels');\n                    if(isLastLabel) {\n                      if(isSearch && !isFocusedOnSearch) {\n                        module.focusSearch();\n                      }\n                    }\n                    $activeLabel.last().next(selector.siblingLabel).addClass(className.active);\n                    module.remove.activeLabels($activeLabel);\n                    event.preventDefault();\n                  }\n                  else if(caretAtStart && !hasActiveLabel && pressedKey == keys.backspace) {\n                    module.verbose('Removing last label on input backspace');\n                    $activeLabel = $label.last().addClass(className.active);\n                    module.remove.activeLabels($activeLabel);\n                  }\n                }\n                else {\n                  $activeLabel.removeClass(className.active);\n                }\n              }\n            }\n          },\n\n          keydown: function(event) {\n            var\n              pressedKey    = event.which,\n              isShortcutKey = module.is.inObject(pressedKey, keys)\n            ;\n            if(isShortcutKey) {\n              var\n                $currentlySelected = $item.not(selector.unselectable).filter('.' + className.selected).eq(0),\n                $activeItem        = $menu.children('.' + className.active).eq(0),\n                $selectedItem      = ($currentlySelected.length > 0)\n                  ? $currentlySelected\n                  : $activeItem,\n                $visibleItems = ($selectedItem.length > 0)\n                  ? $selectedItem.siblings(':not(.' + className.filtered +')').andSelf()\n                  : $menu.children(':not(.' + className.filtered +')'),\n                $subMenu             = $selectedItem.children(selector.menu),\n                $parentMenu          = $selectedItem.closest(selector.menu),\n                inVisibleMenu        = ($parentMenu.hasClass(className.visible) || $parentMenu.hasClass(className.animating) || $parentMenu.parent(selector.menu).length > 0),\n                hasSubMenu           = ($subMenu.length> 0),\n                hasSelectedItem      = ($selectedItem.length > 0),\n                selectedIsSelectable = ($selectedItem.not(selector.unselectable).length > 0),\n                delimiterPressed     = (pressedKey == keys.delimiter && settings.allowAdditions && module.is.multiple()),\n                $nextItem,\n                isSubMenuItem,\n                newIndex\n              ;\n              // visible menu keyboard shortcuts\n              if( module.is.visible() ) {\n\n                // enter (select or open sub-menu)\n                if(pressedKey == keys.enter || delimiterPressed) {\n                  if(pressedKey == keys.enter && hasSelectedItem && hasSubMenu && !settings.allowCategorySelection) {\n                    module.verbose('Pressed enter on unselectable category, opening sub menu');\n                    pressedKey = keys.rightArrow;\n                  }\n                  else if(selectedIsSelectable) {\n                    module.verbose('Selecting item from keyboard shortcut', $selectedItem);\n                    module.event.item.click.call($selectedItem, event);\n                    if(module.is.searchSelection()) {\n                      module.remove.searchTerm();\n                    }\n                  }\n                  event.preventDefault();\n                }\n\n                // left arrow (hide sub-menu)\n                if(pressedKey == keys.leftArrow) {\n\n                  isSubMenuItem = ($parentMenu[0] !== $menu[0]);\n\n                  if(isSubMenuItem) {\n                    module.verbose('Left key pressed, closing sub-menu');\n                    module.animate.hide(false,  $parentMenu);\n                    $selectedItem\n                      .removeClass(className.selected)\n                    ;\n                    $parentMenu\n                      .closest(selector.item)\n                        .addClass(className.selected)\n                    ;\n                    event.preventDefault();\n                  }\n                }\n\n                // right arrow (show sub-menu)\n                if(pressedKey == keys.rightArrow) {\n                  if(hasSubMenu) {\n                    module.verbose('Right key pressed, opening sub-menu');\n                    module.animate.show(false,  $subMenu);\n                    $selectedItem\n                      .removeClass(className.selected)\n                    ;\n                    $subMenu\n                      .find(selector.item).eq(0)\n                        .addClass(className.selected)\n                    ;\n                    event.preventDefault();\n                  }\n                }\n\n                // up arrow (traverse menu up)\n                if(pressedKey == keys.upArrow) {\n                  $nextItem = (hasSelectedItem && inVisibleMenu)\n                    ? $selectedItem.prevAll(selector.item + ':not(' + selector.unselectable + ')').eq(0)\n                    : $item.eq(0)\n                  ;\n                  if($visibleItems.index( $nextItem ) < 0) {\n                    module.verbose('Up key pressed but reached top of current menu');\n                    event.preventDefault();\n                    return;\n                  }\n                  else {\n                    module.verbose('Up key pressed, changing active item');\n                    $selectedItem\n                      .removeClass(className.selected)\n                    ;\n                    $nextItem\n                      .addClass(className.selected)\n                    ;\n                    module.set.scrollPosition($nextItem);\n                  }\n                  event.preventDefault();\n                }\n\n                // down arrow (traverse menu down)\n                if(pressedKey == keys.downArrow) {\n                  $nextItem = (hasSelectedItem && inVisibleMenu)\n                    ? $nextItem = $selectedItem.nextAll(selector.item + ':not(' + selector.unselectable + ')').eq(0)\n                    : $item.eq(0)\n                  ;\n                  if($nextItem.length === 0) {\n                    module.verbose('Down key pressed but reached bottom of current menu');\n                    event.preventDefault();\n                    return;\n                  }\n                  else {\n                    module.verbose('Down key pressed, changing active item');\n                    $item\n                      .removeClass(className.selected)\n                    ;\n                    $nextItem\n                      .addClass(className.selected)\n                    ;\n                    module.set.scrollPosition($nextItem);\n                  }\n                  event.preventDefault();\n                }\n\n                // page down (show next page)\n                if(pressedKey == keys.pageUp) {\n                  module.scrollPage('up');\n                  event.preventDefault();\n                }\n                if(pressedKey == keys.pageDown) {\n                  module.scrollPage('down');\n                  event.preventDefault();\n                }\n\n                // escape (close menu)\n                if(pressedKey == keys.escape) {\n                  module.verbose('Escape key pressed, closing dropdown');\n                  module.hide();\n                }\n\n              }\n              else {\n                // delimiter key\n                if(delimiterPressed) {\n                  event.preventDefault();\n                }\n                // down arrow (open menu)\n                if(pressedKey == keys.downArrow) {\n                  module.verbose('Down key pressed, showing dropdown');\n                  module.show();\n                  event.preventDefault();\n                }\n              }\n            }\n            else {\n              if( module.is.selection() && !module.is.search() ) {\n                module.set.selectedLetter( String.fromCharCode(pressedKey) );\n              }\n            }\n          }\n        },\n\n        trigger: {\n          change: function() {\n            var\n              events       = document.createEvent('HTMLEvents'),\n              inputElement = $input[0]\n            ;\n            if(inputElement) {\n              module.verbose('Triggering native change event');\n              events.initEvent('change', true, false);\n              inputElement.dispatchEvent(events);\n            }\n          }\n        },\n\n        determine: {\n          selectAction: function(text, value) {\n            module.verbose('Determining action', settings.action);\n            if( $.isFunction( module.action[settings.action] ) ) {\n              module.verbose('Triggering preset action', settings.action, text, value);\n              module.action[ settings.action ].call(this, text, value);\n            }\n            else if( $.isFunction(settings.action) ) {\n              module.verbose('Triggering user action', settings.action, text, value);\n              settings.action.call(this, text, value);\n            }\n            else {\n              module.error(error.action, settings.action);\n            }\n          },\n          eventInModule: function(event, callback) {\n            var\n              $target    = $(event.target),\n              inDocument = ($target.closest(document.documentElement).length > 0),\n              inModule   = ($target.closest($module).length > 0)\n            ;\n            callback = $.isFunction(callback)\n              ? callback\n              : function(){}\n            ;\n            if(inDocument && !inModule) {\n              module.verbose('Triggering event', callback);\n              callback();\n              return true;\n            }\n            else {\n              module.verbose('Event occurred in dropdown, canceling callback');\n              return false;\n            }\n          },\n          eventOnElement: function(event, callback) {\n            var\n              $target    = $(event.target),\n              $label     = $target.closest(selector.siblingLabel),\n              notOnLabel = ($module.find($label).length === 0),\n              notInMenu  = ($target.closest($menu).length === 0)\n            ;\n            callback = $.isFunction(callback)\n              ? callback\n              : function(){}\n            ;\n            if(notOnLabel && notInMenu) {\n              module.verbose('Triggering event', callback);\n              callback();\n              return true;\n            }\n            else {\n              module.verbose('Event occurred in dropdown menu, canceling callback');\n              return false;\n            }\n          }\n        },\n\n        action: {\n\n          nothing: function() {},\n\n          activate: function(text, value) {\n            value = (value !== undefined)\n              ? value\n              : text\n            ;\n            if( module.can.activate( $(this) ) ) {\n              module.set.selected(value, $(this));\n              if(module.is.multiple() && !module.is.allFiltered()) {\n                return;\n              }\n              else {\n                module.hideAndClear();\n              }\n            }\n          },\n\n          select: function(text, value) {\n            // mimics action.activate but does not select text\n            module.action.activate.call(this);\n          },\n\n          combo: function(text, value) {\n            value = (value !== undefined)\n              ? value\n              : text\n            ;\n            module.set.selected(value, $(this));\n            module.hideAndClear();\n          },\n\n          hide: function(text, value) {\n            module.set.value(value);\n            module.hideAndClear();\n          }\n\n        },\n\n        get: {\n          id: function() {\n            return id;\n          },\n          defaultText: function() {\n            return $module.data(metadata.defaultText);\n          },\n          defaultValue: function() {\n            return $module.data(metadata.defaultValue);\n          },\n          placeholderText: function() {\n            return $module.data(metadata.placeholderText) || '';\n          },\n          text: function() {\n            return $text.text();\n          },\n          query: function() {\n            return $.trim($search.val());\n          },\n          searchWidth: function(characterCount) {\n            return (characterCount * settings.glyphWidth) + 'em';\n          },\n          selectionCount: function() {\n            var\n              values = module.get.values(),\n              count\n            ;\n            count = ( module.is.multiple() )\n              ? $.isArray(values)\n                ? values.length\n                : 0\n              : (module.get.value() !== '')\n                ? 1\n                : 0\n            ;\n            return count;\n          },\n          transition: function($subMenu) {\n            return (settings.transition == 'auto')\n              ? module.is.upward($subMenu)\n                ? 'slide up'\n                : 'slide down'\n              : settings.transition\n            ;\n          },\n          userValues: function() {\n            var\n              values = module.get.values()\n            ;\n            if(!values) {\n              return false;\n            }\n            values = $.isArray(values)\n              ? values\n              : [values]\n            ;\n            return $.grep(values, function(value) {\n              return (module.get.item(value) === false);\n            });\n          },\n          uniqueArray: function(array) {\n            return $.grep(array, function (value, index) {\n                return $.inArray(value, array) === index;\n            });\n          },\n          caretPosition: function() {\n            var\n              input = $search.get(0),\n              range,\n              rangeLength\n            ;\n            if('selectionStart' in input) {\n              return input.selectionStart;\n            }\n            else if (document.selection) {\n              input.focus();\n              range       = document.selection.createRange();\n              rangeLength = range.text.length;\n              range.moveStart('character', -input.value.length);\n              return range.text.length - rangeLength;\n            }\n          },\n          value: function() {\n            var\n              value = ($input.length > 0)\n                ? $input.val()\n                : $module.data(metadata.value)\n            ;\n            // prevents placeholder element from being selected when multiple\n            if($.isArray(value) && value.length === 1 && value[0] === '') {\n              return '';\n            }\n            return value;\n          },\n          values: function() {\n            var\n              value = module.get.value()\n            ;\n            if(value === '') {\n              return '';\n            }\n            return ( !module.has.selectInput() && module.is.multiple() )\n              ? (typeof value == 'string') // delimited string\n                ? value.split(settings.delimiter)\n                : ''\n              : value\n            ;\n          },\n          remoteValues: function() {\n            var\n              values = module.get.values(),\n              remoteValues = false\n            ;\n            if(values) {\n              if(typeof values == 'string') {\n                values = [values];\n              }\n              remoteValues = {};\n              $.each(values, function(index, value) {\n                var\n                  name = module.read.remoteData(value)\n                ;\n                module.verbose('Restoring value from session data', name, value);\n                remoteValues[value] = (name)\n                  ? name\n                  : value\n                ;\n              });\n            }\n            return remoteValues;\n          },\n          choiceText: function($choice, preserveHTML) {\n            preserveHTML = (preserveHTML !== undefined)\n              ? preserveHTML\n              : settings.preserveHTML\n            ;\n            if($choice) {\n              if($choice.find(selector.menu).length > 0) {\n                module.verbose('Retreiving text of element with sub-menu');\n                $choice = $choice.clone();\n                $choice.find(selector.menu).remove();\n                $choice.find(selector.menuIcon).remove();\n              }\n              return ($choice.data(metadata.text) !== undefined)\n                ? $choice.data(metadata.text)\n                : (preserveHTML)\n                  ? $.trim($choice.html())\n                  : $.trim($choice.text())\n              ;\n            }\n          },\n          choiceValue: function($choice, choiceText) {\n            choiceText = choiceText || module.get.choiceText($choice);\n            if(!$choice) {\n              return false;\n            }\n            return ($choice.data(metadata.value) !== undefined)\n              ? String( $choice.data(metadata.value) )\n              : (typeof choiceText === 'string')\n                ? $.trim(choiceText.toLowerCase())\n                : String(choiceText)\n            ;\n          },\n          inputEvent: function() {\n            var\n              input = $search[0]\n            ;\n            if(input) {\n              return (input.oninput !== undefined)\n                ? 'input'\n                : (input.onpropertychange !== undefined)\n                  ? 'propertychange'\n                  : 'keyup'\n              ;\n            }\n            return false;\n          },\n          selectValues: function() {\n            var\n              select = {}\n            ;\n            select.values = [];\n            $module\n              .find('option')\n                .each(function() {\n                  var\n                    $option  = $(this),\n                    name     = $option.html(),\n                    disabled = $option.attr('disabled'),\n                    value    = ( $option.attr('value') !== undefined )\n                      ? $option.attr('value')\n                      : name\n                  ;\n                  if(settings.placeholder === 'auto' && value === '') {\n                    select.placeholder = name;\n                  }\n                  else {\n                    select.values.push({\n                      name     : name,\n                      value    : value,\n                      disabled : disabled\n                    });\n                  }\n                })\n            ;\n            if(settings.placeholder && settings.placeholder !== 'auto') {\n              module.debug('Setting placeholder value to', settings.placeholder);\n              select.placeholder = settings.placeholder;\n            }\n            if(settings.sortSelect) {\n              select.values.sort(function(a, b) {\n                return (a.name > b.name)\n                  ? 1\n                  : -1\n                ;\n              });\n              module.debug('Retrieved and sorted values from select', select);\n            }\n            else {\n              module.debug('Retreived values from select', select);\n            }\n            return select;\n          },\n          activeItem: function() {\n            return $item.filter('.'  + className.active);\n          },\n          selectedItem: function() {\n            var\n              $selectedItem = $item.not(selector.unselectable).filter('.'  + className.selected)\n            ;\n            return ($selectedItem.length > 0)\n              ? $selectedItem\n              : $item.eq(0)\n            ;\n          },\n          itemWithAdditions: function(value) {\n            var\n              $items       = module.get.item(value),\n              $userItems   = module.create.userChoice(value),\n              hasUserItems = ($userItems && $userItems.length > 0)\n            ;\n            if(hasUserItems) {\n              $items = ($items.length > 0)\n                ? $items.add($userItems)\n                : $userItems\n              ;\n            }\n            return $items;\n          },\n          item: function(value, strict) {\n            var\n              $selectedItem = false,\n              shouldSearch,\n              isMultiple\n            ;\n            value = (value !== undefined)\n              ? value\n              : ( module.get.values() !== undefined)\n                ? module.get.values()\n                : module.get.text()\n            ;\n            shouldSearch = (isMultiple)\n              ? (value.length > 0)\n              : (value !== undefined && value !== null)\n            ;\n            isMultiple = (module.is.multiple() && $.isArray(value));\n            strict     = (value === '' || value === 0)\n              ? true\n              : strict || false\n            ;\n            if(shouldSearch) {\n              $item\n                .each(function() {\n                  var\n                    $choice       = $(this),\n                    optionText    = module.get.choiceText($choice),\n                    optionValue   = module.get.choiceValue($choice, optionText)\n                  ;\n                  // safe early exit\n                  if(optionValue === null || optionValue === undefined) {\n                    return;\n                  }\n                  if(isMultiple) {\n                    if($.inArray( String(optionValue), value) !== -1 || $.inArray(optionText, value) !== -1) {\n                      $selectedItem = ($selectedItem)\n                        ? $selectedItem.add($choice)\n                        : $choice\n                      ;\n                    }\n                  }\n                  else if(strict) {\n                    module.verbose('Ambiguous dropdown value using strict type check', $choice, value);\n                    if( optionValue === value || optionText === value) {\n                      $selectedItem = $choice;\n                      return true;\n                    }\n                  }\n                  else {\n                    if( String(optionValue) == String(value) || optionText == value) {\n                      module.verbose('Found select item by value', optionValue, value);\n                      $selectedItem = $choice;\n                      return true;\n                    }\n                  }\n                })\n              ;\n            }\n            return $selectedItem;\n          }\n        },\n\n        check: {\n          maxSelections: function(selectionCount) {\n            if(settings.maxSelections) {\n              selectionCount = (selectionCount !== undefined)\n                ? selectionCount\n                : module.get.selectionCount()\n              ;\n              if(selectionCount >= settings.maxSelections) {\n                module.debug('Maximum selection count reached');\n                if(settings.useLabels) {\n                  $item.addClass(className.filtered);\n                  module.add.message(message.maxSelections);\n                }\n                return true;\n              }\n              else {\n                module.verbose('No longer at maximum selection count');\n                module.remove.message();\n                module.remove.filteredItem();\n                if(module.is.searchSelection()) {\n                  module.filterItems();\n                }\n                return false;\n              }\n            }\n            return true;\n          }\n        },\n\n        restore: {\n          defaults: function() {\n            module.clear();\n            module.restore.defaultText();\n            module.restore.defaultValue();\n          },\n          defaultText: function() {\n            var\n              defaultText     = module.get.defaultText(),\n              placeholderText = module.get.placeholderText\n            ;\n            if(defaultText === placeholderText) {\n              module.debug('Restoring default placeholder text', defaultText);\n              module.set.placeholderText(defaultText);\n            }\n            else {\n              module.debug('Restoring default text', defaultText);\n              module.set.text(defaultText);\n            }\n          },\n          defaultValue: function() {\n            var\n              defaultValue = module.get.defaultValue()\n            ;\n            if(defaultValue !== undefined) {\n              module.debug('Restoring default value', defaultValue);\n              if(defaultValue !== '') {\n                module.set.value(defaultValue);\n                module.set.selected();\n              }\n              else {\n                module.remove.activeItem();\n                module.remove.selectedItem();\n              }\n            }\n          },\n          labels: function() {\n            if(settings.allowAdditions) {\n              if(!settings.useLabels) {\n                module.error(error.labels);\n                settings.useLabels = true;\n              }\n              module.debug('Restoring selected values');\n              module.create.userLabels();\n            }\n            module.check.maxSelections();\n          },\n          selected: function() {\n            module.restore.values();\n            if(module.is.multiple()) {\n              module.debug('Restoring previously selected values and labels');\n              module.restore.labels();\n            }\n            else {\n              module.debug('Restoring previously selected values');\n            }\n          },\n          values: function() {\n            // prevents callbacks from occuring on initial load\n            module.set.initialLoad();\n            if(settings.apiSettings) {\n              if(settings.saveRemoteData) {\n                module.restore.remoteValues();\n              }\n              else {\n                module.clearValue();\n              }\n            }\n            else {\n              module.set.selected();\n            }\n            module.remove.initialLoad();\n          },\n          remoteValues: function() {\n            var\n              values = module.get.remoteValues()\n            ;\n            module.debug('Recreating selected from session data', values);\n            if(values) {\n              if( module.is.single() ) {\n                $.each(values, function(value, name) {\n                  module.set.text(name);\n                });\n              }\n              else {\n                $.each(values, function(value, name) {\n                  module.add.label(value, name);\n                });\n              }\n            }\n          }\n        },\n\n        read: {\n          remoteData: function(value) {\n            var\n              name\n            ;\n            if(window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n            name = sessionStorage.getItem(value);\n            return (name !== undefined)\n              ? name\n              : false\n            ;\n          }\n        },\n\n        save: {\n          defaults: function() {\n            module.save.defaultText();\n            module.save.placeholderText();\n            module.save.defaultValue();\n          },\n          defaultValue: function() {\n            var\n              value = module.get.value()\n            ;\n            module.verbose('Saving default value as', value);\n            $module.data(metadata.defaultValue, value);\n          },\n          defaultText: function() {\n            var\n              text = module.get.text()\n            ;\n            module.verbose('Saving default text as', text);\n            $module.data(metadata.defaultText, text);\n          },\n          placeholderText: function() {\n            var\n              text\n            ;\n            if(settings.placeholder !== false && $text.hasClass(className.placeholder)) {\n              text = module.get.text();\n              module.verbose('Saving placeholder text as', text);\n              $module.data(metadata.placeholderText, text);\n            }\n          },\n          remoteData: function(name, value) {\n            if(window.Storage === undefined) {\n              module.error(error.noStorage);\n              return;\n            }\n            module.verbose('Saving remote data to session storage', value, name);\n            sessionStorage.setItem(value, name);\n          }\n        },\n\n        clear: function() {\n          if(module.is.multiple()) {\n            module.remove.labels();\n          }\n          else {\n            module.remove.activeItem();\n            module.remove.selectedItem();\n          }\n          module.set.placeholderText();\n          module.clearValue();\n        },\n\n        clearValue: function() {\n          module.set.value('');\n        },\n\n        scrollPage: function(direction, $selectedItem) {\n          var\n            $currentItem  = $selectedItem || module.get.selectedItem(),\n            $menu         = $currentItem.closest(selector.menu),\n            menuHeight    = $menu.outerHeight(),\n            currentScroll = $menu.scrollTop(),\n            itemHeight    = $item.eq(0).outerHeight(),\n            itemsPerPage  = Math.floor(menuHeight / itemHeight),\n            maxScroll     = $menu.prop('scrollHeight'),\n            newScroll     = (direction == 'up')\n              ? currentScroll - (itemHeight * itemsPerPage)\n              : currentScroll + (itemHeight * itemsPerPage),\n            $selectableItem = $item.not(selector.unselectable),\n            isWithinRange,\n            $nextSelectedItem,\n            elementIndex\n          ;\n          elementIndex      = (direction == 'up')\n            ? $selectableItem.index($currentItem) - itemsPerPage\n            : $selectableItem.index($currentItem) + itemsPerPage\n          ;\n          isWithinRange = (direction == 'up')\n            ? (elementIndex >= 0)\n            : (elementIndex < $selectableItem.length)\n          ;\n          $nextSelectedItem = (isWithinRange)\n            ? $selectableItem.eq(elementIndex)\n            : (direction == 'up')\n              ? $selectableItem.first()\n              : $selectableItem.last()\n          ;\n          if($nextSelectedItem.length > 0) {\n            module.debug('Scrolling page', direction, $nextSelectedItem);\n            $currentItem\n              .removeClass(className.selected)\n            ;\n            $nextSelectedItem\n              .addClass(className.selected)\n            ;\n            $menu\n              .scrollTop(newScroll)\n            ;\n          }\n        },\n\n        set: {\n          filtered: function() {\n            var\n              isMultiple       = module.is.multiple(),\n              isSearch         = module.is.searchSelection(),\n              isSearchMultiple = (isMultiple && isSearch),\n              searchValue      = (isSearch)\n                ? module.get.query()\n                : '',\n              hasSearchValue   = (typeof searchValue === 'string' && searchValue.length > 0),\n              searchWidth      = module.get.searchWidth(searchValue.length),\n              valueIsSet       = searchValue !== ''\n            ;\n            if(isMultiple && hasSearchValue) {\n              module.verbose('Adjusting input width', searchWidth, settings.glyphWidth);\n              $search.css('width', searchWidth);\n            }\n            if(hasSearchValue || (isSearchMultiple && valueIsSet)) {\n              module.verbose('Hiding placeholder text');\n              $text.addClass(className.filtered);\n            }\n            else if(!isMultiple || (isSearchMultiple && !valueIsSet)) {\n              module.verbose('Showing placeholder text');\n              $text.removeClass(className.filtered);\n            }\n          },\n          loading: function() {\n            $module.addClass(className.loading);\n          },\n          placeholderText: function(text) {\n            text = text || module.get.placeholderText();\n            module.debug('Setting placeholder text', text);\n            module.set.text(text);\n            $text.addClass(className.placeholder);\n          },\n          tabbable: function() {\n            if( module.has.search() ) {\n              module.debug('Added tabindex to searchable dropdown');\n              $search\n                .val('')\n                .attr('tabindex', 0)\n              ;\n              $menu\n                .attr('tabindex', -1)\n              ;\n            }\n            else {\n              module.debug('Added tabindex to dropdown');\n              if( $module.attr('tabindex') === undefined) {\n                $module\n                  .attr('tabindex', 0)\n                ;\n                $menu\n                  .attr('tabindex', -1)\n                ;\n              }\n            }\n          },\n          initialLoad: function() {\n            module.verbose('Setting initial load');\n            initialLoad = true;\n          },\n          activeItem: function($item) {\n            if( settings.allowAdditions && $item.filter(selector.addition).length > 0 ) {\n              $item.addClass(className.filtered);\n            }\n            else {\n              $item.addClass(className.active);\n            }\n          },\n          scrollPosition: function($item, forceScroll) {\n            var\n              edgeTolerance = 5,\n              $menu,\n              hasActive,\n              offset,\n              itemHeight,\n              itemOffset,\n              menuOffset,\n              menuScroll,\n              menuHeight,\n              abovePage,\n              belowPage\n            ;\n\n            $item       = $item || module.get.selectedItem();\n            $menu       = $item.closest(selector.menu);\n            hasActive   = ($item && $item.length > 0);\n            forceScroll = (forceScroll !== undefined)\n              ? forceScroll\n              : false\n            ;\n            if($item && $menu.length > 0 && hasActive) {\n              itemOffset = $item.position().top;\n\n              $menu.addClass(className.loading);\n              menuScroll = $menu.scrollTop();\n              menuOffset = $menu.offset().top;\n              itemOffset = $item.offset().top;\n              offset     = menuScroll - menuOffset + itemOffset;\n              if(!forceScroll) {\n                menuHeight = $menu.height();\n                belowPage  = menuScroll + menuHeight < (offset + edgeTolerance);\n                abovePage  = ((offset - edgeTolerance) < menuScroll);\n              }\n              module.debug('Scrolling to active item', offset);\n              if(forceScroll || abovePage || belowPage) {\n                $menu.scrollTop(offset);\n              }\n              $menu.removeClass(className.loading);\n            }\n          },\n          text: function(text) {\n            if(settings.action !== 'select') {\n              if(settings.action == 'combo') {\n                module.debug('Changing combo button text', text, $combo);\n                if(settings.preserveHTML) {\n                  $combo.html(text);\n                }\n                else {\n                  $combo.text(text);\n                }\n              }\n              else {\n                if(text !== module.get.placeholderText()) {\n                  $text.removeClass(className.placeholder);\n                }\n                module.debug('Changing text', text, $text);\n                $text\n                  .removeClass(className.filtered)\n                ;\n                if(settings.preserveHTML) {\n                  $text.html(text);\n                }\n                else {\n                  $text.text(text);\n                }\n              }\n            }\n          },\n          selectedLetter: function(letter) {\n            var\n              $selectedItem         = $item.filter('.' + className.selected),\n              alreadySelectedLetter = $selectedItem.length > 0 && module.has.firstLetter($selectedItem, letter),\n              $nextValue            = false,\n              $nextItem\n            ;\n            // check next of same letter\n            if(alreadySelectedLetter) {\n              $nextItem = $selectedItem.nextAll($item).eq(0);\n              if( module.has.firstLetter($nextItem, letter) ) {\n                $nextValue  = $nextItem;\n              }\n            }\n            // check all values\n            if(!$nextValue) {\n              $item\n                .each(function(){\n                  if(module.has.firstLetter($(this), letter)) {\n                    $nextValue = $(this);\n                    return false;\n                  }\n                })\n              ;\n            }\n            // set next value\n            if($nextValue) {\n              module.verbose('Scrolling to next value with letter', letter);\n              module.set.scrollPosition($nextValue);\n              $selectedItem.removeClass(className.selected);\n              $nextValue.addClass(className.selected);\n            }\n          },\n          direction: function($menu) {\n            if(settings.direction == 'auto') {\n              if(module.is.onScreen($menu)) {\n                module.remove.upward($menu);\n              }\n              else {\n                module.set.upward($menu);\n              }\n            }\n            else if(settings.direction == 'upward') {\n              module.set.upward($menu);\n            }\n          },\n          upward: function($menu) {\n            var $element = $menu || $module;\n            $element.addClass(className.upward);\n          },\n          value: function(value, text, $selected) {\n            var\n              hasInput     = ($input.length > 0),\n              isAddition   = !module.has.value(value),\n              currentValue = module.get.values(),\n              stringValue  = (value !== undefined)\n                ? String(value)\n                : value,\n              newValue\n            ;\n            if(hasInput) {\n              if(stringValue == currentValue) {\n                module.verbose('Skipping value update already same value', value, currentValue);\n                if(!module.is.initialLoad()) {\n                  return;\n                }\n              }\n\n              if( module.is.single() && module.has.selectInput() && module.can.extendSelect() ) {\n                module.debug('Adding user option', value);\n                module.add.optionValue(value);\n              }\n              module.debug('Updating input value', value, currentValue);\n              internalChange = true;\n              $input\n                .val(value)\n              ;\n              if(settings.fireOnInit === false && module.is.initialLoad()) {\n                module.debug('Input native change event ignored on initial load');\n              }\n              else {\n                module.trigger.change();\n              }\n              internalChange = false;\n            }\n            else {\n              module.verbose('Storing value in metadata', value, $input);\n              if(value !== currentValue) {\n                $module.data(metadata.value, stringValue);\n              }\n            }\n            if(settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('No callback on initial load', settings.onChange);\n            }\n            else {\n              settings.onChange.call(element, value, text, $selected);\n            }\n          },\n          active: function() {\n            $module\n              .addClass(className.active)\n            ;\n          },\n          multiple: function() {\n            $module.addClass(className.multiple);\n          },\n          visible: function() {\n            $module.addClass(className.visible);\n          },\n          exactly: function(value, $selectedItem) {\n            module.debug('Setting selected to exact values');\n            module.clear();\n            module.set.selected(value, $selectedItem);\n          },\n          selected: function(value, $selectedItem) {\n            var\n              isMultiple = module.is.multiple(),\n              $userSelectedItem\n            ;\n            $selectedItem = (settings.allowAdditions)\n              ? $selectedItem || module.get.itemWithAdditions(value)\n              : $selectedItem || module.get.item(value)\n            ;\n            if(!$selectedItem) {\n              return;\n            }\n            module.debug('Setting selected menu item to', $selectedItem);\n            if(module.is.single()) {\n              module.remove.activeItem();\n              module.remove.selectedItem();\n            }\n            else if(settings.useLabels) {\n              module.remove.selectedItem();\n            }\n            // select each item\n            $selectedItem\n              .each(function() {\n                var\n                  $selected      = $(this),\n                  selectedText   = module.get.choiceText($selected),\n                  selectedValue  = module.get.choiceValue($selected, selectedText),\n\n                  isFiltered     = $selected.hasClass(className.filtered),\n                  isActive       = $selected.hasClass(className.active),\n                  isUserValue    = $selected.hasClass(className.addition),\n                  shouldAnimate  = (isMultiple && $selectedItem.length == 1)\n                ;\n                if(isMultiple) {\n                  if(!isActive || isUserValue) {\n                    if(settings.apiSettings && settings.saveRemoteData) {\n                      module.save.remoteData(selectedText, selectedValue);\n                    }\n                    if(settings.useLabels) {\n                      module.add.value(selectedValue, selectedText, $selected);\n                      module.add.label(selectedValue, selectedText, shouldAnimate);\n                      module.set.activeItem($selected);\n                      module.filterActive();\n                      module.select.nextAvailable($selectedItem);\n                    }\n                    else {\n                      module.add.value(selectedValue, selectedText, $selected);\n                      module.set.text(module.add.variables(message.count));\n                      module.set.activeItem($selected);\n                    }\n                  }\n                  else if(!isFiltered) {\n                    module.debug('Selected active value, removing label');\n                    module.remove.selected(selectedValue);\n                  }\n                }\n                else {\n                  if(settings.apiSettings && settings.saveRemoteData) {\n                    module.save.remoteData(selectedText, selectedValue);\n                  }\n                  module.set.text(selectedText);\n                  module.set.value(selectedValue, selectedText, $selected);\n                  $selected\n                    .addClass(className.active)\n                    .addClass(className.selected)\n                  ;\n                }\n              })\n            ;\n          }\n        },\n\n        add: {\n          label: function(value, text, shouldAnimate) {\n            var\n              $next  = module.is.searchSelection()\n                ? $search\n                : $text,\n              $label\n            ;\n            $label =  $('<a />')\n              .addClass(className.label)\n              .attr('data-value', value)\n              .html(templates.label(value, text))\n            ;\n            $label = settings.onLabelCreate.call($label, value, text);\n\n            if(module.has.label(value)) {\n              module.debug('Label already exists, skipping', value);\n              return;\n            }\n            if(settings.label.variation) {\n              $label.addClass(settings.label.variation);\n            }\n            if(shouldAnimate === true) {\n              module.debug('Animating in label', $label);\n              $label\n                .addClass(className.hidden)\n                .insertBefore($next)\n                .transition(settings.label.transition, settings.label.duration)\n              ;\n            }\n            else {\n              module.debug('Adding selection label', $label);\n              $label\n                .insertBefore($next)\n              ;\n            }\n          },\n          message: function(message) {\n            var\n              $message = $menu.children(selector.message),\n              html     = settings.templates.message(module.add.variables(message))\n            ;\n            if($message.length > 0) {\n              $message\n                .html(html)\n              ;\n            }\n            else {\n              $message = $('<div/>')\n                .html(html)\n                .addClass(className.message)\n                .appendTo($menu)\n              ;\n            }\n          },\n          optionValue: function(value) {\n            var\n              $option   = $input.find('option[value=\"' + value + '\"]'),\n              hasOption = ($option.length > 0)\n            ;\n            if(hasOption) {\n              return;\n            }\n            // temporarily disconnect observer\n            if(selectObserver) {\n              selectObserver.disconnect();\n              module.verbose('Temporarily disconnecting mutation observer', value);\n            }\n            if( module.is.single() ) {\n              module.verbose('Removing previous user addition');\n              $input.find('option.' + className.addition).remove();\n            }\n            $('<option/>')\n              .prop('value', value)\n              .addClass(className.addition)\n              .html(value)\n              .appendTo($input)\n            ;\n            module.verbose('Adding user addition as an <option>', value);\n            if(selectObserver) {\n              selectObserver.observe($input[0], {\n                childList : true,\n                subtree   : true\n              });\n            }\n          },\n          userSuggestion: function(value) {\n            var\n              $addition         = $menu.children(selector.addition),\n              $existingItem     = module.get.item(value),\n              alreadyHasValue   = $existingItem && $existingItem.not(selector.addition).length,\n              hasUserSuggestion = $addition.length > 0,\n              html\n            ;\n            if(settings.useLabels && module.has.maxSelections()) {\n              return;\n            }\n            if(value === '' || alreadyHasValue) {\n              $addition.remove();\n              return;\n            }\n            $item\n              .removeClass(className.selected)\n            ;\n            if(hasUserSuggestion) {\n              html = settings.templates.addition( module.add.variables(message.addResult, value) );\n              $addition\n                .html(html)\n                .attr('data-' + metadata.value, value)\n                .attr('data-' + metadata.text, value)\n                .removeClass(className.filtered)\n                .addClass(className.selected)\n              ;\n              module.verbose('Replacing user suggestion with new value', $addition);\n            }\n            else {\n              $addition = module.create.userChoice(value);\n              $addition\n                .prependTo($menu)\n                .addClass(className.selected)\n              ;\n              module.verbose('Adding item choice to menu corresponding with user choice addition', $addition);\n            }\n          },\n          variables: function(message, term) {\n            var\n              hasCount    = (message.search('{count}') !== -1),\n              hasMaxCount = (message.search('{maxCount}') !== -1),\n              hasTerm     = (message.search('{term}') !== -1),\n              values,\n              count,\n              query\n            ;\n            module.verbose('Adding templated variables to message', message);\n            if(hasCount) {\n              count  = module.get.selectionCount();\n              message = message.replace('{count}', count);\n            }\n            if(hasMaxCount) {\n              count  = module.get.selectionCount();\n              message = message.replace('{maxCount}', settings.maxSelections);\n            }\n            if(hasTerm) {\n              query   = term || module.get.query();\n              message = message.replace('{term}', query);\n            }\n            return message;\n          },\n          value: function(addedValue, addedText, $selectedItem) {\n            var\n              currentValue = module.get.values(),\n              newValue\n            ;\n            if(addedValue === '') {\n              module.debug('Cannot select blank values from multiselect');\n              return;\n            }\n            // extend current array\n            if($.isArray(currentValue)) {\n              newValue = currentValue.concat([addedValue]);\n              newValue = module.get.uniqueArray(newValue);\n            }\n            else {\n              newValue = [addedValue];\n            }\n            // add values\n            if( module.has.selectInput() ) {\n              if(module.can.extendSelect()) {\n                module.debug('Adding value to select', addedValue, newValue, $input);\n                module.add.optionValue(addedValue);\n              }\n            }\n            else {\n              newValue = newValue.join(settings.delimiter);\n              module.debug('Setting hidden input to delimited value', newValue, $input);\n            }\n\n            if(settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('Skipping onadd callback on initial load', settings.onAdd);\n            }\n            else {\n              settings.onAdd.call(element, addedValue, addedText, $selectedItem);\n            }\n            module.set.value(newValue, addedValue, addedText, $selectedItem);\n            module.check.maxSelections();\n          }\n        },\n\n        remove: {\n          active: function() {\n            $module.removeClass(className.active);\n          },\n          activeLabel: function() {\n            $module.find(selector.label).removeClass(className.active);\n          },\n          loading: function() {\n            $module.removeClass(className.loading);\n          },\n          initialLoad: function() {\n            initialLoad = false;\n          },\n          upward: function($menu) {\n            var $element = $menu || $module;\n            $element.removeClass(className.upward);\n          },\n          visible: function() {\n            $module.removeClass(className.visible);\n          },\n          activeItem: function() {\n            $item.removeClass(className.active);\n          },\n          filteredItem: function() {\n            if(settings.useLabels && module.has.maxSelections() ) {\n              return;\n            }\n            if(settings.useLabels && module.is.multiple()) {\n              $item.not('.' + className.active).removeClass(className.filtered);\n            }\n            else {\n              $item.removeClass(className.filtered);\n            }\n          },\n          optionValue: function(value) {\n            var\n              $option   = $input.find('option[value=\"' + value + '\"]'),\n              hasOption = ($option.length > 0)\n            ;\n            if(!hasOption || !$option.hasClass(className.addition)) {\n              return;\n            }\n            // temporarily disconnect observer\n            if(selectObserver) {\n              selectObserver.disconnect();\n              module.verbose('Temporarily disconnecting mutation observer', value);\n            }\n            $option.remove();\n            module.verbose('Removing user addition as an <option>', value);\n            if(selectObserver) {\n              selectObserver.observe($input[0], {\n                childList : true,\n                subtree   : true\n              });\n            }\n          },\n          message: function() {\n            $menu.children(selector.message).remove();\n          },\n          searchTerm: function() {\n            module.verbose('Cleared search term');\n            $search.val('');\n            module.set.filtered();\n          },\n          selected: function(value, $selectedItem) {\n            $selectedItem = (settings.allowAdditions)\n              ? $selectedItem || module.get.itemWithAdditions(value)\n              : $selectedItem || module.get.item(value)\n            ;\n\n            if(!$selectedItem) {\n              return false;\n            }\n\n            $selectedItem\n              .each(function() {\n                var\n                  $selected     = $(this),\n                  selectedText  = module.get.choiceText($selected),\n                  selectedValue = module.get.choiceValue($selected, selectedText)\n                ;\n                if(module.is.multiple()) {\n                  if(settings.useLabels) {\n                    module.remove.value(selectedValue, selectedText, $selected);\n                    module.remove.label(selectedValue);\n                  }\n                  else {\n                    module.remove.value(selectedValue, selectedText, $selected);\n                    if(module.get.selectionCount() === 0) {\n                      module.set.placeholderText();\n                    }\n                    else {\n                      module.set.text(module.add.variables(message.count));\n                    }\n                  }\n                }\n                else {\n                  module.remove.value(selectedValue, selectedText, $selected);\n                }\n                $selected\n                  .removeClass(className.filtered)\n                  .removeClass(className.active)\n                ;\n                if(settings.useLabels) {\n                  $selected.removeClass(className.selected);\n                }\n              })\n            ;\n          },\n          selectedItem: function() {\n            $item.removeClass(className.selected);\n          },\n          value: function(removedValue, removedText, $removedItem) {\n            var\n              values = module.get.values(),\n              newValue\n            ;\n            if( module.has.selectInput() ) {\n              module.verbose('Input is <select> removing selected option', removedValue);\n              newValue = module.remove.arrayValue(removedValue, values);\n              module.remove.optionValue(removedValue);\n            }\n            else {\n              module.verbose('Removing from delimited values', removedValue);\n              newValue = module.remove.arrayValue(removedValue, values);\n              newValue = newValue.join(settings.delimiter);\n            }\n            if(settings.fireOnInit === false && module.is.initialLoad()) {\n              module.verbose('No callback on initial load', settings.onRemove);\n            }\n            else {\n              settings.onRemove.call(element, removedValue, removedText, $removedItem);\n            }\n            module.set.value(newValue, removedText, $removedItem);\n            module.check.maxSelections();\n          },\n          arrayValue: function(removedValue, values) {\n            if( !$.isArray(values) ) {\n              values = [values];\n            }\n            values = $.grep(values, function(value){\n              return (removedValue != value);\n            });\n            module.verbose('Removed value from delimited string', removedValue, values);\n            return values;\n          },\n          label: function(value, shouldAnimate) {\n            var\n              $labels       = $module.find(selector.label),\n              $removedLabel = $labels.filter('[data-value=\"' + value +'\"]')\n            ;\n            module.verbose('Removing label', $removedLabel);\n            $removedLabel.remove();\n          },\n          activeLabels: function($activeLabels) {\n            $activeLabels = $activeLabels || $module.find(selector.label).filter('.' + className.active);\n            module.verbose('Removing active label selections', $activeLabels);\n            module.remove.labels($activeLabels);\n          },\n          labels: function($labels) {\n            $labels = $labels || $module.find(selector.label);\n            module.verbose('Removing labels', $labels);\n            $labels\n              .each(function(){\n                var\n                  $label      = $(this),\n                  value       = $label.data(metadata.value),\n                  stringValue = (value !== undefined)\n                    ? String(value)\n                    : value,\n                  isUserValue = module.is.userValue(stringValue)\n                ;\n                if(settings.onLabelRemove.call($label, value) === false) {\n                  module.debug('Label remove callback cancelled removal');\n                  return;\n                }\n                if(isUserValue) {\n                  module.remove.value(stringValue);\n                  module.remove.label(stringValue);\n                }\n                else {\n                  // selected will also remove label\n                  module.remove.selected(stringValue);\n                }\n              })\n            ;\n          },\n          tabbable: function() {\n            if( module.has.search() ) {\n              module.debug('Searchable dropdown initialized');\n              $search\n                .removeAttr('tabindex')\n              ;\n              $menu\n                .removeAttr('tabindex')\n              ;\n            }\n            else {\n              module.debug('Simple selection dropdown initialized');\n              $module\n                .removeAttr('tabindex')\n              ;\n              $menu\n                .removeAttr('tabindex')\n              ;\n            }\n          }\n        },\n\n        has: {\n          search: function() {\n            return ($search.length > 0);\n          },\n          selectInput: function() {\n            return ( $input.is('select') );\n          },\n          firstLetter: function($item, letter) {\n            var\n              text,\n              firstLetter\n            ;\n            if(!$item || $item.length === 0 || typeof letter !== 'string') {\n              return false;\n            }\n            text        = module.get.choiceText($item, false);\n            letter      = letter.toLowerCase();\n            firstLetter = String(text).charAt(0).toLowerCase();\n            return (letter == firstLetter);\n          },\n          input: function() {\n            return ($input.length > 0);\n          },\n          items: function() {\n            return ($item.length > 0);\n          },\n          menu: function() {\n            return ($menu.length > 0);\n          },\n          message: function() {\n            return ($menu.children(selector.message).length !== 0);\n          },\n          label: function(value) {\n            var\n              $labels = $module.find(selector.label)\n            ;\n            return ($labels.filter('[data-value=\"' + value +'\"]').length > 0);\n          },\n          maxSelections: function() {\n            return (settings.maxSelections && module.get.selectionCount() >= settings.maxSelections);\n          },\n          allResultsFiltered: function() {\n            return ($item.filter(selector.unselectable).length === $item.length);\n          },\n          query: function() {\n            return (module.get.query() !== '');\n          },\n          value: function(value) {\n            var\n              values   = module.get.values(),\n              hasValue = $.isArray(values)\n               ? values && ($.inArray(value, values) !== -1)\n               : (values == value)\n            ;\n            return (hasValue)\n              ? true\n              : false\n            ;\n          }\n        },\n\n        is: {\n          active: function() {\n            return $module.hasClass(className.active);\n          },\n          alreadySetup: function() {\n            return ($module.is('select') && $module.parent(selector.dropdown).length > 0  && $module.prev().length === 0);\n          },\n          animating: function($subMenu) {\n            return ($subMenu)\n              ? $subMenu.transition && $subMenu.transition('is animating')\n              : $menu.transition    && $menu.transition('is animating')\n            ;\n          },\n          disabled: function() {\n            return $module.hasClass(className.disabled);\n          },\n          focused: function() {\n            return (document.activeElement === $module[0]);\n          },\n          focusedOnSearch: function() {\n            return (document.activeElement === $search[0]);\n          },\n          allFiltered: function() {\n            return( (module.is.multiple() || module.has.search()) && !module.has.message() && module.has.allResultsFiltered() );\n          },\n          hidden: function($subMenu) {\n            return !module.is.visible($subMenu);\n          },\n          initialLoad: function() {\n            return initialLoad;\n          },\n          onScreen: function($subMenu) {\n            var\n              $currentMenu   = $subMenu || $menu,\n              canOpenDownward = true,\n              onScreen = {},\n              calculations\n            ;\n            $currentMenu.addClass(className.loading);\n            calculations = {\n              context: {\n                scrollTop : $context.scrollTop(),\n                height    : $context.outerHeight()\n              },\n              menu : {\n                offset: $currentMenu.offset(),\n                height: $currentMenu.outerHeight()\n              }\n            };\n            onScreen = {\n              above : (calculations.context.scrollTop) <= calculations.menu.offset.top - calculations.menu.height,\n              below : (calculations.context.scrollTop + calculations.context.height) >= calculations.menu.offset.top + calculations.menu.height\n            };\n            if(onScreen.below) {\n              module.verbose('Dropdown can fit in context downward', onScreen);\n              canOpenDownward = true;\n            }\n            else if(!onScreen.below && !onScreen.above) {\n              module.verbose('Dropdown cannot fit in either direction, favoring downward', onScreen);\n              canOpenDownward = true;\n            }\n            else {\n              module.verbose('Dropdown cannot fit below, opening upward', onScreen);\n              canOpenDownward = false;\n            }\n            $currentMenu.removeClass(className.loading);\n            return canOpenDownward;\n          },\n          inObject: function(needle, object) {\n            var\n              found = false\n            ;\n            $.each(object, function(index, property) {\n              if(property == needle) {\n                found = true;\n                return true;\n              }\n            });\n            return found;\n          },\n          multiple: function() {\n            return $module.hasClass(className.multiple);\n          },\n          single: function() {\n            return !module.is.multiple();\n          },\n          selectMutation: function(mutations) {\n            var\n              selectChanged = false\n            ;\n            $.each(mutations, function(index, mutation) {\n              if(mutation.target && $(mutation.target).is('select')) {\n                selectChanged = true;\n                return true;\n              }\n            });\n            return selectChanged;\n          },\n          search: function() {\n            return $module.hasClass(className.search);\n          },\n          searchSelection: function() {\n            return ( module.has.search() && $search.parent(selector.dropdown).length === 1 );\n          },\n          selection: function() {\n            return $module.hasClass(className.selection);\n          },\n          userValue: function(value) {\n            return ($.inArray(value, module.get.userValues()) !== -1);\n          },\n          upward: function($menu) {\n            var $element = $menu || $module;\n            return $element.hasClass(className.upward);\n          },\n          visible: function($subMenu) {\n            return ($subMenu)\n              ? $subMenu.hasClass(className.visible)\n              : $menu.hasClass(className.visible)\n            ;\n          }\n        },\n\n        can: {\n          activate: function($item) {\n            if(settings.useLabels) {\n              return true;\n            }\n            if(!module.has.maxSelections()) {\n              return true;\n            }\n            if(module.has.maxSelections() && $item.hasClass(className.active)) {\n              return true;\n            }\n            return false;\n          },\n          click: function() {\n            return (hasTouch || settings.on == 'click');\n          },\n          extendSelect: function() {\n            return settings.allowAdditions || settings.apiSettings;\n          },\n          show: function() {\n            return !module.is.disabled() && (module.has.items() || module.has.message());\n          },\n          useAPI: function() {\n            return $.fn.api !== undefined;\n          }\n        },\n\n        animate: {\n          show: function(callback, $subMenu) {\n            var\n              $currentMenu = $subMenu || $menu,\n              start = ($subMenu)\n                ? function() {}\n                : function() {\n                  module.hideSubMenus();\n                  module.hideOthers();\n                  module.set.active();\n                },\n              transition\n            ;\n            callback = $.isFunction(callback)\n              ? callback\n              : function(){}\n            ;\n            module.verbose('Doing menu show animation', $currentMenu);\n            module.set.direction($subMenu);\n            transition = module.get.transition($subMenu);\n            if( module.is.selection() ) {\n              module.set.scrollPosition(module.get.selectedItem(), true);\n            }\n            if( module.is.hidden($currentMenu) || module.is.animating($currentMenu) ) {\n              if(transition == 'none') {\n                start();\n                $currentMenu.transition('show');\n                callback.call(element);\n              }\n              else if($.fn.transition !== undefined && $module.transition('is supported')) {\n                $currentMenu\n                  .transition({\n                    animation  : transition + ' in',\n                    debug      : settings.debug,\n                    verbose    : settings.verbose,\n                    duration   : settings.duration,\n                    queue      : true,\n                    onStart    : start,\n                    onComplete : function() {\n                      callback.call(element);\n                    }\n                  })\n                ;\n              }\n              else {\n                module.error(error.noTransition, transition);\n              }\n            }\n          },\n          hide: function(callback, $subMenu) {\n            var\n              $currentMenu = $subMenu || $menu,\n              duration = ($subMenu)\n                ? (settings.duration * 0.9)\n                : settings.duration,\n              start = ($subMenu)\n                ? function() {}\n                : function() {\n                  if( module.can.click() ) {\n                    module.unbind.intent();\n                  }\n                  module.remove.active();\n                },\n              transition = module.get.transition($subMenu)\n            ;\n            callback = $.isFunction(callback)\n              ? callback\n              : function(){}\n            ;\n            if( module.is.visible($currentMenu) || module.is.animating($currentMenu) ) {\n              module.verbose('Doing menu hide animation', $currentMenu);\n\n              if(transition == 'none') {\n                start();\n                $currentMenu.transition('hide');\n                callback.call(element);\n              }\n              else if($.fn.transition !== undefined && $module.transition('is supported')) {\n                $currentMenu\n                  .transition({\n                    animation  : transition + ' out',\n                    duration   : settings.duration,\n                    debug      : settings.debug,\n                    verbose    : settings.verbose,\n                    queue      : true,\n                    onStart    : start,\n                    onComplete : function() {\n                      if(settings.direction == 'auto') {\n                        module.remove.upward($subMenu);\n                      }\n                      callback.call(element);\n                    }\n                  })\n                ;\n              }\n              else {\n                module.error(error.transition);\n              }\n            }\n          }\n        },\n\n        hideAndClear: function() {\n          module.remove.searchTerm();\n          if( module.has.maxSelections() ) {\n            return;\n          }\n          if(module.has.search()) {\n            module.hide(function() {\n              module.remove.filteredItem();\n            });\n          }\n          else {\n            module.hide();\n          }\n        },\n\n        delay: {\n          show: function() {\n            module.verbose('Delaying show event to ensure user intent');\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.show, settings.delay.show);\n          },\n          hide: function() {\n            module.verbose('Delaying hide event to ensure user intent');\n            clearTimeout(module.timer);\n            module.timer = setTimeout(module.hide, settings.delay.hide);\n          }\n        },\n\n        escape: {\n          regExp: function(text) {\n            text =  String(text);\n            return text.replace(regExp.escape, '\\\\$&');\n          }\n        },\n\n        setting: function(name, value) {\n          module.debug('Changing setting', name, value);\n          if( $.isPlainObject(name) ) {\n            $.extend(true, settings, name);\n          }\n          else if(value !== undefined) {\n            settings[name] = value;\n          }\n          else {\n            return settings[name];\n          }\n        },\n        internal: function(name, value) {\n          if( $.isPlainObject(name) ) {\n            $.extend(true, module, name);\n          }\n          else if(value !== undefined) {\n            module[name] = value;\n          }\n          else {\n            return module[name];\n          }\n        },\n        debug: function() {\n          if(settings.debug) {\n            if(settings.performance) {\n              module.performance.log(arguments);\n            }\n            else {\n              module.debug = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.debug.apply(console, arguments);\n            }\n          }\n        },\n        verbose: function() {\n          if(settings.verbose && settings.debug) {\n            if(settings.performance) {\n              module.performance.log(arguments);\n            }\n            else {\n              module.verbose = Function.prototype.bind.call(console.info, console, settings.name + ':');\n              module.verbose.apply(console, arguments);\n            }\n          }\n        },\n        error: function() {\n          module.error = Function.prototype.bind.call(console.error, console, settings.name + ':');\n          module.error.apply(console, arguments);\n        },\n        performance: {\n          log: function(message) {\n            var\n              currentTime,\n              executionTime,\n              previousTime\n            ;\n            if(settings.performance) {\n              currentTime   = new Date().getTime();\n              previousTime  = time || currentTime;\n              executionTime = currentTime - previousTime;\n              time          = currentTime;\n              performance.push({\n                'Name'           : message[0],\n                'Arguments'      : [].slice.call(message, 1) || '',\n                'Element'        : element,\n                'Execution Time' : executionTime\n              });\n            }\n            clearTimeout(module.performance.timer);\n            module.performance.timer = setTimeout(module.performance.display, 500);\n          },\n          display: function() {\n            var\n              title = settings.name + ':',\n              totalTime = 0\n            ;\n            time = false;\n            clearTimeout(module.performance.timer);\n            $.each(performance, function(index, data) {\n              totalTime += data['Execution Time'];\n            });\n            title += ' ' + totalTime + 'ms';\n            if(moduleSelector) {\n              title += ' \\'' + moduleSelector + '\\'';\n            }\n            if( (console.group !== undefined || console.table !== undefined) && performance.length > 0) {\n              console.groupCollapsed(title);\n              if(console.table) {\n                console.table(performance);\n              }\n              else {\n                $.each(performance, function(index, data) {\n                  console.log(data['Name'] + ': ' + data['Execution Time']+'ms');\n                });\n              }\n              console.groupEnd();\n            }\n            performance = [];\n          }\n        },\n        invoke: function(query, passedArguments, context) {\n          var\n            object = instance,\n            maxDepth,\n            found,\n            response\n          ;\n          passedArguments = passedArguments || queryArguments;\n          context         = element         || context;\n          if(typeof query == 'string' && object !== undefined) {\n            query    = query.split(/[\\. ]/);\n            maxDepth = query.length - 1;\n            $.each(query, function(depth, value) {\n              var camelCaseValue = (depth != maxDepth)\n                ? value + query[depth + 1].charAt(0).toUpperCase() + query[depth + 1].slice(1)\n                : query\n              ;\n              if( $.isPlainObject( object[camelCaseValue] ) && (depth != maxDepth) ) {\n                object = object[camelCaseValue];\n              }\n              else if( object[camelCaseValue] !== undefined ) {\n                found = object[camelCaseValue];\n                return false;\n              }\n              else if( $.isPlainObject( object[value] ) && (depth != maxDepth) ) {\n                object = object[value];\n              }\n              else if( object[value] !== undefined ) {\n                found = object[value];\n                return false;\n              }\n              else {\n                module.error(error.method, query);\n                return false;\n              }\n            });\n          }\n          if ( $.isFunction( found ) ) {\n            response = found.apply(context, passedArguments);\n          }\n          else if(found !== undefined) {\n            response = found;\n          }\n          if($.isArray(returnedValue)) {\n            returnedValue.push(response);\n          }\n          else if(returnedValue !== undefined) {\n            returnedValue = [returnedValue, response];\n          }\n          else if(response !== undefined) {\n            returnedValue = response;\n          }\n          return found;\n        }\n      };\n\n      if(methodInvoked) {\n        if(instance === undefined) {\n          module.initialize();\n        }\n        module.invoke(query);\n      }\n      else {\n        if(instance !== undefined) {\n          instance.invoke('destroy');\n        }\n        module.initialize();\n      }\n    })\n  ;\n  return (returnedValue !== undefined)\n    ? returnedValue\n    : $allModules\n  ;\n};\n\n$.fn.dropdown.settings = {\n\n  debug                  : false,\n  verbose                : false,\n  performance            : true,\n\n  on                     : 'click',    // what event should show menu action on item selection\n  action                 : 'activate', // action on item selection (nothing, activate, select, combo, hide, function(){})\n\n\n  apiSettings            : false,\n  saveRemoteData         : true,      // Whether remote name/value pairs should be stored in sessionStorage to allow remote data to be restored on page refresh\n  throttle               : 200,       // How long to wait after last user input to search remotely\n\n  context                : window,      // Context to use when determining if on screen\n  direction              : 'auto',     // Whether dropdown should always open in one direction\n  keepOnScreen           : true,       // Whether dropdown should check whether it is on screen before showing\n\n  match                  : 'both',     // what to match against with search selection (both, text, or label)\n  fullTextSearch         : false,      // search anywhere in value\n\n  placeholder            : 'auto',     // whether to convert blank <select> values to placeholder text\n  preserveHTML           : true,       // preserve html when selecting value\n  sortSelect             : false,      // sort selection on init\n\n  forceSelection         : true,       // force a choice on blur with search selection\n  allowAdditions         : false,      // whether multiple select should allow user added values\n\n  maxSelections          : false,      // When set to a number limits the number of selections to this count\n  useLabels              : true,       // whether multiple select should filter currently active selections from choices\n  delimiter              : ',',        // when multiselect uses normal <input> the values will be delimited with this character\n\n  showOnFocus            : true,       // show menu on focus\n  allowTab               : true,       // add tabindex to element\n  allowCategorySelection : false,      // allow elements with sub-menus to be selected\n\n  fireOnInit             : false,      // Whether callbacks should fire when initializing dropdown values\n\n  transition             : 'auto',     // auto transition will slide down or up based on direction\n  duration               : 200,        // duration of transition\n\n  glyphWidth             : 1.0714,     // widest glyph width in em (W is 1.0714 em) used to calculate multiselect input width\n\n  // label settings on multi-select\n  label: {\n    transition : 'scale',\n    duration   : 200,\n    variation  : false\n  },\n\n  // delay before event\n  delay : {\n    hide   : 300,\n    show   : 200,\n    search : 20,\n    touch  : 50\n  },\n\n  /* Callbacks */\n  onChange      : function(value, text, $selected){},\n  onAdd         : function(value, text, $selected){},\n  onRemove      : function(value, text, $selected){},\n\n  onLabelSelect : function($selectedLabels){},\n  onLabelCreate : function(value, text) { return $(this); },\n  onLabelRemove : function(value) { return true; },\n  onNoResults   : function(searchTerm) { return true; },\n  onShow        : function(){},\n  onHide        : function(){},\n\n  /* Component */\n  name           : 'Dropdown',\n  namespace      : 'dropdown',\n\n  message: {\n    addResult     : 'Add <b>{term}</b>',\n    count         : '{count} selected',\n    maxSelections : 'Max {maxCount} selections',\n    noResults     : 'No results found.',\n    serverError   : 'There was an error contacting the server'\n  },\n\n  error : {\n    action          : 'You called a dropdown action that was not defined',\n    alreadySetup    : 'Once a select has been initialized behaviors must be called on the created ui dropdown',\n    labels          : 'Allowing user additions currently requires the use of labels.',\n    missingMultiple : '<select> requires multiple property to be set to correctly preserve multiple values',\n    method          : 'The method you called is not defined.',\n    noAPI           : 'The API module is required to load resources remotely',\n    noStorage       : 'Saving remote data requires session storage',\n    noTransition    : 'This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>'\n  },\n\n  regExp : {\n    escape   : /[-[\\]{}()*+?.,\\\\^$|#\\s]/g,\n  },\n\n  metadata : {\n    defaultText     : 'defaultText',\n    defaultValue    : 'defaultValue',\n    placeholderText : 'placeholder',\n    text            : 'text',\n    value           : 'value'\n  },\n\n  // property names for remote query\n  fields: {\n    remoteValues : 'results', // grouping for api results\n    values       : 'values', // grouping for all dropdown values\n    name         : 'name',   // displayed dropdown text\n    value        : 'value'   // actual dropdown value\n  },\n\n  keys : {\n    backspace  : 8,\n    delimiter  : 188, // comma\n    deleteKey  : 46,\n    enter      : 13,\n    escape     : 27,\n    pageUp     : 33,\n    pageDown   : 34,\n    leftArrow  : 37,\n    upArrow    : 38,\n    rightArrow : 39,\n    downArrow  : 40\n  },\n\n  selector : {\n    addition     : '.addition',\n    dropdown     : '.ui.dropdown',\n    icon         : '> .dropdown.icon',\n    input        : '> input[type=\"hidden\"], > select',\n    item         : '.item',\n    label        : '> .label',\n    remove       : '> .label > .delete.icon',\n    siblingLabel : '.label',\n    menu         : '.menu',\n    message      : '.message',\n    menuIcon     : '.dropdown.icon',\n    search       : 'input.search, .menu > .search > input',\n    text         : '> .text:not(.icon)',\n    unselectable : '.disabled, .filtered'\n  },\n\n  className : {\n    active      : 'active',\n    addition    : 'addition',\n    animating   : 'animating',\n    disabled    : 'disabled',\n    dropdown    : 'ui dropdown',\n    filtered    : 'filtered',\n    hidden      : 'hidden transition',\n    item        : 'item',\n    label       : 'ui label',\n    loading     : 'loading',\n    menu        : 'menu',\n    message     : 'message',\n    multiple    : 'multiple',\n    placeholder : 'default',\n    search      : 'search',\n    selected    : 'selected',\n    selection   : 'selection',\n    upward      : 'upward',\n    visible     : 'visible'\n  }\n\n};\n\n/* Templates */\n$.fn.dropdown.settings.templates = {\n\n  // generates dropdown from select values\n  dropdown: function(select) {\n    var\n      placeholder = select.placeholder || false,\n      values      = select.values || {},\n      html        = ''\n    ;\n    html +=  '<i class=\"dropdown icon\"></i>';\n    if(select.placeholder) {\n      html += '<div class=\"default text\">' + placeholder + '</div>';\n    }\n    else {\n      html += '<div class=\"text\"></div>';\n    }\n    html += '<div class=\"menu\">';\n    $.each(select.values, function(index, option) {\n      html += (option.disabled)\n        ? '<div class=\"disabled item\" data-value=\"' + option.value + '\">' + option.name + '</div>'\n        : '<div class=\"item\" data-value=\"' + option.value + '\">' + option.name + '</div>'\n      ;\n    });\n    html += '</div>';\n    return html;\n  },\n\n  // generates just menu from select\n  menu: function(response, fields) {\n    var\n      values = response[fields.values] || {},\n      html   = ''\n    ;\n    $.each(values, function(index, option) {\n      html += '<div class=\"item\" data-value=\"' + option[fields.value] + '\">' + option[fields.name] + '</div>';\n    });\n    return html;\n  },\n\n  // generates label for multiselect\n  label: function(value, text) {\n    return text + '<i class=\"delete icon\"></i>';\n  },\n\n\n  // generates messages like \"No results\"\n  message: function(message) {\n    return message;\n  },\n\n  // generates user addition to selection menu\n  addition: function(choice) {\n    return choice;\n  }\n\n};\n\n})( jQuery, window, document );\n"]},"sourceType":"script","hash":"8d86f262a6b084d3969a751decbd2b9056739599"}
