{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/ui/router.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"imports/ui/router.js","filename":"imports/ui/router.js","sourceMaps":true,"passPerPreset":false,"envName":"development","cwd":"/home/martijn/Documents/GitHub/QRSMeteor","root":"/home/martijn/Documents/GitHub/QRSMeteor","generatorOpts":{"filename":"imports/ui/router.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/ui/router.js"}},"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar initQlikSense, getAllSlides;\nmodule.watch(require(\"/imports/ui/useCases/useCaseSelection.js\"), {\n  initQlikSense: function (v) {\n    initQlikSense = v;\n  },\n  getAllSlides: function (v) {\n    getAllSlides = v;\n  }\n}, 0);\nvar nav;\nmodule.watch(require(\"/imports/ui/nav.js\"), {\n  \"*\": function (v) {\n    nav = v;\n  }\n}, 1);\n\nvar Cookies = require('js-cookie');\n\n//Layout Configuration. http://stackoverflow.com/questions/28864942/meteor-use-2-different-layouts-ironrouter\nRouter.configure({\n  layoutTemplate: 'containerlayout',\n  notFoundTemplate: 'notFound'\n});\nRouter.route('/slides', {\n  template: 'slides',\n  layoutTemplate: 'emptyLayout'\n});\nRouter.route('/', function () {\n  function _callee() {\n    var selection;\n    return _regenerator.default.async(function () {\n      function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              selection = this.params.query.selection;\n\n              if (!selection) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 4;\n              return _regenerator.default.awrap(initQlikSense());\n\n            case 4:\n              _context.next = 6;\n              return _regenerator.default.awrap(nav.selectViaQueryId(selection));\n\n            case 6:\n              _context.next = 8;\n              return _regenerator.default.awrap(getAllSlides(false));\n\n            case 8:\n              // after we got all data in an array from sense, change the router/browser to the slides page\n              Router.go(\"slides\");\n              _context.next = 12;\n              break;\n\n            case 11:\n              Router.go('useCaseSelection');\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }\n\n      return _callee$;\n    }(), null, this);\n  }\n\n  return _callee;\n}());\nRouter.route('/useCaseSelection', function () {\n  function _callee2() {\n    var selection;\n    return _regenerator.default.async(function () {\n      function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              selection = this.params.query.selection;\n\n              if (!selection) {\n                _context2.next = 11;\n                break;\n              }\n\n              _context2.next = 4;\n              return _regenerator.default.awrap(initQlikSense());\n\n            case 4:\n              _context2.next = 6;\n              return _regenerator.default.awrap(nav.selectViaQueryId(selection));\n\n            case 6:\n              _context2.next = 8;\n              return _regenerator.default.awrap(getAllSlides(false));\n\n            case 8:\n              // after we got all data in an array from sense, change the router/browser to the slides page\n              Router.go(\"slides\");\n              _context2.next = 13;\n              break;\n\n            case 11:\n              this.layout('containerlayout');\n              this.render('useCaseSelection');\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }\n\n      return _callee2$;\n    }(), null, this);\n  }\n\n  return _callee2;\n}()); //GENERATION\n\nRouter.route('/generation');\nRouter.route('/generation_embedded', {\n  template: 'generation',\n  layoutTemplate: 'emptyContainerLayout'\n});\nRouter.route('/users', {\n  template: 'users',\n  layoutTemplate: 'emptyContainerLayout'\n}); //SELF SERVICE\n\nRouter.route('/selfService', function () {\n  this.layout('SSBILayout');\n  this.render('nav', {\n    to: 'nav'\n  });\n  this.render('SSBIUsers', {\n    to: 'aside'\n  }); // this.render('SSBIFooter', { to: 'footer' });\n\n  this.render('SSBISenseApp');\n});\nRouter.route('/selfService_embedded', function () {\n  this.layout('SSBILayout');\n  this.render('SSBIUsers', {\n    to: 'aside'\n  });\n  this.render('SSBISenseApp');\n}); //API\n\nRouter.route('/APILogs');\nRouter.route('/API_embedded', {\n  template: 'APILogs',\n  layoutTemplate: 'SSOLayout'\n});\nRouter.route('/ApiLogsTable');\nRouter.route('/ApiLogsTable_embedded', {\n  template: 'ApiLogsTable',\n  layoutTemplate: 'SSOLayout'\n}); //SECURITY\n\nRouter.route('/introductionSecurity');\nRouter.route('/security_embedded', {\n  template: 'introductionSecurity',\n  layoutTemplate: 'SSOLayout'\n}); //WEB\n\nRouter.route('/webIntegration');\nRouter.route('/webIntegration_embedded', {\n  template: 'webIntegration',\n  layoutTemplate: 'SSOLayout'\n}); //ARCHITECTURE\n\nRouter.route('/architecture');\nRouter.route('/architecture_embedded', {\n  template: 'architecture',\n  layoutTemplate: 'SSOLayout'\n}); //generic overview\n\nRouter.route('/generic_links_embedded', {\n  template: 'genericDocumentation',\n  layoutTemplate: 'SSOLayout'\n});\nRouter.route('/sequenceDiagramOverview');\nRouter.route('/sequenceDiagramGeneration');\nRouter.route('/legal');\nRouter.route('/notFound');\nRouter.route('/userOverview');\nRouter.route('/homeAbout');\nRouter.route('/introduction');\nRouter.route('/SecurityDeepDive'); //VIDEO OVERVIEW\n\nRouter.route('/videoOverview', {\n  template: 'videoOverview',\n  layoutTemplate: 'containerlayout'\n});\nRouter.route('/videoOverview_embedded', {\n  template: 'videoOverview',\n  layoutTemplate: 'SSOLayout'\n});\nRouter.route('/documentation', {\n  template: 'documentation',\n  layoutTemplate: 'containerlayout'\n});\nRouter.route('/templateOverview', {\n  template: 'templateOverview',\n  layoutTemplate: 'SSOLayout'\n});\nRouter.route('/securityRules', {\n  template: 'securityRules',\n  layoutTemplate: 'SSOLayout'\n});\nRouter.route('/QMC', {\n  template: 'QMC',\n  layoutTemplate: 'SSOLayout'\n}); // Single sing on integration route, this is the route you configure in Qlik sense proxy\n\nRouter.route('/SSO', {\n  template: 'SSO',\n  layoutTemplate: 'SSOLayout'\n}); //users for the slide generator have their own virtual proxy redirect path\n\nRouter.route('/presentationsso', {\n  template: 'SSO',\n  layoutTemplate: 'SSOLayout'\n}); //SLIDE GENERATOR LANDING PAGES\n\nRouter.route('/presentation', {\n  template: 'landingPage',\n  layoutTemplate: 'presentationLayout'\n});\nRouter.route('/integration', {\n  template: 'landingPage',\n  layoutTemplate: 'presentationLayout'\n}); // //START THE SLIDE SHOW\n// Router.route('/slideGenerator', {\n//     template: 'slidegeneratorSlidesMain',\n//     layoutTemplate: 'presentationLayout'\n// });\n//redirect users from saasdemo.qlik.com to integration.qlik.com\n\nif (window.location.href.indexOf(\"saasdemo\") > -1) {\n  // var newURL = 'http://'+window.location.protocol + \"//\" + window.location.host + \"/\" + window.location.pathname;\n  window.location = \"http://integration.qlik.com\" + window.location.pathname;\n} //disabled to ensure we only use anonymous users via https://github.com/artwells/meteor-accounts-guest/\n// // Load a authentication check handler, depending on which domain it runs.\n// if (window.location.href.indexOf(\"qlik.com\") > -1) {\n//     Router.onBeforeAction(mustBeSignedInQlik, { except: [undefined, 'documentation'] });\n//     // Router.onBeforeAction(mustBeSignedInQlik, { only: ['test'] });\n//     // Router.onBeforeAction(mustBeSignedIn, { except: [undefined, 'documentation'] });\n//     //     //make sure certain path are for authenticated users only if the demo runs outside of Qlik.com\n//     // Router.plugin('ensureSignedIn', {\n//     //     // only: ['generation', 'users', 'SSO', 'useCaseSelection', 'integration', 'selfService', 'slides', 'presentation']\n//     //     except: [undefined, 'test', 'useCaseSelection', 'documentation', 'atSignIn', 'atSignUp', 'atForgotPassword']\n//     // });\n// } else { //localhost dev environment\n//     Router.onBeforeAction(mustBeSignedInDEV, { except: [undefined, 'documentation'] });\n// }\n\n\nfunction mustBeSignedInDEV() {\n  var user = {\n    // email: \"mbj2@test.com\",\n    email: \"mbj2@qlik.com\",\n    \"profile\": {\n      \"name\": {\n        \"first\": \"Martijn\",\n        \"last\": \"Biesbroek\"\n      }\n    },\n    roles: [\"Base\"],\n    // Array.from(\"Base,Employee,CPEFEmployee\"),\n    password: \"test\"\n  };\n  addRolesBasedonEmail(user); // \"Logout\"-Hook: Manual implementation, wait a bit to prevent multiple page loads, because the database needs to be update\n\n  Tracker.autorun(function () {\n    console.log('------------------------------------');\n    console.log('tracker: login status changed...', Meteor.userId());\n    console.log('------------------------------------');\n\n    if (!Meteor.userId()) {\n      Meteor.setTimeout(loginDEV.bind(null, user), 3000);\n    }\n  });\n  this.next();\n}\n\n;\n\nfunction loginDEV(user) {\n  if (!Meteor.userId()) {\n    //if not yet logged in into Meteor, create a new meteor account, or log him via a token.\n    console.log('user is not yet logged in into meteor', user);\n    Meteor.call('resetPasswordOrCreateUser', user, function (err, res) {\n      if (err) {\n        sAlert.error(err.message);\n        console.error(err);\n      } else {\n        console.log('------------------------------------');\n        console.log('password reset..');\n        console.log('------------------------------------');\n        Meteor.loginWithPassword(user.email, user.password, function (err, res) {\n          //\n          if (err) {\n            sAlert.error(err.message);\n            console.error(err);\n          } else {\n            sAlert.success('You are now logged in with your Qlik.com account. You now have your \"private demo environment\". So feel free to create/change/delete anything you would like...');\n            console.log('user successfully logged in', Meteor.userId());\n          }\n        });\n      }\n    });\n  }\n}\n\nfunction mustBeSignedInQlik() {\n  // \"Logout\"-Hook: Manual implementation, wait a bit to prevent multiple page loads, because the database needs to be update\n  Logger.autorun(function () {\n    if (!Meteor.userId()) {\n      Meteor.setTimeout(loginQlik, 0); //give the browser some time to log the user in...\n    }\n  });\n  this.next();\n}\n\n; //THE CODE BELOW IS JUST TO SIMULATE A SSO IF YOU ALREADY LOGGED IN INTO QLIK.COM. THIS CODE IS UNSECURE AND CAN'T BE USED FOR REAL PRODUCTION ENVIRONMENTS.... WE SET THE GROUPS ON THE CLIENT SIDE ETC. THIS IS UNSECURE. BUT FINE FOR THIS DEMO TOOL.\n\nfunction loginQlik() {\n  //rerun this function anytime something happens with the login state\n  var routeName = Router.current().route.getName();\n  console.log('mustBeSignedIn via Qlik.com for route: ', routeName);\n  var QlikUserProfile = Cookies.get('CSUser'); //only availalbe on Qlik.com domains\n\n  var loggedInUser = Meteor.userId();\n  console.log('QlikUserProfile: ', QlikUserProfile);\n\n  if (!QlikUserProfile) {\n    //if user is not logged in, redirect to Qliks login page, after it we can read the cookie.\n    var uri = Meteor.absoluteUrl() + routeName;\n    console.log('The user tried to open: ' + uri);\n    var encodedReturnURI = encodeURIComponent(uri);\n    var QlikSSO = \"https://login.qlik.com/login.aspx?returnURL=\" + encodedReturnURI;\n    console.log('User has no Qlik.com cookie, so send him to: ', QlikSSO);\n    window.location.replace(QlikSSO);\n  } else if (!loggedInUser) {\n    //if not yet logged in into Meteor, create a new meteor account, or log him via a token.\n    console.log('user is not yet logged in into meteor'); // QlikUserProfile:  username=bieshosetest&firstName=test&lastName=test&emailAddress=bieshose@gmail.com&contactID=&accountID=&ulcLevels=Base&country=Angola&hash=xS9zTEOE7vSgTVXycUr99UFLc78=\n\n    var _QlikUserProfile$spli = QlikUserProfile.split('&'),\n        _QlikUserProfile$spli2 = (0, _slicedToArray2.default)(_QlikUserProfile$spli, 9),\n        username = _QlikUserProfile$spli2[0],\n        firstName = _QlikUserProfile$spli2[1],\n        lastName = _QlikUserProfile$spli2[2],\n        emailAddress = _QlikUserProfile$spli2[3],\n        contactID = _QlikUserProfile$spli2[4],\n        accountID = _QlikUserProfile$spli2[5],\n        ulcLevels = _QlikUserProfile$spli2[6],\n        country = _QlikUserProfile$spli2[7],\n        hash = _QlikUserProfile$spli2[8];\n\n    var user = {\n      email: emailAddress.substr(emailAddress.indexOf(\"=\") + 1),\n      profile: {\n        name: {\n          first: firstName.substr(firstName.indexOf(\"=\") + 1),\n          last: lastName.substr(lastName.indexOf(\"=\") + 1),\n          contactID: contactID ? contactID.substr(contactID.indexOf(\"=\") + 1) : '',\n          accountID: accountID ? accountID.substr(accountID.indexOf(\"=\") + 1) : ''\n        }\n      },\n      roles: '',\n      //JSON.parse(\"[\" + ulcLevels.substr(ulcLevels.indexOf(\"=\") + 1) + \"]\"),\n      password: emailAddress.substr(emailAddress.indexOf(\"=\") + 1) //no need for a real password mechanism. People just need a login to have their own demo space\n\n    };\n    addRolesBasedonEmail(user);\n    console.log('the user has got a QLIK PROFILE', user, 'Now try to create the user in our local MONGODB or just log him in with a server only stored password'); //unsafe code, only sufficient for our simple demo site\n\n    Meteor.call('resetPasswordOrCreateUser', user, function (err, res) {\n      if (err) {\n        console.error(err);\n      } else {\n        Meteor.loginWithPassword(user.email, user.password, function (err, res) {\n          //\n          if (err) {\n            sAlert.error('Error logging you in...', err.message);\n            console.error(err);\n          } else {\n            sAlert.success('You are now logged in with your Qlik.com account. You now have your \"private demo environment\". So feel free to create/change/delete anything you would like...');\n            console.log('user successfully logged in', Meteor.userId());\n          }\n        });\n      }\n    });\n  }\n}\n\nfunction addRolesBasedonEmail(user) {\n  var email = user.email;\n  var name = email.substring(0, email.lastIndexOf(\"@\"));\n  var domain = email.substring(email.lastIndexOf(\"@\") + 1);\n\n  if (domain === \"qlik.com\" || domain === \"qliktech.com\") {\n    user.roles = ['qlik']; //unsecure off course, this is only for user friendliness reasons to prevent dead links to confluence content.\n  }\n}","map":{"version":3,"sources":["imports/ui/router.js"],"names":["initQlikSense","getAllSlides","module","watch","require","v","nav","Cookies","Router","configure","layoutTemplate","notFoundTemplate","route","template","selection","params","query","selectViaQueryId","go","layout","render","to","window","location","href","indexOf","pathname","mustBeSignedInDEV","user","email","roles","password","addRolesBasedonEmail","Tracker","autorun","console","log","Meteor","userId","setTimeout","loginDEV","bind","next","call","err","res","sAlert","error","message","loginWithPassword","success","mustBeSignedInQlik","Logger","loginQlik","routeName","current","getName","QlikUserProfile","get","loggedInUser","uri","absoluteUrl","encodedReturnURI","encodeURIComponent","QlikSSO","replace","split","username","firstName","lastName","emailAddress","contactID","accountID","ulcLevels","country","hash","substr","profile","name","first","last","substring","lastIndexOf","domain"],"mappings":"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","sourcesContent":["var Cookies = require('js-cookie');\nimport { initQlikSense, getAllSlides } from '/imports/ui/useCases/useCaseSelection.js';\nimport * as nav from \"/imports/ui/nav.js\";\n\n//Layout Configuration. http://stackoverflow.com/questions/28864942/meteor-use-2-different-layouts-ironrouter\nRouter.configure({\n    layoutTemplate: 'containerlayout',\n    notFoundTemplate: 'notFound',\n});\n\nRouter.route('/slides', {\n    template: 'slides',\n    layoutTemplate: 'emptyLayout'\n});\n\nRouter.route('/', async function () {\n    var selection = this.params.query.selection\n    if (selection) {\n        await initQlikSense();\n        await nav.selectViaQueryId(selection);\n        // get the data and go to the slides\n        await getAllSlides(false);\n        // after we got all data in an array from sense, change the router/browser to the slides page\n        Router.go(\"slides\");\n    }\n    else {\n        Router.go('useCaseSelection');\n    }\n});\n\nRouter.route('/useCaseSelection', async function () {\n    var selection = this.params.query.selection\n    if (selection) {\n        await initQlikSense();\n        await nav.selectViaQueryId(selection);\n        // get the data and go to the slides\n        await getAllSlides(false);\n        // after we got all data in an array from sense, change the router/browser to the slides page\n        Router.go(\"slides\");\n    }\n    else {\n        this.layout('containerlayout');\n        this.render('useCaseSelection');\n    }\n});\n\n\n//GENERATION\nRouter.route('/generation');\nRouter.route('/generation_embedded', {\n    template: 'generation',\n    layoutTemplate: 'emptyContainerLayout'\n});\nRouter.route('/users', {\n    template: 'users',\n    layoutTemplate: 'emptyContainerLayout'\n});\n\n//SELF SERVICE\nRouter.route('/selfService', function () {\n    this.layout('SSBILayout');\n    this.render('nav', { to: 'nav' });\n    this.render('SSBIUsers', { to: 'aside' });\n    // this.render('SSBIFooter', { to: 'footer' });\n    this.render('SSBISenseApp');\n});\n\nRouter.route('/selfService_embedded', function () {\n    this.layout('SSBILayout');\n    this.render('SSBIUsers', { to: 'aside' });\n    this.render('SSBISenseApp');\n});\n\n\n//API\nRouter.route('/APILogs');\nRouter.route('/API_embedded', {\n    template: 'APILogs',\n    layoutTemplate: 'SSOLayout'\n});\n\nRouter.route('/ApiLogsTable');\nRouter.route('/ApiLogsTable_embedded', {\n    template: 'ApiLogsTable',\n    layoutTemplate: 'SSOLayout'\n});\n//SECURITY\nRouter.route('/introductionSecurity');\nRouter.route('/security_embedded', {\n    template: 'introductionSecurity',\n    layoutTemplate: 'SSOLayout'\n});\n\n//WEB\nRouter.route('/webIntegration');\nRouter.route('/webIntegration_embedded', {\n    template: 'webIntegration',\n    layoutTemplate: 'SSOLayout'\n});\n\n//ARCHITECTURE\nRouter.route('/architecture');\nRouter.route('/architecture_embedded', {\n    template: 'architecture',\n    layoutTemplate: 'SSOLayout'\n});\n\n//generic overview\nRouter.route('/generic_links_embedded', {\n    template: 'genericDocumentation',\n    layoutTemplate: 'SSOLayout'\n});\n\nRouter.route('/sequenceDiagramOverview');\nRouter.route('/sequenceDiagramGeneration');\nRouter.route('/legal');\n\nRouter.route('/notFound');\nRouter.route('/userOverview');\nRouter.route('/homeAbout');\nRouter.route('/introduction');\nRouter.route('/SecurityDeepDive');\n\n//VIDEO OVERVIEW\nRouter.route('/videoOverview', {\n    template: 'videoOverview',\n    layoutTemplate: 'containerlayout'\n});\nRouter.route('/videoOverview_embedded', {\n    template: 'videoOverview',\n    layoutTemplate: 'SSOLayout'\n});\n\nRouter.route('/documentation', {\n    template: 'documentation',\n    layoutTemplate: 'containerlayout'\n});\n\nRouter.route('/templateOverview', {\n    template: 'templateOverview',\n    layoutTemplate: 'SSOLayout'\n});\n\nRouter.route('/securityRules', {\n    template: 'securityRules',\n    layoutTemplate: 'SSOLayout'\n});\n\n\nRouter.route('/QMC', {\n    template: 'QMC',\n    layoutTemplate: 'SSOLayout'\n});\n\n// Single sing on integration route, this is the route you configure in Qlik sense proxy\nRouter.route('/SSO', {\n    template: 'SSO',\n    layoutTemplate: 'SSOLayout'\n});\n\n//users for the slide generator have their own virtual proxy redirect path\nRouter.route('/presentationsso', {\n    template: 'SSO',\n    layoutTemplate: 'SSOLayout'\n});\n\n//SLIDE GENERATOR LANDING PAGES\nRouter.route('/presentation', {\n    template: 'landingPage',\n    layoutTemplate: 'presentationLayout'\n});\n\nRouter.route('/integration', {\n    template: 'landingPage',\n    layoutTemplate: 'presentationLayout'\n});\n\n// //START THE SLIDE SHOW\n// Router.route('/slideGenerator', {\n//     template: 'slidegeneratorSlidesMain',\n//     layoutTemplate: 'presentationLayout'\n// });\n\n\n\n\n//redirect users from saasdemo.qlik.com to integration.qlik.com\nif (window.location.href.indexOf(\"saasdemo\") > -1) {\n    // var newURL = 'http://'+window.location.protocol + \"//\" + window.location.host + \"/\" + window.location.pathname;\n    window.location = \"http://integration.qlik.com\" + window.location.pathname;\n}\n\n//disabled to ensure we only use anonymous users via https://github.com/artwells/meteor-accounts-guest/\n// // Load a authentication check handler, depending on which domain it runs.\n// if (window.location.href.indexOf(\"qlik.com\") > -1) {\n//     Router.onBeforeAction(mustBeSignedInQlik, { except: [undefined, 'documentation'] });\n\n//     // Router.onBeforeAction(mustBeSignedInQlik, { only: ['test'] });\n//     // Router.onBeforeAction(mustBeSignedIn, { except: [undefined, 'documentation'] });\n//     //     //make sure certain path are for authenticated users only if the demo runs outside of Qlik.com\n//     // Router.plugin('ensureSignedIn', {\n//     //     // only: ['generation', 'users', 'SSO', 'useCaseSelection', 'integration', 'selfService', 'slides', 'presentation']\n//     //     except: [undefined, 'test', 'useCaseSelection', 'documentation', 'atSignIn', 'atSignUp', 'atForgotPassword']\n//     // });\n\n// } else { //localhost dev environment\n//     Router.onBeforeAction(mustBeSignedInDEV, { except: [undefined, 'documentation'] });\n// }\n\nfunction mustBeSignedInDEV() {\n    var user = {\n        // email: \"mbj2@test.com\",\n        email: \"mbj2@qlik.com\",\n        \"profile\": { \"name\": { \"first\": \"Martijn\", \"last\": \"Biesbroek\" } },\n        roles: [\"Base\"], // Array.from(\"Base,Employee,CPEFEmployee\"),\n        password: \"test\"\n    };\n\n    addRolesBasedonEmail(user);\n\n    // \"Logout\"-Hook: Manual implementation, wait a bit to prevent multiple page loads, because the database needs to be update\n    Tracker.autorun(function () {\n        console.log('------------------------------------');\n        console.log('tracker: login status changed...', Meteor.userId());\n        console.log('------------------------------------');\n        if (!Meteor.userId()) {\n            Meteor.setTimeout(loginDEV.bind(null, user), 3000);\n        }\n    });\n\n    this.next();\n};\n\nfunction loginDEV(user) {\n    if (!Meteor.userId()) { //if not yet logged in into Meteor, create a new meteor account, or log him via a token.\n        console.log('user is not yet logged in into meteor', user);\n\n        Meteor.call('resetPasswordOrCreateUser', user, function (err, res) {\n            if (err) {\n                sAlert.error(err.message);\n                console.error(err);\n            } else {\n                console.log('------------------------------------');\n                console.log('password reset..');\n                console.log('------------------------------------');\n                Meteor.loginWithPassword(user.email, user.password, function (err, res) { //\n                    if (err) {\n                        sAlert.error(err.message);\n                        console.error(err);\n                    } else {\n                        sAlert.success('You are now logged in with your Qlik.com account. You now have your \"private demo environment\". So feel free to create/change/delete anything you would like...');\n                        console.log('user successfully logged in', Meteor.userId());\n                    }\n                });\n            }\n        })\n    }\n}\n\nfunction mustBeSignedInQlik() {\n    // \"Logout\"-Hook: Manual implementation, wait a bit to prevent multiple page loads, because the database needs to be update\n    Logger.autorun(function () {\n        if (!Meteor.userId()) {\n            Meteor.setTimeout(loginQlik, 0); //give the browser some time to log the user in...\n        }\n    });\n\n    this.next();\n\n\n};\n\n//THE CODE BELOW IS JUST TO SIMULATE A SSO IF YOU ALREADY LOGGED IN INTO QLIK.COM. THIS CODE IS UNSECURE AND CAN'T BE USED FOR REAL PRODUCTION ENVIRONMENTS.... WE SET THE GROUPS ON THE CLIENT SIDE ETC. THIS IS UNSECURE. BUT FINE FOR THIS DEMO TOOL.\nfunction loginQlik() {\n    //rerun this function anytime something happens with the login state\n    var routeName = Router.current().route.getName();\n    console.log('mustBeSignedIn via Qlik.com for route: ', routeName);\n    var QlikUserProfile = Cookies.get('CSUser'); //only availalbe on Qlik.com domains\n    var loggedInUser = Meteor.userId();\n    console.log('QlikUserProfile: ', QlikUserProfile);\n\n    if (!QlikUserProfile) {\n        //if user is not logged in, redirect to Qliks login page, after it we can read the cookie.\n        var uri = Meteor.absoluteUrl() + routeName;\n        console.log('The user tried to open: ' + uri);\n        var encodedReturnURI = encodeURIComponent(uri);\n        var QlikSSO = \"https://login.qlik.com/login.aspx?returnURL=\" + encodedReturnURI;\n        console.log('User has no Qlik.com cookie, so send him to: ', QlikSSO);\n        window.location.replace(QlikSSO);\n    } else if (!loggedInUser) { //if not yet logged in into Meteor, create a new meteor account, or log him via a token.\n        console.log('user is not yet logged in into meteor');\n        // QlikUserProfile:  username=bieshosetest&firstName=test&lastName=test&emailAddress=bieshose@gmail.com&contactID=&accountID=&ulcLevels=Base&country=Angola&hash=xS9zTEOE7vSgTVXycUr99UFLc78=\n        var [username, firstName, lastName, emailAddress, contactID, accountID, ulcLevels, country, hash] = QlikUserProfile.split('&');\n\n        const user = {\n            email: emailAddress.substr(emailAddress.indexOf(\"=\") + 1),\n            profile: {\n                name: {\n                    first: firstName.substr(firstName.indexOf(\"=\") + 1),\n                    last: lastName.substr(lastName.indexOf(\"=\") + 1),\n                    contactID: contactID ? contactID.substr(contactID.indexOf(\"=\") + 1) : '',\n                    accountID: accountID ? accountID.substr(accountID.indexOf(\"=\") + 1) : '',\n                },\n            },\n            roles: '', //JSON.parse(\"[\" + ulcLevels.substr(ulcLevels.indexOf(\"=\") + 1) + \"]\"),\n            password: emailAddress.substr(emailAddress.indexOf(\"=\") + 1), //no need for a real password mechanism. People just need a login to have their own demo space\n        };\n\n        addRolesBasedonEmail(user);\n\n        console.log('the user has got a QLIK PROFILE', user, 'Now try to create the user in our local MONGODB or just log him in with a server only stored password');\n        //unsafe code, only sufficient for our simple demo site\n        Meteor.call('resetPasswordOrCreateUser', user, function (err, res) {\n            if (err) {\n                console.error(err);\n            } else {\n                Meteor.loginWithPassword(user.email, user.password, function (err, res) { //\n                    if (err) {\n                        sAlert.error('Error logging you in...', err.message);\n                        console.error(err);\n                    } else {\n                        sAlert.success('You are now logged in with your Qlik.com account. You now have your \"private demo environment\". So feel free to create/change/delete anything you would like...');\n                        console.log('user successfully logged in', Meteor.userId());\n                    }\n                });\n            }\n        })\n    }\n}\n\nfunction addRolesBasedonEmail(user) {\n    var email = user.email;\n    var name = email.substring(0, email.lastIndexOf(\"@\"));\n    var domain = email.substring(email.lastIndexOf(\"@\") + 1);\n    if (domain === \"qlik.com\" || domain === \"qliktech.com\") {\n        user.roles = ['qlik']; //unsecure off course, this is only for user friendliness reasons to prevent dead links to confluence content.\n    }\n}"]},"sourceType":"script","hash":"7bf4047b8b202bb037d86fb098e58f101be006ac"}
