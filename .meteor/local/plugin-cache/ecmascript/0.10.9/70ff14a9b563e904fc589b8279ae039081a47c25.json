{"metadata":{},"options":{"plugins":[{"key":"base$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"base$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$2","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$3","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":true}},{"key":"base$0$4","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"base$0$9","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$10","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"compact":false,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/api/server/QRSFunctionsCustomProperties.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"imports/api/server/QRSFunctionsCustomProperties.js","filename":"imports/api/server/QRSFunctionsCustomProperties.js","sourceMaps":true,"passPerPreset":false,"envName":"development","cwd":"/home/martijn/Documents/GitHub/QRSMeteor","root":"/home/martijn/Documents/GitHub/QRSMeteor","presets":[],"generatorOpts":{"filename":"imports/api/server/QRSFunctionsCustomProperties.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/api/server/QRSFunctionsCustomProperties.js"}},"code":"module.export({\n  createCustomProperty: () => createCustomProperty,\n  upsertCustomPropertyByName: () => upsertCustomPropertyByName,\n  deleteCustomProperty: () => deleteCustomProperty,\n  getCustomProperties: () => getCustomProperties\n});\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet myQRS;\nmodule.watch(require(\"/imports/api/server/QRSAPI\"), {\n  myQRS(v) {\n    myQRS = v;\n  }\n\n}, 1);\nlet senseConfig, qrs;\nmodule.watch(require(\"/imports/api/config.js\"), {\n  senseConfig(v) {\n    senseConfig = v;\n  },\n\n  qrs(v) {\n    qrs = v;\n  }\n\n}, 2);\n\nvar fs = require('fs-extra');\n\nconst path = require('path');\n\nfunction createCustomProperty(name, newProperty) {\n  console.log('------------------------------------');\n  console.log('createCustomProperty', name + ' ' + newProperty.toString());\n  console.log('------------------------------------');\n\n  try {\n    check(name, String);\n    check(newProperty, Object);\n  } catch (err) {\n    throw new Meteor.Error('createCustomProperty: Missing values', 'You did not specify a name or choice values for the custom property');\n  }\n\n  var result = qrs.post('/qrs/CustomPropertyDefinition', null, newProperty);\n  console.log('result of create custom property: ', result);\n}\n\nfunction upsertCustomPropertyByName(name, choiceValues) {\n  try {\n    check(name, String);\n    check(choiceValues, Array);\n  } catch (err) {\n    throw new Meteor.Error('upsertCustomPropertyByName: Missing values', 'You did not specify a name or update object for the custom property');\n  }\n\n  try {\n    var newProperty = {\n      \"name\": name,\n      \"valueType\": \"Text\",\n      \"objectTypes\": [\"App\", \"ContentLibrary\", \"DataConnection\", \"ReloadTask\", \"Stream\", \"User\"],\n      \"choiceValues\": choiceValues\n    };\n    var existingProperty = getCustomProperties(name)[0];\n\n    if (existingProperty) {\n      //update it\n      var updatedProperty = Object.assign(existingProperty, newProperty);\n      var result = qrs.put('/qrs/CustomPropertyDefinition/' + updatedProperty.id, null, updatedProperty); //you can only update when you supply the original modified date, otherwise you get a 409 error. \n\n      console.log('Custom property update: ', result);\n    } else {\n      //create a new one\n      createCustomProperty(name, newProperty);\n    }\n  } catch (error) {\n    console.log('error upserting custom property', error);\n  }\n}\n\nfunction deleteCustomProperty(name) {\n  console.log('deleteCustomProperty(name)', name);\n  var customProperty = getCustomProperties(name)[0];\n\n  if (customProperty) {\n    var result = qrs.del('/qrs/CustomPropertyDefinition/' + customProperty.id);\n    console.log('result after delete', result);\n  }\n}\n\nfunction getCustomProperties(name) {\n  var filter = name ? {\n    filter: \"Name eq '\" + name + \"'\"\n  } : null;\n  var customProperties = qrs.get('/qrs/CustomPropertyDefinition/full', filter);\n  var file = path.join(Meteor.settings.broker.automationBaseFolder, 'customProperties', 'export', 'ExtractedCustomProperties.json'); // SAVE FILE TO DISK\n\n  fs.outputFile(file, JSON.stringify(customProperties, null, 2), 'utf-8');\n  return customProperties;\n}","map":{"version":3,"sources":["imports/api/server/QRSFunctionsCustomProperties.js"],"names":["module","export","createCustomProperty","upsertCustomPropertyByName","deleteCustomProperty","getCustomProperties","Meteor","watch","require","v","myQRS","senseConfig","qrs","fs","path","name","newProperty","console","log","toString","check","String","Object","err","Error","result","post","choiceValues","Array","existingProperty","updatedProperty","assign","put","id","error","customProperty","del","filter","customProperties","get","file","join","settings","broker","automationBaseFolder","outputFile","JSON","stringify"],"mappings":"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","sourcesContent":["import {\n    Meteor\n} from 'meteor/meteor';\nimport {\n    myQRS\n} from '/imports/api/server/QRSAPI';\n\nvar fs = require('fs-extra');\nconst path = require('path');\n\nimport {\n    senseConfig,\n    qrs\n} from '/imports/api/config.js';\n\n// http://help.qlik.com/en-US/sense-developer/June2017/Subsystems/RepositoryServiceAPI/Content/RepositoryServiceAPI/RepositoryServiceAPI-Custom-Property-Add.htm\nexport function createCustomProperty(name, newProperty) {\n    console.log('------------------------------------');\n    console.log('createCustomProperty', name + ' ' + newProperty.toString())\n    console.log('------------------------------------');\n\n    try {\n        check(name, String);\n        check(newProperty, Object);\n    } catch (err) {\n        throw new Meteor.Error('createCustomProperty: Missing values', 'You did not specify a name or choice values for the custom property');\n    }\n\n    var result = qrs.post('/qrs/CustomPropertyDefinition', null, newProperty);\n    console.log('result of create custom property: ', result);\n}\n\nexport function upsertCustomPropertyByName(name, choiceValues) {\n    try {\n        check(name, String);\n        check(choiceValues, Array);\n    } catch (err) {\n        throw new Meteor.Error('upsertCustomPropertyByName: Missing values', 'You did not specify a name or update object for the custom property');\n    }\n\n    try {\n        var newProperty = {\n            \"name\": name,\n            \"valueType\": \"Text\",\n            \"objectTypes\": [\"App\", \"ContentLibrary\", \"DataConnection\", \"ReloadTask\", \"Stream\", \"User\"],\n            \"choiceValues\": choiceValues\n        }\n\n        var existingProperty = getCustomProperties(name)[0];\n        if (existingProperty) { //update it\n            var updatedProperty = Object.assign(existingProperty, newProperty);\n            var result = qrs.put('/qrs/CustomPropertyDefinition/' + updatedProperty.id, null, updatedProperty); //you can only update when you supply the original modified date, otherwise you get a 409 error. \n            console.log('Custom property update: ', result);\n        } else { //create a new one\n            createCustomProperty(name, newProperty);\n        }\n    } catch (error) {\n        console.log('error upserting custom property', error);\n    }\n}\n\nexport function deleteCustomProperty(name) {\n    console.log('deleteCustomProperty(name)', name);\n\n    var customProperty = getCustomProperties(name)[0];\n    if (customProperty) {\n        var result = qrs.del('/qrs/CustomPropertyDefinition/' + customProperty.id);\n        console.log('result after delete', result);\n    }\n\n}\n\nexport function getCustomProperties(name) {\n    var filter = name ? {\n        filter: \"Name eq '\" + name + \"'\"\n    } : null;\n    var customProperties = qrs.get('/qrs/CustomPropertyDefinition/full', filter);\n\n    var file = path.join(Meteor.settings.broker.automationBaseFolder, 'customProperties', 'export', 'ExtractedCustomProperties.json');\n\n    // SAVE FILE TO DISK\n    fs.outputFile(file, JSON.stringify(customProperties, null, 2), 'utf-8');\n\n    return customProperties;\n}"]},"sourceType":"script","hash":"70ff14a9b563e904fc589b8279ae039081a47c25"}
