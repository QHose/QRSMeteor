{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"packages/deanius:promise/client/reactivePromise.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"packages/deanius:promise/client/reactivePromise.js","filename":"packages/deanius:promise/client/reactivePromise.js","sourceMaps":true,"passPerPreset":false,"envName":"development","cwd":"/home/martijn/Documents/GitHub/QRSMeteor","root":"/home/martijn/Documents/GitHub/QRSMeteor","generatorOpts":{"filename":"packages/deanius:promise/client/reactivePromise.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/deanius:promise/client/reactivePromise.js"}},"code":"ReactivePromise = function (fn, loadingTextOrObj, errorTextOrFn) {\n  var loadingText = loadingTextOrObj && loadingTextOrObj.pending || loadingTextOrObj || \"\",\n      displayError = function (e) {\n    var errorHandler = loadingTextOrObj.rejected || errorTextOrFn;\n    return _.isFunction(errorHandler) ? errorHandler(e) : errorHandler || \"\";\n  },\n      refire = function (computation) {\n    computation.isPromiseResolve = true;\n    computation.depsNotDeleted = computation._onInvalidateCallbacks;\n    computation._onInvalidateCallbacks = [];\n    computation.invalidate();\n  },\n      cleanup = function (computation) {\n    computation._onInvalidateCallbacks = computation.depsNotDeleted;\n    delete computation.depsNotDeleted;\n    delete computation.isPromiseResolve;\n  },\n      returnValues = {};\n\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var promiseForResult;\n    var result = null;\n    args = args.slice(0, -1);\n    /*remove spacebars, the final arg*/\n\n    var argHash = EJSON.stringify(args, {\n      canonical: true\n    });\n    var helperComputation = Tracker.currentComputation;\n\n    if (helperComputation.isPromiseResolve) {\n      cleanup(helperComputation);\n      return returnValues[argHash];\n    }\n\n    reactiveValue = Tracker.autorun(function () {\n      delete returnValues[argHash];\n      result = fn.apply({}, args);\n      returnValues[argHash] = result;\n    });\n    reactiveValue.onInvalidate(function () {\n      if (!helperComputation.isPromiseResolve) {\n        delete returnValues[argHash];\n        helperComputation.invalidate();\n      }\n    });\n\n    if (returnValues[argHash] instanceof Promise) {\n      promiseForResult = result;\n      promiseForResult.then(function (v) {\n        returnValues[argHash] = v;\n        refire(helperComputation);\n        return v;\n      }, function (e) {\n        returnValues[argHash] = displayError(e);\n        refire(helperComputation);\n      }); //suppress display of [object Promise] message\n\n      returnValues[argHash] = loadingText;\n    }\n\n    return returnValues[argHash];\n  };\n};","map":{"version":3,"sources":["packages/deanius:promise/client/reactivePromise.js"],"names":["ReactivePromise","fn","loadingTextOrObj","errorTextOrFn","loadingText","pending","displayError","e","errorHandler","rejected","_","isFunction","refire","computation","isPromiseResolve","depsNotDeleted","_onInvalidateCallbacks","invalidate","cleanup","returnValues","args","promiseForResult","result","slice","argHash","EJSON","stringify","canonical","helperComputation","Tracker","currentComputation","reactiveValue","autorun","apply","onInvalidate","Promise","then","v"],"mappings":"AAAAA,kBAAkB,UAACC,EAAD,EAAKC,gBAAL,EAAuBC,aAAvB,EAAyC;AACzD,MAAIC,cAAeF,oBAAoBA,iBAAiBG,OAAtC,IAAkDH,gBAAlD,IAAsE,EAAxF;AAAA,MACII,eAAe,UAACC,CAAD,EAAO;AACpB,QAAIC,eAAeN,iBAAiBO,QAAjB,IAA6BN,aAAhD;AACA,WAAOO,EAAEC,UAAF,CAAaH,YAAb,IAA6BA,aAAaD,CAAb,CAA7B,GAAgDC,gBAAgB,EAAvE;AACD,GAJL;AAAA,MAKII,SAAS,UAACC,WAAD,EAAiB;AACxBA,gBAAYC,gBAAZ,GAA+B,IAA/B;AACAD,gBAAYE,cAAZ,GAA6BF,YAAYG,sBAAzC;AACAH,gBAAYG,sBAAZ,GAAqC,EAArC;AACAH,gBAAYI,UAAZ;AACD,GAVL;AAAA,MAWIC,UAAU,UAACL,WAAD,EAAiB;AACzBA,gBAAYG,sBAAZ,GAAqCH,YAAYE,cAAjD;AACA,WAAOF,YAAYE,cAAnB;AACA,WAAOF,YAAYC,gBAAnB;AACD,GAfL;AAAA,MAgBIK,eAAe,EAhBnB;;AAiBA,SAAQ,YAAa;AAAA,sCAATC,IAAS;AAATA,UAAS;AAAA;;AACnB,QAAIC,gBAAJ;AACA,QAAIC,SAAS,IAAb;AACAF,WAAOA,KAAKG,KAAL,CAAW,CAAX,EAAa,CAAC,CAAd,CAAP;AAAyB;;AACzB,QAAIC,UAAUC,MAAMC,SAAN,CAAgBN,IAAhB,EAAsB;AAACO,iBAAW;AAAZ,KAAtB,CAAd;AACA,QAAIC,oBAAoBC,QAAQC,kBAAhC;;AACA,QAAIF,kBAAkBd,gBAAtB,EAAwC;AACtCI,cAAQU,iBAAR;AACA,aAAOT,aAAaK,OAAb,CAAP;AACD;;AAEDO,oBAAgBF,QAAQG,OAAR,CAAgB,YAAY;AAC1C,aAAOb,aAAaK,OAAb,CAAP;AACAF,eAASrB,GAAGgC,KAAH,CAAS,EAAT,EAAab,IAAb,CAAT;AACAD,mBAAaK,OAAb,IAAwBF,MAAxB;AACD,KAJe,CAAhB;AAKAS,kBAAcG,YAAd,CAA2B,YAAY;AACrC,UAAI,CAACN,kBAAkBd,gBAAvB,EAAyC;AACvC,eAAOK,aAAaK,OAAb,CAAP;AACAI,0BAAkBX,UAAlB;AACD;AACF,KALD;;AAOA,QAAIE,aAAaK,OAAb,aAAiCW,OAArC,EAA8C;AAC5Cd,yBAAmBC,MAAnB;AACAD,uBAAiBe,IAAjB,CAAsB,UAAUC,CAAV,EAAa;AACjClB,qBAAaK,OAAb,IAAwBa,CAAxB;AACAzB,eAAOgB,iBAAP;AACA,eAAOS,CAAP;AACD,OAJD,EAIG,UAAU9B,CAAV,EAAa;AACdY,qBAAaK,OAAb,IAAwBlB,aAAaC,CAAb,CAAxB;AACAK,eAAOgB,iBAAP;AACD,OAPD,EAF4C,CAU5C;;AACAT,mBAAaK,OAAb,IAAwBpB,WAAxB;AACD;;AACD,WAAOe,aAAaK,OAAb,CAAP;AACD,GArCD;AAuCD,CAzDD","sourcesContent":["ReactivePromise = (fn, loadingTextOrObj, errorTextOrFn) => {\n  var loadingText = (loadingTextOrObj && loadingTextOrObj.pending) || loadingTextOrObj || \"\",\n      displayError = (e) => {\n        var errorHandler = loadingTextOrObj.rejected || errorTextOrFn;\n        return _.isFunction(errorHandler) ? errorHandler(e) : (errorHandler || \"\");\n      },\n      refire = (computation) => {\n        computation.isPromiseResolve = true;\n        computation.depsNotDeleted = computation._onInvalidateCallbacks;\n        computation._onInvalidateCallbacks = [];\n        computation.invalidate();\n      },\n      cleanup = (computation) => {\n        computation._onInvalidateCallbacks = computation.depsNotDeleted;\n        delete computation.depsNotDeleted;\n        delete computation.isPromiseResolve;\n      },\n      returnValues = {};\n  return ((...args) => {\n    let promiseForResult\n    let result = null\n    args = args.slice(0,-1)  /*remove spacebars, the final arg*/\n    let argHash = EJSON.stringify(args, {canonical: true})\n    let helperComputation = Tracker.currentComputation\n    if (helperComputation.isPromiseResolve) {\n      cleanup(helperComputation);\n      return returnValues[argHash];\n    }\n\n    reactiveValue = Tracker.autorun(function () {\n      delete returnValues[argHash];\n      result = fn.apply({}, args);\n      returnValues[argHash] = result;\n    });\n    reactiveValue.onInvalidate(function () {\n      if (!helperComputation.isPromiseResolve) {\n        delete returnValues[argHash];\n        helperComputation.invalidate();\n      }\n    });\n\n    if (returnValues[argHash] instanceof Promise) {\n      promiseForResult = result;\n      promiseForResult.then(function (v) {\n        returnValues[argHash] = v;\n        refire(helperComputation);\n        return v;\n      }, function (e) {\n        returnValues[argHash] = displayError(e);\n        refire(helperComputation);\n      });\n      //suppress display of [object Promise] message\n      returnValues[argHash] = loadingText;\n    }\n    return returnValues[argHash];\n  })\n\n};\n"]},"sourceType":"script","hash":"cf9effed232bd36bad64846d5f496db7f23e8739"}
