{"metadata":{},"options":{"plugins":[{"key":"base$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"base$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$2","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$3","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":true}},{"key":"base$0$4","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"base$0$9","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$10","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"compact":false,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/ui/useCases/SSBI/SSBI.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"imports/ui/useCases/SSBI/SSBI.js","filename":"imports/ui/useCases/SSBI/SSBI.js","sourceMaps":true,"passPerPreset":false,"envName":"development","cwd":"/home/martijn/Documents/GitHub/QRSMeteor","root":"/home/martijn/Documents/GitHub/QRSMeteor","presets":[],"generatorOpts":{"filename":"imports/ui/useCases/SSBI/SSBI.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/ui/useCases/SSBI/SSBI.js"}},"code":"let Template;\nmodule.watch(require(\"meteor/templating\"), {\n  Template(v) {\n    Template = v;\n  }\n\n}, 0);\nlet Customers, dummyCustomers;\nmodule.watch(require(\"/imports/api/customers\"), {\n  Customers(v) {\n    Customers = v;\n  },\n\n  dummyCustomers(v) {\n    dummyCustomers = v;\n  }\n\n}, 1);\nlet Session;\nmodule.watch(require(\"meteor/session\"), {\n  Session(v) {\n    Session = v;\n  }\n\n}, 2);\nlet senseConfig;\nmodule.watch(require(\"/imports/api/config\"), {\n  senseConfig(v) {\n    senseConfig = v;\n  }\n\n}, 3);\nmodule.watch(require(\"/imports/ui/UIHelpers\"));\n\nlet _;\n\nmodule.watch(require(\"meteor/underscore\"), {\n  default(v) {\n    _ = v;\n  }\n\n}, 4);\nlet Cookies;\nmodule.watch(require(\"js-cookie\"), {\n  default(v) {\n    Cookies = v;\n  }\n\n}, 5);\nlet insertTemplateAndDummyCustomers;\nmodule.watch(require(\"/imports/ui/generation/OEMPartnerSide/OEMPartner\"), {\n  insertTemplateAndDummyCustomers(v) {\n    insertTemplateAndDummyCustomers = v;\n  }\n\n}, 6);\nmodule.watch(require(\"./SSBI.html\"));\nvar server,\n    QMCUrl,\n    hubUrl,\n    sheetUrl,\n    appUrl = \"\";\nTemplate.SSBISenseApp.helpers({\n  show() {\n    return Session.get(\"currentUser\") && !Session.equals(\"loadingIndicator\", \"loading\") ? \"Yes\" : null;\n  }\n\n});\nTemplate.SSBIUsers.onCreated(function () {\n  Session.set(\"loadingIndicator\", \"\");\n  Session.set(\"currentUser\", null);\n  server = senseConfig.host;\n\n  if (Meteor.settings.public.useSSL) {\n    server = \"https://\" + server;\n  } else {\n    server = \"http://\" + server;\n  }\n\n  var appId = Meteor.settings.public.SSBI.appId;\n  console.log(\"server\", server);\n  QMCUrl = server + \"/console\";\n  hubUrl = server + \"/hub\";\n  sheetUrl = server + \"/sense/app/\" + appId;\n  console.log(\"sheetUrl\", sheetUrl);\n  appUrl = server + \"/sense/app/\" + appId + \"/sheet/\" + Meteor.settings.public.SSBI.sheetId + \"/state/analysis\";\n  console.log(\"SSBIApp URL\", appUrl);\n});\nTemplate.SSBISenseIFrame.onRendered(function () {\n  this.$(\".IFrameSense\").transition(\"slide in right\");\n});\nTemplate.SSBISenseIFrame.helpers({\n  appURL() {\n    // console.log('SSBISenseIFrame helper: de app url is: ', Session.get('appUrl'));\n    return Session.get(\"IFrameUrl\");\n  }\n\n});\nTemplate.SSBIUsers.helpers({\n  currentUser() {\n    if (Session.get(\"currentUser\")) {\n      return \"(\" + Session.get(\"currentUser\") + \" currently logged in)\";\n    }\n  },\n\n  user() {\n    return Session.get(\"currentUser\");\n  },\n\n  showSenseButtons() {\n    return Session.get(\"currentUser\") && !Session.equals(\"loadingIndicator\", \"loading\") ? \"Yes\" : null;\n  }\n\n});\nTemplate.SSBIUsers.events({\n  \"click .consumer\"() {\n    var passport = {\n      UserId: \"John\",\n      Groups: [\"CONSUMER\", \"UNITED STATES\"]\n    };\n    login(passport);\n  },\n\n  \"click .contributor\"() {\n    var passport = {\n      UserId: \"Linda\",\n      Groups: [\"CONTRIBUTOR\", \"UNITED STATES\"]\n    };\n    login(passport);\n  },\n\n  \"click .developer\"() {\n    var passport = {\n      UserId: \"Martin\",\n      Groups: [\"DEVELOPER\"]\n    };\n    login(passport);\n  },\n\n  \"click .admin\"(e, t) {\n    var passport = {\n      UserId: \"Paul\",\n      Groups: [\"CONTRIBUTOR\", \"UNITED STATES\"]\n    };\n    login(passport);\n  },\n\n  \"click .selfservice \"() {\n    $(\".ui.modal.SSBI\").modal(\"show\").modal(\"refresh\").modal(\"refresh\");\n  },\n\n  \"click .hub \"() {\n    Session.set(\"IFrameUrl\", hubUrl);\n  },\n\n  \"click .sheet \"() {\n    Session.set(\"IFrameUrl\", sheetUrl);\n  },\n\n  \"click .app \"() {\n    Session.set(\"IFrameUrl\", appUrl);\n  },\n\n  \"click .QMC \"() {\n    Session.set(\"IFrameUrl\", QMCUrl);\n  }\n\n});\nTemplate.SSBIUsers.onCreated(function () {\n  Session.set(\"appUrl\", appUrl);\n});\nTemplate.SSBIUsers.onRendered(function () {\n  this.$(\".ui.accordion\").accordion();\n});\n\nfunction login(passport) {\n  return Promise.asyncApply(() => {\n    console.log(\"🚀 ~ file: SSBI.js:136 ~ login ~ passport:\", passport);\n\n    try {\n      //logout the current user in the browser by replacing the iframe url to tenant/logout\n      console.log(\"DELETE COOKIE FROM BROWSER by replacing the iframe url to /logout\");\n      Session.set(\"currentUser\", passport.UserId);\n      Session.set(\"IFrameUrl\", \"https://\" + senseConfig.host + \"/logout\");\n      Meteor.call(\"getJWTToken\", passport, function (error, token) {\n        return Promise.asyncApply(() => {\n          if (error) {\n            console.error(\"Error getJWTToken\", error);\n          } else {\n            console.log(\"🚀 ~ file: SSBI.js:151 ~ login ~ token:\", token);\n            var URLtoOpen = Session.get(\"appUrl\");\n            console.log(\"------------------------------------\");\n            console.log(\"requesting JWT at Qlik cloud JWT IdP  with passport: \" + JSON.stringify(passport));\n            console.log(\"------------------------------------\");\n            console.log(\"login: the url to open is: \", URLtoOpen);\n            Promise.await(jwtLogin(token));\n            Session.set(\"IFrameUrl\", URLtoOpen);\n          }\n        });\n      });\n    } catch (err) {\n      console.error(err);\n      sAlert.error(\"Login error\", err.message);\n    }\n  });\n}\n\nfunction qlikLogin() {\n  return Promise.asyncApply(() => {\n    const tokenRes = Promise.await(Promise.await(getJWTToken(JWTENDPOINT)).json());\n    const loginRes = Promise.await(jwtLogin(tokenRes.token));\n    console.log(\"🚀 ~ file: index.html:46 ~ qlikLogin ~ login result status\", loginRes);\n\n    if (loginRes.status != 200) {\n      const message = \"Something went wrong while logging in.\";\n      alert(message);\n      throw new Error(message);\n    }\n\n    const recheckLoggedIn = Promise.await(checkLoggedIn());\n\n    if (recheckLoggedIn.status !== 200) {\n      const message = \"Third-party cookies are not enabled in your browser settings and/or browser mode.\";\n      alert(message);\n      throw new Error(message);\n    }\n\n    console.log(\"Logged in!\", loginRes);\n    return true;\n  });\n}\n\nfunction jwtLogin(token) {\n  return Promise.asyncApply(() => {\n    console.log(`🚀 ~ file: SSBI.js:196 ~ Now using the token received from the server to make a client side call to  https://${Meteor.settings.public.tenantDomain}/login/jwt-session?qlik-web-integration-id=${Meteor.settings.public.qlikWebIntegrationId} with jwtLogin ~ token:`, token);\n    const authHeader = `Bearer ${token}`;\n    return Promise.await(fetch(`https://${Meteor.settings.public.tenantDomain}/login/jwt-session?qlik-web-integration-id=${Meteor.settings.public.qlikWebIntegrationId}`, {\n      credentials: \"include\",\n      mode: \"cors\",\n      method: \"POST\",\n      headers: {\n        Authorization: authHeader,\n        \"qlik-web-integration-id\": Meteor.settings.public.qlikWebIntegrationId\n      }\n    }));\n  });\n}\n\nfunction checkLoggedIn() {\n  return Promise.asyncApply(() => {\n    return Promise.await(fetch(`https://${Meteor.settings.public.tenantDomain}/api/v1/users/me`, {\n      mode: \"cors\",\n      credentials: \"include\",\n      headers: {\n        \"qlik-web-integration-id\": Meteor.settings.public.qlikWebIntegrationId\n      }\n    }));\n  });\n}\n\nTemplate.userCards.onRendered(function () {\n  this.$(\".dimmable.image\").dimmer({\n    on: \"hover\"\n  });\n  this.$(\".column\").transition(\"scale in\");\n  this.$(\"#flyoutnavkbfixed\").focus();\n  !function () {\n    var w = window,\n        d = w.document;\n\n    if (w.onfocusin === undefined) {\n      d.addEventListener(\"focus\", addPolyfill, true);\n      d.addEventListener(\"blur\", addPolyfill, true);\n      d.addEventListener(\"focusin\", removePolyfill, true);\n      d.addEventListener(\"focusout\", removePolyfill, true);\n    }\n\n    function addPolyfill(e) {\n      var type = e.type === \"focus\" ? \"focusin\" : \"focusout\";\n      var event = new CustomEvent(type, {\n        bubbles: true,\n        cancelable: false\n      });\n      event.c1Generated = true;\n      e.target.dispatchEvent(event);\n    }\n\n    function removePolyfill(e) {\n      if (!e.c1Generated) {\n        // focus after focusin, so chrome will the first time trigger tow times focusin\n        d.removeEventListener(\"focus\", addPolyfill, true);\n        d.removeEventListener(\"blur\", addPolyfill, true);\n        d.removeEventListener(\"focusin\", removePolyfill, true);\n        d.removeEventListener(\"focusout\", removePolyfill, true);\n      }\n\n      setTimeout(function () {\n        d.removeEventListener(\"focusin\", removePolyfill, true);\n        d.removeEventListener(\"focusout\", removePolyfill, true);\n      });\n    }\n  }();\n\n  function hasClass(el, className) {\n    if (el.classList) {\n      return el.classList.contains(className);\n    } else {\n      return new RegExp(\"(^| )\" + className + \"( |$)\", \"gi\").test(el.className);\n    }\n  }\n\n  var menuItems1 = document.querySelectorAll(\"#flyoutnavkbfixed li.has-submenu\");\n  var timer1, timer2;\n  Array.prototype.forEach.call(menuItems1, function (el, i) {\n    el.addEventListener(\"mouseover\", function (event) {\n      this.className = \"has-submenu open\";\n      clearTimeout(timer1);\n    });\n    el.addEventListener(\"mouseout\", function (event) {\n      timer1 = setTimeout(function (event) {\n        var opennav = document.querySelector(\"#flyoutnavkbfixed .has-submenu.open\");\n        opennav.className = \"has-submenu\";\n        opennav.querySelector(\"a\").setAttribute(\"aria-expanded\", \"false\");\n      }, 1000);\n    });\n    el.querySelector(\"a\").addEventListener(\"click\", function (event) {\n      if (this.parentNode.className == \"has-submenu\") {\n        this.parentNode.className = \"has-submenu open\";\n        this.setAttribute(\"aria-expanded\", \"true\");\n      } else {\n        this.parentNode.className = \"has-submenu\";\n        this.setAttribute(\"aria-expanded\", \"false\");\n      }\n\n      event.preventDefault();\n    });\n    var links = el.querySelectorAll(\"a\");\n    Array.prototype.forEach.call(links, function (el, i) {\n      el.addEventListener(\"focus\", function () {\n        if (timer2) {\n          clearTimeout(timer2);\n          timer2 = null;\n        }\n      });\n      el.addEventListener(\"blur\", function (event) {\n        timer2 = setTimeout(function () {\n          var opennav = document.querySelector(\"#flyoutnavkbfixed .has-submenu.open\");\n\n          if (opennav) {\n            opennav.className = \"has-submenu\";\n            opennav.querySelector(\"a\").setAttribute(\"aria-expanded\", \"false\");\n          }\n        }, 10);\n      });\n    });\n  });\n});\nTemplate.senseButtons.onRendered(function () {\n  this.$(\".SenseIframe\").transition(\"swing up\");\n  !function () {\n    var w = window,\n        d = w.document;\n\n    if (w.onfocusin === undefined) {\n      d.addEventListener(\"focus\", addPolyfill, true);\n      d.addEventListener(\"blur\", addPolyfill, true);\n      d.addEventListener(\"focusin\", removePolyfill, true);\n      d.addEventListener(\"focusout\", removePolyfill, true);\n    }\n\n    function addPolyfill(e) {\n      var type = e.type === \"focus\" ? \"focusin\" : \"focusout\";\n      var event = new CustomEvent(type, {\n        bubbles: true,\n        cancelable: false\n      });\n      event.c1Generated = true;\n      e.target.dispatchEvent(event);\n    }\n\n    function removePolyfill(e) {\n      if (!e.c1Generated) {\n        // focus after focusin, so chrome will the first time trigger tow times focusin\n        d.removeEventListener(\"focus\", addPolyfill, true);\n        d.removeEventListener(\"blur\", addPolyfill, true);\n        d.removeEventListener(\"focusin\", removePolyfill, true);\n        d.removeEventListener(\"focusout\", removePolyfill, true);\n      }\n\n      setTimeout(function () {\n        d.removeEventListener(\"focusin\", removePolyfill, true);\n        d.removeEventListener(\"focusout\", removePolyfill, true);\n      });\n    }\n  }();\n\n  function hasClass(el, className) {\n    if (el.classList) {\n      return el.classList.contains(className);\n    } else {\n      return new RegExp(\"(^| )\" + className + \"( |$)\", \"gi\").test(el.className);\n    }\n  }\n\n  var menuItems1 = document.querySelectorAll(\"#flyoutnavkbfixed li.has-submenu\");\n  var timer1, timer2;\n  Array.prototype.forEach.call(menuItems1, function (el, i) {\n    el.addEventListener(\"mouseover\", function (event) {\n      this.className = \"has-submenu open\";\n      clearTimeout(timer1);\n    });\n    el.addEventListener(\"mouseout\", function (event) {\n      timer1 = setTimeout(function (event) {\n        var opennav = document.querySelector(\"#flyoutnavkbfixed .has-submenu.open\");\n        opennav.className = \"has-submenu\";\n        opennav.querySelector(\"a\").setAttribute(\"aria-expanded\", \"false\");\n      }, 1000);\n    });\n    el.querySelector(\"a\").addEventListener(\"click\", function (event) {\n      if (this.parentNode.className == \"has-submenu\") {\n        this.parentNode.className = \"has-submenu open\";\n        this.setAttribute(\"aria-expanded\", \"true\");\n      } else {\n        this.parentNode.className = \"has-submenu\";\n        this.setAttribute(\"aria-expanded\", \"false\");\n      }\n\n      event.preventDefault();\n    });\n    var links = el.querySelectorAll(\"a\");\n    Array.prototype.forEach.call(links, function (el, i) {\n      el.addEventListener(\"focus\", function () {\n        if (timer2) {\n          clearTimeout(timer2);\n          timer2 = null;\n        }\n      });\n      el.addEventListener(\"blur\", function (event) {\n        timer2 = setTimeout(function () {\n          var opennav = document.querySelector(\"#flyoutnavkbfixed .has-submenu.open\");\n\n          if (opennav) {\n            opennav.className = \"has-submenu\";\n            opennav.querySelector(\"a\").setAttribute(\"aria-expanded\", \"false\");\n          }\n        }, 10);\n      });\n    });\n  });\n});","map":{"version":3,"sources":["imports/ui/useCases/SSBI/SSBI.js"],"names":["Template","module","watch","require","v","Customers","dummyCustomers","Session","senseConfig","_","default","Cookies","insertTemplateAndDummyCustomers","server","QMCUrl","hubUrl","sheetUrl","appUrl","SSBISenseApp","helpers","show","get","equals","SSBIUsers","onCreated","set","host","Meteor","settings","public","useSSL","appId","SSBI","console","log","sheetId","SSBISenseIFrame","onRendered","$","transition","appURL","currentUser","user","showSenseButtons","events","passport","UserId","Groups","login","e","t","modal","accordion","call","error","token","URLtoOpen","JSON","stringify","jwtLogin","err","sAlert","message","qlikLogin","tokenRes","getJWTToken","JWTENDPOINT","json","loginRes","status","alert","Error","recheckLoggedIn","checkLoggedIn","tenantDomain","qlikWebIntegrationId","authHeader","fetch","credentials","mode","method","headers","Authorization","userCards","dimmer","on","focus","w","window","d","document","onfocusin","undefined","addEventListener","addPolyfill","removePolyfill","type","event","CustomEvent","bubbles","cancelable","c1Generated","target","dispatchEvent","removeEventListener","setTimeout","hasClass","el","className","classList","contains","RegExp","test","menuItems1","querySelectorAll","timer1","timer2","Array","prototype","forEach","i","clearTimeout","opennav","querySelector","setAttribute","parentNode","preventDefault","links","senseButtons"],"mappings":"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","sourcesContent":["import { Template } from \"meteor/templating\";\nimport { Customers, dummyCustomers } from \"/imports/api/customers\";\nimport { Session } from \"meteor/session\";\nimport { senseConfig } from \"/imports/api/config\";\nimport \"/imports/ui/UIHelpers\";\nimport _ from \"meteor/underscore\";\nimport Cookies from \"js-cookie\";\nimport { insertTemplateAndDummyCustomers } from \"/imports/ui/generation/OEMPartnerSide/OEMPartner\";\n\nimport \"./SSBI.html\";\n\nvar server,\n  QMCUrl,\n  hubUrl,\n  sheetUrl,\n  appUrl = \"\";\n\nTemplate.SSBISenseApp.helpers({\n  show() {\n    return Session.get(\"currentUser\") &&\n      !Session.equals(\"loadingIndicator\", \"loading\")\n      ? \"Yes\"\n      : null;\n  },\n});\n\nTemplate.SSBIUsers.onCreated(function () {\n  Session.set(\"loadingIndicator\", \"\");\n  Session.set(\"currentUser\", null);\n  server = senseConfig.host;\n\n  if (Meteor.settings.public.useSSL) {\n    server = \"https://\" + server;\n  } else {\n    server = \"http://\" + server;\n  }\n  var appId = Meteor.settings.public.SSBI.appId;\n  console.log(\"server\", server);\n  QMCUrl = server + \"/console\";\n  hubUrl = server + \"/hub\";\n  sheetUrl = server + \"/sense/app/\" + appId;\n  console.log(\"sheetUrl\", sheetUrl);\n  appUrl =\n    server +\n    \"/sense/app/\" +\n    appId +\n    \"/sheet/\" +\n    Meteor.settings.public.SSBI.sheetId +\n    \"/state/analysis\";\n  console.log(\"SSBIApp URL\", appUrl);\n});\n\nTemplate.SSBISenseIFrame.onRendered(function () {\n  this.$(\".IFrameSense\").transition(\"slide in right\");\n});\n\nTemplate.SSBISenseIFrame.helpers({\n  appURL() {\n    // console.log('SSBISenseIFrame helper: de app url is: ', Session.get('appUrl'));\n    return Session.get(\"IFrameUrl\");\n  },\n});\n\nTemplate.SSBIUsers.helpers({\n  currentUser() {\n    if (Session.get(\"currentUser\")) {\n      return \"(\" + Session.get(\"currentUser\") + \" currently logged in)\";\n    }\n  },\n  user() {\n    return Session.get(\"currentUser\");\n  },\n  showSenseButtons() {\n    return Session.get(\"currentUser\") &&\n      !Session.equals(\"loadingIndicator\", \"loading\")\n      ? \"Yes\"\n      : null;\n  },\n});\n\nTemplate.SSBIUsers.events({\n  \"click .consumer\"() {\n    var passport = {\n      UserId: \"John\",\n      Groups: [\"CONSUMER\", \"UNITED STATES\"],\n    };\n    login(passport);\n  },\n  \"click .contributor\"() {\n    var passport = {\n      UserId: \"Linda\",\n      Groups: [\"CONTRIBUTOR\", \"UNITED STATES\"],\n    };\n    login(passport);\n  },\n  \"click .developer\"() {\n    var passport = {\n      UserId: \"Martin\",\n      Groups: [\"DEVELOPER\"],\n    };\n    login(passport);\n  },\n  \"click .admin\"(e, t) {\n    var passport = {\n      UserId: \"Paul\",\n      Groups: [\"CONTRIBUTOR\", \"UNITED STATES\"],\n    };\n    login(passport);\n  },\n  \"click .selfservice \"() {\n    $(\".ui.modal.SSBI\").modal(\"show\").modal(\"refresh\").modal(\"refresh\");\n  },\n  \"click .hub \"() {\n    Session.set(\"IFrameUrl\", hubUrl);\n  },\n  \"click .sheet \"() {\n    Session.set(\"IFrameUrl\", sheetUrl);\n  },\n  \"click .app \"() {\n    Session.set(\"IFrameUrl\", appUrl);\n  },\n  \"click .QMC \"() {\n    Session.set(\"IFrameUrl\", QMCUrl);\n  },\n});\n\nTemplate.SSBIUsers.onCreated(function () {\n  Session.set(\"appUrl\", appUrl);\n});\n\nTemplate.SSBIUsers.onRendered(function () {\n  this.$(\".ui.accordion\").accordion();\n});\n\nasync function login(passport) {\n  console.log(\"🚀 ~ file: SSBI.js:136 ~ login ~ passport:\", passport);\n  try {\n    //logout the current user in the browser by replacing the iframe url to tenant/logout\n    console.log(\n      \"DELETE COOKIE FROM BROWSER by replacing the iframe url to /logout\"\n    );\n    Session.set(\"currentUser\", passport.UserId);\n    Session.set(\"IFrameUrl\", \"https://\" + senseConfig.host + \"/logout\");\n\n    Meteor.call(\"getJWTToken\", passport, async function (error, token) {\n      if (error) {\n        console.error(\"Error getJWTToken\", error);\n      } else {\n        console.log(\"🚀 ~ file: SSBI.js:151 ~ login ~ token:\", token);\n        var URLtoOpen = Session.get(\"appUrl\");\n        console.log(\"------------------------------------\");\n        console.log(\n          \"requesting JWT at Qlik cloud JWT IdP  with passport: \" +\n            JSON.stringify(passport)\n        );\n        console.log(\"------------------------------------\");\n        console.log(\"login: the url to open is: \", URLtoOpen);\n\n        await jwtLogin(token);\n\n        Session.set(\"IFrameUrl\", URLtoOpen);\n      }\n    });\n  } catch (err) {\n    console.error(err);\n    sAlert.error(\"Login error\", err.message);\n  }\n}\n\nasync function qlikLogin() {\n  const tokenRes = await (await getJWTToken(JWTENDPOINT)).json();\n  const loginRes = await jwtLogin(tokenRes.token);\n  console.log(\n    \"🚀 ~ file: index.html:46 ~ qlikLogin ~ login result status\",\n    loginRes\n  );\n  if (loginRes.status != 200) {\n    const message = \"Something went wrong while logging in.\";\n    alert(message);\n    throw new Error(message);\n  }\n  const recheckLoggedIn = await checkLoggedIn();\n  if (recheckLoggedIn.status !== 200) {\n    const message =\n      \"Third-party cookies are not enabled in your browser settings and/or browser mode.\";\n    alert(message);\n    throw new Error(message);\n  }\n  console.log(\"Logged in!\", loginRes);\n\n  return true;\n}\n\nasync function jwtLogin(token) {\n  console.log(`🚀 ~ file: SSBI.js:196 ~ Now using the token received from the server to make a client side call to  https://${Meteor.settings.public.tenantDomain}/login/jwt-session?qlik-web-integration-id=${Meteor.settings.public.qlikWebIntegrationId} with jwtLogin ~ token:`,  token);\n  const authHeader = `Bearer ${token}`;\n  return await fetch(\n    `https://${Meteor.settings.public.tenantDomain}/login/jwt-session?qlik-web-integration-id=${Meteor.settings.public.qlikWebIntegrationId}`,\n    {\n      credentials: \"include\",\n      mode: \"cors\",\n      method: \"POST\",\n      headers: {\n        Authorization: authHeader,\n        \"qlik-web-integration-id\": Meteor.settings.public.qlikWebIntegrationId,\n      },\n    }\n  );\n}\n\nasync function checkLoggedIn() {\n  return await fetch(\n    `https://${Meteor.settings.public.tenantDomain}/api/v1/users/me`,\n    {\n      mode: \"cors\",\n      credentials: \"include\",\n      headers: {\n        \"qlik-web-integration-id\": Meteor.settings.public.qlikWebIntegrationId,\n      },\n    }\n  );\n}\n\nTemplate.userCards.onRendered(function () {\n  this.$(\".dimmable.image\").dimmer({\n    on: \"hover\",\n  });\n  this.$(\".column\").transition(\"scale in\");\n\n  this.$(\"#flyoutnavkbfixed\").focus();\n\n  !(function () {\n    var w = window,\n      d = w.document;\n\n    if (w.onfocusin === undefined) {\n      d.addEventListener(\"focus\", addPolyfill, true);\n      d.addEventListener(\"blur\", addPolyfill, true);\n      d.addEventListener(\"focusin\", removePolyfill, true);\n      d.addEventListener(\"focusout\", removePolyfill, true);\n    }\n    function addPolyfill(e) {\n      var type = e.type === \"focus\" ? \"focusin\" : \"focusout\";\n      var event = new CustomEvent(type, { bubbles: true, cancelable: false });\n      event.c1Generated = true;\n      e.target.dispatchEvent(event);\n    }\n    function removePolyfill(e) {\n      if (!e.c1Generated) {\n        // focus after focusin, so chrome will the first time trigger tow times focusin\n        d.removeEventListener(\"focus\", addPolyfill, true);\n        d.removeEventListener(\"blur\", addPolyfill, true);\n        d.removeEventListener(\"focusin\", removePolyfill, true);\n        d.removeEventListener(\"focusout\", removePolyfill, true);\n      }\n      setTimeout(function () {\n        d.removeEventListener(\"focusin\", removePolyfill, true);\n        d.removeEventListener(\"focusout\", removePolyfill, true);\n      });\n    }\n  })();\n\n  function hasClass(el, className) {\n    if (el.classList) {\n      return el.classList.contains(className);\n    } else {\n      return new RegExp(\"(^| )\" + className + \"( |$)\", \"gi\").test(el.className);\n    }\n  }\n\n  var menuItems1 = document.querySelectorAll(\n    \"#flyoutnavkbfixed li.has-submenu\"\n  );\n  var timer1, timer2;\n\n  Array.prototype.forEach.call(menuItems1, function (el, i) {\n    el.addEventListener(\"mouseover\", function (event) {\n      this.className = \"has-submenu open\";\n      clearTimeout(timer1);\n    });\n    el.addEventListener(\"mouseout\", function (event) {\n      timer1 = setTimeout(function (event) {\n        var opennav = document.querySelector(\n          \"#flyoutnavkbfixed .has-submenu.open\"\n        );\n        opennav.className = \"has-submenu\";\n        opennav.querySelector(\"a\").setAttribute(\"aria-expanded\", \"false\");\n      }, 1000);\n    });\n    el.querySelector(\"a\").addEventListener(\"click\", function (event) {\n      if (this.parentNode.className == \"has-submenu\") {\n        this.parentNode.className = \"has-submenu open\";\n        this.setAttribute(\"aria-expanded\", \"true\");\n      } else {\n        this.parentNode.className = \"has-submenu\";\n        this.setAttribute(\"aria-expanded\", \"false\");\n      }\n      event.preventDefault();\n    });\n    var links = el.querySelectorAll(\"a\");\n    Array.prototype.forEach.call(links, function (el, i) {\n      el.addEventListener(\"focus\", function () {\n        if (timer2) {\n          clearTimeout(timer2);\n          timer2 = null;\n        }\n      });\n      el.addEventListener(\"blur\", function (event) {\n        timer2 = setTimeout(function () {\n          var opennav = document.querySelector(\n            \"#flyoutnavkbfixed .has-submenu.open\"\n          );\n          if (opennav) {\n            opennav.className = \"has-submenu\";\n            opennav.querySelector(\"a\").setAttribute(\"aria-expanded\", \"false\");\n          }\n        }, 10);\n      });\n    });\n  });\n});\n\nTemplate.senseButtons.onRendered(function () {\n  this.$(\".SenseIframe\").transition(\"swing up\");\n\n  !(function () {\n    var w = window,\n      d = w.document;\n\n    if (w.onfocusin === undefined) {\n      d.addEventListener(\"focus\", addPolyfill, true);\n      d.addEventListener(\"blur\", addPolyfill, true);\n      d.addEventListener(\"focusin\", removePolyfill, true);\n      d.addEventListener(\"focusout\", removePolyfill, true);\n    }\n    function addPolyfill(e) {\n      var type = e.type === \"focus\" ? \"focusin\" : \"focusout\";\n      var event = new CustomEvent(type, { bubbles: true, cancelable: false });\n      event.c1Generated = true;\n      e.target.dispatchEvent(event);\n    }\n    function removePolyfill(e) {\n      if (!e.c1Generated) {\n        // focus after focusin, so chrome will the first time trigger tow times focusin\n        d.removeEventListener(\"focus\", addPolyfill, true);\n        d.removeEventListener(\"blur\", addPolyfill, true);\n        d.removeEventListener(\"focusin\", removePolyfill, true);\n        d.removeEventListener(\"focusout\", removePolyfill, true);\n      }\n      setTimeout(function () {\n        d.removeEventListener(\"focusin\", removePolyfill, true);\n        d.removeEventListener(\"focusout\", removePolyfill, true);\n      });\n    }\n  })();\n\n  function hasClass(el, className) {\n    if (el.classList) {\n      return el.classList.contains(className);\n    } else {\n      return new RegExp(\"(^| )\" + className + \"( |$)\", \"gi\").test(el.className);\n    }\n  }\n\n  var menuItems1 = document.querySelectorAll(\n    \"#flyoutnavkbfixed li.has-submenu\"\n  );\n  var timer1, timer2;\n\n  Array.prototype.forEach.call(menuItems1, function (el, i) {\n    el.addEventListener(\"mouseover\", function (event) {\n      this.className = \"has-submenu open\";\n      clearTimeout(timer1);\n    });\n    el.addEventListener(\"mouseout\", function (event) {\n      timer1 = setTimeout(function (event) {\n        var opennav = document.querySelector(\n          \"#flyoutnavkbfixed .has-submenu.open\"\n        );\n        opennav.className = \"has-submenu\";\n        opennav.querySelector(\"a\").setAttribute(\"aria-expanded\", \"false\");\n      }, 1000);\n    });\n    el.querySelector(\"a\").addEventListener(\"click\", function (event) {\n      if (this.parentNode.className == \"has-submenu\") {\n        this.parentNode.className = \"has-submenu open\";\n        this.setAttribute(\"aria-expanded\", \"true\");\n      } else {\n        this.parentNode.className = \"has-submenu\";\n        this.setAttribute(\"aria-expanded\", \"false\");\n      }\n      event.preventDefault();\n    });\n    var links = el.querySelectorAll(\"a\");\n    Array.prototype.forEach.call(links, function (el, i) {\n      el.addEventListener(\"focus\", function () {\n        if (timer2) {\n          clearTimeout(timer2);\n          timer2 = null;\n        }\n      });\n      el.addEventListener(\"blur\", function (event) {\n        timer2 = setTimeout(function () {\n          var opennav = document.querySelector(\n            \"#flyoutnavkbfixed .has-submenu.open\"\n          );\n          if (opennav) {\n            opennav.className = \"has-submenu\";\n            opennav.querySelector(\"a\").setAttribute(\"aria-expanded\", \"false\");\n          }\n        }, 10);\n      });\n    });\n  });\n});\n"]},"sourceType":"script","hash":"4efe22b9454874d2deeca159e989952350cb4af2"}
